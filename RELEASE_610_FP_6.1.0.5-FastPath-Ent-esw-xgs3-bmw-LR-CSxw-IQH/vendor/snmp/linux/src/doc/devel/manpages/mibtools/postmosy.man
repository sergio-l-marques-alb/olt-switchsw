.\"
.\"
.\" Copyright (C) 1992-2006 by SNMP Research, Incorporated.
.\"
.\" This software is furnished under a license and may be used and copied
.\" only in accordance with the terms of such license and with the
.\" inclusion of the above copyright notice. This software or any other
.\" copies thereof may not be provided or otherwise made available to any
.\" other person. No title to and ownership of the software is hereby
.\" transferred.
.\"
.\" The information in this software is subject to change without notice
.\" and should not be construed as a commitment by SNMP Research, Incorporated.
.\"
.\" Restricted Rights Legend:
.\"  Use, duplication, or disclosure by the Government is subject to
.\"  restrictions as set forth in subparagraph (c)(1)(ii) of the Rights
.\"  in Technical Data and Computer Software clause at DFARS 252.227-7013;
.\"  subparagraphs (c)(4) and (d) of the Commercial Computer
.\"  Software-Restricted Rights Clause, FAR 52.227-19; and in similar
.\"  clauses in the NASA FAR Supplement and other corresponding
.\"  governmental regulations.
.\"
.\"
.\"
.\"                PROPRIETARY NOTICE
.\"
.\" This software is an unpublished work subject to a confidentiality agreement
.\" and is protected by copyright and trade secret law.  Unauthorized copying,
.\" redistribution or other use of this work is prohibited.
.\"
.\" The above notice of copyright on this source code product does not indicate
.\" any actual or intended publication of such source code.
.\"
.\"
.\"
.\"
.\"
.\"
.\"
.\"
.TH POSTMOSY SR_CMDMAN "8 May 1996"

.SH NAME
postmosy \- MOSY post processor for agents

.SH SYNOPSIS
.B postmosy
[
.B \-o base
|
.B \-c string
|
.B \-f configfile
] [
.B options ...
] [
.B *.def
]
.PP
.B postmosy
[
.B \-o base
] [
.B \-inputinfo
] [
.B *info.dat
]
.PP
.B postmosy
[
.B \-mergeinfo
] [
.B *info.dat
]

.SH DESCRIPTION
The
.I postmosy
program reads the concatenated output of
.I mosy(SR_CMDMAN)
and generates several files used for developing SNMP compliant
agents.  Files generated by
.I mosy(SR_CMDMAN)
(which are input files to
.I postmosy
) end with the extension `.def'.  Zero, one, or many 
.I .def
files may be supplied on the command line.  If no
.I .def
files are given
.I postmosy
reads from standard input.
.PP
Using all of the default settings,
.I postmosy
generates
snmpdefs.h,
snmpinfo.dat,
snmpoid.c,
snmpsupp.h,
snmptype.h, and
snmppart.h.
Except for snmpinfo.dat, which is a data file for management
applications, all of these files are used to compile SNMP
Research agents.
.PP
All files generated by
.I postmosy
have a common base name, which is `snmp' by default but can be changed.
.SH OPTIONS
.IP \-agent
Generate system independent (v_) method routines and system dependent
(k_) stub method routines.  These routines are modified by the agent
developer to implement the MIB in the agent.
.IP \-ansi
Generate ANSI standard function declarations.
.IP \-argsused
Print ARGSUSED before generated functions.
.IP \-c\ string
Provide one line of configuration information on the command line.
The contents of
.I string
may be the same as any one line of
.I configfile
(refer to the
.I \-f
option).
This method of configuration can be used to compile only selected
portions of the MIB.  This option should not be used together with the
.I \-f
or
.I \-o
options.
.IP \-cache
Add simple caching to the system independent method routines.
This is the default.
.IP \-const
Declare the storage space in <base>part.h and <base>oid.c as const.
.IP \-f\ configfile
Read configuration information from
.I configfile.
This method of configuration can be used to compile only selected portions
of the MIB, or it can be used to distribute output across multiple
sets of files with different base names.  Because the configuration
file specifies a base name for output files, this option should not
be used together with the
.I \-c
or
.I \-o
options.
.IP \-include\ <filename>
Generate a line in the k_<base>.stb file in the form of
`#include "filename"'.  If this argument is supplied more than once,
a line will be generated for only the last filename.
.IP \-init
Generate k_initialize() and k_terminate() functions in the
k_<base>.stb output file.
.IP \-inputinfo
Read files in the format of snmpinfo.dat and merge the contents
to create a <base>info.dat file.  Only the specified input files
are read.
.IP \-intel
Move strings in <base>\-mib.h and <base>part.h out of DGROUP on
Intel 808x processors.  This option cannot be used with the
.I \-const
option.
.IP \-late
Generate code to perform instance registration for EMANATE.
.IP \-light\ <filename>
Generate output consistent with the usage of the -DLIGHT flag
in the agent.  This option reduces code size by removing
name\-to\-OID translation information from the output.
.IP \-long
Add `L' to D_ macro values in <base>defs.h.
.IP \-mibtree
Generate a <base>info.c file with a MIB Tree data structure.  This file
can then be compiled into an agent or management application when there
is not a file system but you wish to use the mibtree library.
.IP \-mergeinfo
Read files in the format of snmpinfo.dat and merge the contents
to create a <base>info.dat file.  In addition to the specified
input files, also read in snmpinfo.dat.
.IP \-no_undo
Do not generate undo method routines.
.IP \-nocache
Do not add simple caching to the system independent method routines.
.IP \-nodefval
Do not use in the k_<family>_set_defaults() function the value of
the DEFVAL clause from the MIB.
.IP \-noinit
Do not generate k_initialize() and k_terminate() functions in the
k_<base>.stb output file.
.IP \-o\ base
Change the base name of the output files.  The default is `snmp'.
This option should not be used together with the
.I \-c
or
.I \-f
options.
.IP \-offset
Use the SR_OFFSET macro defined in snmpd.h to reduce the code size
in the system independent method routines.  This macro works
correctly only on operating systems where the sizes of pointers and
long types are identical.
.IP \-os
Turn on all flags which will optimize code size (\-nocache,
\-offset, and \-noundo).
.IP \-parser
Use table\-driven parser code for initializing MIB tables.
.IP \-per_file_init
Generate k_<base>_initialize() and k_<base>_terminate instead
of k_initialize() and k_terminate().  This feature is useful to
avoid name collision when multiple k_<base>.c files are linked
together.
.IP \-priority\ #
Set the value of the priority field in the ObjectInfo structure of
<base>oid.c to
.I #.
The default priority is zero.
.IP \-read_create
Add #define <family>_READ_CREATE in v_<base>.stb so
that the default is read\-create rather than than read\-write
for tables.  This is useful for compiling some SNMPv1 MIBs,
since SNMPv1 has no read\-create ACCESS clause.
.IP \-row_status
Use RowStatus TEXTUAL\-CONVENTION support routines.  Using this
option provides a complete, working implementation of the method
routines for read\-create MIB tables.
.IP \-search_table
Generate method routines which use wrappers around the table
manipulation functions in lookup.c.
.IP \-short
Names are limited to 31 characters (useful for old C compilers).
.IP \-snmpmibh
Generate the <base>-mib.h file.  In previous versions of
.I postmosy,
this file was generated by default.
.IP \-storage_type
Use StorageType TEXTUAL\-CONVENTION support routines.
.IP \-stubs_only
Generate only the v_<base>.stb and k_<base>.stb files.
.IP \-test_and_incr
Use TestAndIncr TEXTUAL\-CONVENTION support routines.
.IP \-traps
Generate functions for sending traps.  If the NOTIFICATION\-TYPE
macro in the MIB contains an OBJECTS clause, or if the TRAP\-TYPE
macro in the MIB contains a VARIABLES clause, the VarBind list
for the trap is built automatically.  The functions generated by
this option send traps by calling
.I do_trap(SR_CLIBMAN).
.IP \-userpart
Include U_<family> in the <base>type.h file.  This option adds a
macro to the structure defintion for each MIB family.  The macro
can be used to add user\-defined internally\-available data to 
conceptual tables.

.SH ENVIRONMENT
The following environment variable affects the behavior of
.I postmosy.
.IP SR_MGR_CONF_DIR
This variable changes the location where
.I postmosy
expects to find the snmpinfo.dat file.  This file is accessed
when the
.I \-mergeinfo
option is in effect.

.SH FILES
.IP *.def
MIB definitions files.  These files are generated by
.I mosy(SR_CMDMAN)
and are valid input files for
.I postmosy.
.IP <base>defs.h
Contains macros for enumerated MIB object values in the form of
`#define D_<object>_<enumeration> value'.
.IP <base>info.dat
Contains name\-to\-OID translation information for the MIB.
This is a data file which can be merged with snmpinfo.dat using the
.I \-mergeinfo
option.  Merging this file with snmpinfo.dat allows management
applications to accept the names of new MIB variables on the command
line.
.IP <base>-mib.h
Contains name\-to\-OID translation information for the MIB.
This is a C source code file intended for use in SNMP manager
station application development.  This file is generated by the
.I \-snmpmibh
option.
.IP <base>oid.c
Contains information about each object in the MIB, including
OID structure, the object identifier in ASCII format (if
.I \-light
is not used), MAX\-ACCESS (ACCESS for SNMPv1), family offset,
processing priority (EMANATE only), and associated method routine
pointers.  The format of the file is that of an initializer for
an array of C data structures.
.IP <base>part.h
Contains data structure definitions or external declarations (depending
on the #ifdef settings) for components of the OID for each object in
the MIB, with names in the form of `ID<object>'; also contains macros
for each object in the form of `#define LN_<object> <length>'.
.IP <base>supp.h
Contains macros for leaf objects in the MIB in the form of
`#define I_<object> <family offset>'.  If a macro from this file
is undefined in undefs.h by a C\-preprocessor directive
`#undef I_<object>', no support for the MIB object will be
compiled into the agent.
.IP <base>trap.stb
Contains automatically\-generated functions for sending traps, with
names in the form of send_<alarmName>_trap() and
i_send_<alarmName>_trap().  This file is generated by the
.I \-traps
option.
.IP <base>type.h
Contains a typedef definition of a structure (named <family>_t) for
each family of objects in the MIB; also contains prototypes for
system dependent and system independent method routines.
.IP snmpinfo.dat
The file containing name\-to\-OID translation information which is used
by SNMP Research management applications.  On UNIX systems, the file is
normally located in the directory /etc/srconf/mgr/. (On systems
delivered by Siemens Nixdorf, the location is /etc/snmp/mgr.) This
location can be changed by setting the environment variable
SR_MGR_CONF_DIR.

.SH "SEE ALSO"
.I premosy(SR_CMDMAN),
.I mosy(SR_CMDMAN),
.I do_trap(SR_CLIBMAN),
RFCs 1155, 1157, 1212, and 1902-1908.

.SH DIAGNOSTICS
.IP postmosy:\ open\ for\ read\ failed:
This message indicates that one of the input files does not exist
or that the file permissions do not allow
.I postmosy
to read one of the the input files.
.IP postmosy:\ bad\ input\ line:
This message indicates that the input does not consist entirely
of MIB definitions.
.IP postmosy:\ process_data(),\ Couldn't\ find\ parent:
This message indicates that the input does not contain enough
information to allow
.I postmosy
to compile the MIB defintions.  Usually, this is because the
MIB contains an IMPORTS clause to reference an external MIB
defintion, and the
.I .def
file containing the referenced object or macro is not supplied.
Try adding v2-tc.def, v2-smi.def, or mib-2.def to the list of
input files.
.IP postmosy:\ check_names:\ Duplicate\ name\ with\ different\ OID's:
This message indicates that there is a conflict between objects
definitions in the input.
.IP MakeOIDFromDot\ failed:
This message will occur when using the
.I \-f
option if the configuration file contains the English name of a
MIB variable which does not appear in any of the MIB definitions
.I (*.def)
files.  Try using additional input files, or change the name of the
offending MIB variable from English to the equivalent numeric OID
representation.
.IP truncating\ ...\ to\ ...
This message indicates that a macro, variable, or function name
in the output is being reduced to 31 characters because the
.I \-short
option is in effect.

.SH LIMITATIONS
Some features require the input
.I .def
files to be created by a version of
.I mosy(SR_CMDMAN),
which has been enhanced by SNMP Research.
