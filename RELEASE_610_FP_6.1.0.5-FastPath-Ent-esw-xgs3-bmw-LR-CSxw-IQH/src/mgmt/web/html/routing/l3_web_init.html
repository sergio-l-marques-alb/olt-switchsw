<HTML>


<EMWEB_HEAD C='
    #include "l3_comm_structs.h"
    
    #include "web.h"
    #include "l3_compdefs.h"
  
    #include "usmdb_ip_api.h"
    #include "usmdb_dot3ad_api.h"
    #include "usmdb_mib_vrrp_api.h"
    #include "usmdb_nim_api.h"
    #include "usmdb_sim_api.h"
    #include "usmdb_util_api.h"

#ifdef L7_OSPF_PACKAGE
    #include "usmdb_ospf_api.h"
    #include "usmdb_mib_ospf_api.h"
#endif
    #include "usmdb_mib_relay_api.h"

    #include "usmdb_rlim_api.h"

    #include "osapi_support.h"

    /* ---------------------------------------------------------------------- */
    /*  vr_status.html                                                        */
    /* ---------------------------------------------------------------------- */
    extern L7_uint32 usmWebTotalVrrpConfigGet(L7_uint32 unit);


    /* ---------------------------------------------------------------------- */
    /*  vlan_routing_summ.html                                                */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebVlanRoutingInfoGet(L7_uint32 vlanID);

    /* ---------------------------------------------------------------------- */
    /*  router_discovery_status.html                                          */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebRtrDiscoveryInfoGet(L7_uint32 rtrIntIfnum);

#ifdef L7_OSPF_PACKAGE
    /* ---------------------------------------------------------------------- */
    /*  ospf_area.html                                                        */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebExtRoutingOptionsGet();
    extern L7_RC_t usmWebOspfNonZeroAreaIDIntIfNumGetNext(L7_uint32 unit, L7_uint32 prevIntIfNum, L7_uint32 *nextIntIfNum, L7_uint32 *areaId, L7_uint32 checkForVirtualInterfaceToo);

    /* ---------------------------------------------------------------------- */
    /*  ospf_stub_area_summary.html                                           */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebStubAreaInfoGet(L7_uint32 areaId);

    /* ---------------------------------------------------------------------- */
    /*  ospf_area_range.html                                                  */
    /* ---------------------------------------------------------------------- */
    
    /* ---------------------------------------------------------------------- */
    /*  route_nbr_summ.html                                                   */
    /* ---------------------------------------------------------------------- */
    extern L7_RC_t usmWebIntIfNumGet(L7_uint32 *val);
#endif
    /* ---------------------------------------------------------------------- */
    /*  route_table.html                                                      */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebRouteTableInfoGet(L7_uint32 unit, L7_routeEntry_t  *routeTable);
    extern L7_char8 *usmWebNumRoutesGet();

    /* ---------------------------------------------------------------------- */
    /*  route_entry_cfg.html                                                  */
    /* ---------------------------------------------------------------------- */
    /*extern L7_char8 *usmWebAddRouteInfoGet();
    extern L7_char8 *usmWebDefaultStaticGet(); */
    extern L7_char8 *usmWebRouteEntryInfoGet(L7_uint32 unit, L7_routeEntry_t  routeTable);
    extern L7_char8 *usmWebRouteEntryCfgTableGet(L7_uint32 unit, L7_routeEntry_t routeTableEntry);

#ifdef L7_OSPF_PACKAGE
    /* ---------------------------------------------------------------------- */
    /*  lsa_database.html                                                     */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebLSATableInfoGet(L7_uint32 unit, L7_uint32  routeTable);

    /* ---------------------------------------------------------------------- */
    /*  stats_router_ospf_lsdb.html                                           */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebStatsRouterOspfLsdbInfoGet(L7_uint32 unit);

    extern L7_char8 *usmWebIpRouterIdGet(L7_uint32 unit);

    /* ---------------------------------------------------------------------- */
    /*  ospf_rt_rdstrbtn_summ.html                                            */
    /* ---------------------------------------------------------------------- */
    extern L7_uint32 usmWebTotalOspfConfigGet(L7_uint32 unit);

    /* ---------------------------------------------------------------------- */
    /*  ospf_lsdb_summ.html                                                   */
    /* ---------------------------------------------------------------------- */

    /* ---------------------------------------------------------------------- */
    /*  ospf_vlink_summ.html                                                  */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebVirtLinkInfoGet(L7_uint32 unit, L7_uint32 vlink_entry[]);

#endif
    /* ---------------------------------------------------------------------- */
    /*  ip_cfg.html                                                           */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebIpDefaultTTLGet(L7_uint32 unit);
    extern L7_char8 *usmWebIpRtrAdminModeGet(L7_uint32 unit);
    extern L7_char8 *usmWebIpEcmpModeGet(L7_uint32 unit);
    extern L7_char8 *usmWebIpSpoofingGet(L7_uint32 unit);
    extern L7_char8 *usmWebIpForwardingGet(L7_uint32 unit);
    extern L7_char8 *usmWebIpSourceCheckingGet(L7_uint32 unit);
    extern L7_char8 *usmWebIpNumOfInterfacesGet(L7_uint32 unit);
    extern L7_char8 *usmWebIpNumOfActiveRoutesGet(L7_uint32 unit);
    extern L7_char8 *usmWebIpNetDirectBcastsGet(L7_uint32 unit);
    extern L7_char8 *usmWebIpMaxNextHopsGet(L7_uint32 unit);
    extern L7_char8 *usmWebICMPEchoReplyModeGet(void);
    extern L7_char8 *usmWebICMPRedirectsModeGet(void);
    extern L7_char8 *usmWebICMPRateLimitIntervalGet(void);
    extern L7_char8 *usmWebICMPRateLimitBurstSizeGet(void);

    /* ---------------------------------------------------------------------- */
    /*  arp_table_cfg.html                                                    */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebIpArpAgeTimeGet(L7_uint32 unit);
    extern L7_char8 *usmWebIpArpRespTimeGet(L7_uint32 unit);
    extern L7_char8 *usmWebIpArpRetriesGet(L7_uint32 unit);
    extern L7_char8 *usmWebIpArpCacheSizeGet(L7_uint32 unit);
    extern L7_char8 *usmWebArpInfoGet(L7_uint32 lvl7_flag, L7_uint32 unit, L7_arpEntry_t arpEntry_itr);
    extern L7_char8 *usmWebDynamicRenewModeGet(L7_uint32 unit);
    extern L7_char8 *usmWebTotalEntryCountGet(L7_uint32 unit);
    extern L7_char8 *usmWebPeakTotalEntryGet(L7_uint32 unit);
    extern L7_char8 *usmWebStaticEntryCountGet(L7_uint32 unit);
    extern L7_char8 *usmWebCfgStaticEntryCountGet(L7_uint32 unit);
    extern L7_char8 *usmWebMaxStaticEntryGet(L7_uint32 unit);

    /* ---------------------------------------------------------------------- */
    /*  arp_create.html                                                       */
    /* ---------------------------------------------------------------------- */
    extern L7_BOOL usmWebConvMac(L7_uchar8 *buf, L7_uchar8 *mac);

    /* ---------------------------------------------------------------------- */
    /*  bridging_cfg.html                                                     */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebIntfBridgGet(L7_uint32 unit);
    extern L7_char8 *usmWebBridgStateGet(L7_uint32 unit);
    extern L7_char8 *usmWebBridgPortGet(L7_uint32 unit);
    extern L7_char8 *usmWebBridgSwitchGet(L7_uint32 unit);



    /* ---------------------------------------------------------------------- */
    /*  route_table_good.html                                                 */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebGoodRouteTableInfoGet(L7_uint32 unit, L7_routeEntry_t  *routeTable);
    extern L7_char8 *usmWebNumGoodRoutesGet();

    /* ---------------------------------------------------------------------- */
    /*  ip_stats_info.html                 vvv                                */
    /* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebIpInReceivesGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpInHdrErrorsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpInAddrErrorsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpForwDatagramsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpInUnknownProtosGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpInDiscards64(L7_uint32 unit);
    extern L7_char8 *usmWebIpInDelivers64(L7_uint32 unit);
    extern L7_char8 *usmWebIpOutRequests64(L7_uint32 unit);
    extern L7_char8 *usmWebIpOutDiscardsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpNoRoutesGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpReasmTimeoutGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpReasmReqdsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpReasmOKsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpReasmFailsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpFragOKsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpFragFailsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpFragCreatesGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIpRoutingDiscardsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInMsgsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInErrorsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInDestUnreachsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInTimeExcdsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInParmProbsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInSrcQuenchsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInRedirectsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInEchosGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInEchoRepsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInTimestampsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInTimestampRepsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInAddrMasksGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpInAddrMaskRepsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutMsgsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutErrorsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutDestUnreachsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutTimeExcdsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutParmProbsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutSrcQuenchsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutRedirectsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutEchosGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutEchoRepsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutTimestampsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutTimestampRepsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutAddrMasksGet64(L7_uint32 unit);
    extern L7_char8 *usmWebIcmpOutAddrMaskRepsGet64(L7_uint32 unit);
    extern L7_char8 *usmWebTimeSinceLastIPStatsResetGet(L7_uint32 unit);

    /* ---------------------------------------------------------------------- */
    /*  relay_cfg.html                                                        */
    /* ---------------------------------------------------------------------- */
	extern L7_char8 *usmWebRelayForwardIpGet(L7_uint32 unit);
	extern L7_char8 *usmWebRelayForwardModeGet(L7_uint32 unit);
	extern L7_char8 *usmWebRelayMaxHopCountGet(L7_uint32 unit);
	extern L7_char8 *usmWebRelayMinWaitTimeGet(L7_uint32 unit);
	extern L7_char8 *usmWebRelayCircuitIdOptionModeGet(L7_uint32 unit);
	extern L7_char8 *usmWebRelayNumOfPacketsReceivedGet(L7_uint32 unit);
	extern L7_char8 *usmWebRelayNumOfPacketsRelayedGet(L7_uint32 unit);
	extern L7_char8 *usmWebRelayNumOfPacketsDiscardedGet(L7_uint32 unit);

#ifdef L7_RLIM_PACKAGE
	/* ---------------------------------------------------------------------- */
	/*  loopback_summ.html				                                      */
	/* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebLoopbackInfoGet(L7_char8 *lidStr);

	/* ---------------------------------------------------------------------- */
	/*  tunnel_summ.html				                                      */
	/* ---------------------------------------------------------------------- */
    extern L7_char8 *usmWebTunnelInfoGet(L7_uint32 tunnelId);
#endif


 ' >

<!-- Macro Definitions Here -->


<EMWEB_IF ID=USMWEB_IF_RTR_ITERFACE_AVAILABLE C='

    L7_uint32   unit;
    L7_BOOL     intfFound=L7_FALSE;
    L7_uint32   intIfNum;
    L7_RC_t     rc;
    L7_uint32 sysIntfType;
    L7_uint32 status;
    L7_uint32 lag;

    unit = usmDbThisUnitGet();

    rc = usmDbValidIntIfNumFirstGet(&intIfNum);

    if (rc != L7_SUCCESS)
      return L7_NULL;
    else
    {
    }
    intfFound = L7_FALSE;

    while ((intfFound == L7_FALSE) && (rc == L7_SUCCESS))
    {
      if (usmDbIntfTypeGet(intIfNum, &sysIntfType) == L7_SUCCESS)
      {
        status = usmDbDot3adIntfIsMemberGet(unit, intIfNum, &lag);
        if ( ( ((sysIntfType == L7_PHYSICAL_INTF) &&
                (usmDbComponentPresentCheck(unit, L7_IP_MAP_COMPONENT_ID) == L7_TRUE)) ||
               (sysIntfType == L7_LOGICAL_VLAN_INTF)    ) &&
             (status != L7_SUCCESS))
        {
          intfFound = L7_TRUE;
        }
        else
        {
          rc = usmDbValidIntIfNumNext(intIfNum, &intIfNum);
        }
      }
    }
    if (intfFound == L7_TRUE)
      return "L7_TRUE";
    else
	  return NULL;
 '>
 </EMWEB_IF>


<EMWEB_IF ID=USMWEB_IF_RTR_PORT_ENABLED C='

	L7_uint32 index, mode;
    L7_uint32 unit;
    L7_BOOL interface_enabled=L7_FALSE;

    unit = usmDbThisUnitGet();

	for (index = 1; index < L7_ALL_INTERFACES; index++)
	{
			if(usmDbIpRtrIntfModeGet(unit, index,&mode)== L7_SUCCESS && mode == L7_ENABLE)
			{
              interface_enabled = L7_TRUE;
              break;
			}
            mode = L7_DISABLE;
	}
    if(interface_enabled == L7_TRUE)
      return "L7_TRUE";
    else
	  return NULL;
 '>
 </EMWEB_IF>

<EMWEB_IF ID=USMWEB_IF_OSPF_INTERFACE_ENABLED C='
#ifdef L7_OSPF_PACKAGE
	L7_uint32 index;
    L7_uint32 unit;
    L7_BOOL ospf_interface_enabled=L7_FALSE;

    unit = usmDbThisUnitGet();

	for (index = 1; index < L7_ALL_INTERFACES; index++)
	{
			if(usmDbOspfIntfExists(unit, index) == L7_TRUE)
			{
              ospf_interface_enabled = L7_TRUE;
              break;
			}
	}
    if(ospf_interface_enabled == L7_TRUE)
      return "L7_TRUE";
    else
	  return NULL;
#endif
 '>
 </EMWEB_IF>


<EMWEB_IF ID=USMWEB_IF_AREAS_EXIST C='

#ifdef L7_OSPF_PACKAGE
  L7_uint32 val = 0;
  L7_uint32  unit;
  unit = usmDbThisUnitGet();

  if (usmDbOspfAreaIdGetNext(unit, 0, &val) == L7_SUCCESS)
    return "AREAS_EXIST";
  else
    return NULL;
#endif

'>
</EMWEB_IF>

<EMWEB_IF ID=USMWEB_IF_AREAS_EXIST_INCLUDING_AREA_ZERO C='

#ifdef L7_OSPF_PACKAGE
  L7_uint32 first_areaid;
  L7_uint32  unit;
  unit = usmDbThisUnitGet();

  if (usmDbOspfAreaIdGet(unit, &first_areaid) == L7_SUCCESS)
    return "AREAS_EXIST";
  else
    return NULL;
#endif

'>
</EMWEB_IF>

<EMWEB_IF ID=USMWEB_CONTAINS_AREA_ENTRIES C='

#ifdef L7_OSPF_PACKAGE
    EwaNetHandle      net;
    usmWeb_AppInfo_t  appInfo;
    L7_uint32 first_areaid;
    L7_uint32  unit;
unit = usmDbThisUnitGet();

    net = ewsContextNetHandle(ewsContext);
    if (net->app_pointer != NULL)
    {
      memcpy(&appInfo, net->app_pointer, sizeof(usmWeb_AppInfo_t));
      if ( appInfo.data[0] == 0 )
          return NULL;
      else
          return "TRUE";
    }
    else
    {
      if ((usmDbOspfAreaCfgGetFirst(unit, &first_areaid) == L7_SUCCESS) && (first_areaid != 0))
      {
         return "AREA_ENTRIES";
      }
      else
      {
         return NULL;
      }
    }

    return NULL;
#endif
'>
</EMWEB_IF>

<EMWEB_IF ID=USMWEB_IF_MD5_OR_SIMPLE_ENCRYPTION C='

#if defined L7_OSPF_PACKAGE || defined L7_RIP_PACKAGE
  EwaNetHandle      net;
  usmWeb_AppInfo_t  appInfo;
  L7_uint32 val;

  net = ewsContextNetHandle(ewsContext);

  memcpy(&appInfo, net->app_pointer, sizeof(usmWeb_AppInfo_t));
  val = appInfo.data[1];

  if (val == L7_AUTH_TYPE_MD5 || val == L7_AUTH_TYPE_SIMPLE_PASSWORD)
        return "MD5_or_SIMPLE";

  return NULL;
#endif

  '>
</EMWEB_IF>

<EMWEB_IF ID=USMWEB_IF_MD5_ENCRYPTION C='

#if defined L7_OSPF_PACKAGE || defined L7_RIP_PACKAGE
  EwaNetHandle      net;
  usmWeb_AppInfo_t  appInfo;
  L7_uint32 val;

  net = ewsContextNetHandle(ewsContext);

  memcpy(&appInfo, net->app_pointer, sizeof(usmWeb_AppInfo_t));
  val = appInfo.data[1];

  if (val == L7_AUTH_TYPE_MD5)
        return "MD5_or_SIMPLE";

  return NULL;
#endif

  '>
</EMWEB_IF>


<EMWEB_IF ID=USMWEB_SEC_IPADDR_CREATE C='

    EwaNetHandle      net;
    usmWeb_AppInfo_t  appInfo;

    net = ewsContextNetHandle(ewsContext);
    if (net->app_pointer != NULL)
    {
      memcpy(&appInfo, net->app_pointer, sizeof(usmWeb_AppInfo_t));
      if ( appInfo.data[1] == 0 )  /* Indicates that none are configured, create selected */
        return "TRUE";
      else
        return NULL;
    }

    return "TRUE";
'>
</EMWEB_IF>

<EMWEB_IF ID=USMWEB_SEC_IPADDR_EXISTS C='

    EwaNetHandle        net;
    usmWeb_AppInfo_t    appInfo;
    L7_RC_t             rc;
    L7_BOOL             intfFound;
    L7_uint32           intIfNum;
    L7_uint32           sysIntfType;
    L7_uint32           lag;
    L7_uint32           status;
    L7_uint32           unit;
    L7_uint32           ndx;
    L7_rtrIntfIpAddr_t  ipAddrList[L7_L3_NUM_IP_ADDRS];

    unit = usmDbThisUnitGet();

    net = ewsContextNetHandle(ewsContext);
    if (net->app_pointer != NULL)
    {
      memcpy(&appInfo, net->app_pointer, sizeof(usmWeb_AppInfo_t));
      intIfNum = appInfo.data[0];
    }
    else  /* Find the first valid routing interface */
    {
      intfFound = L7_FALSE;
      rc = usmDbValidIntIfNumFirstGet(&intIfNum);
      while ((intfFound == L7_FALSE) && (rc == L7_SUCCESS))
      {
        if (usmDbIntfTypeGet(intIfNum, &sysIntfType) == L7_SUCCESS)
        {
          status = usmDbDot3adIntfIsMemberGet(unit, intIfNum, &lag);
          if ( ( ((sysIntfType == L7_PHYSICAL_INTF) &&
                  (usmDbComponentPresentCheck(unit, L7_IP_MAP_COMPONENT_ID) == L7_TRUE)) ||
                 (sysIntfType == L7_LOGICAL_VLAN_INTF)    ) &&
               (status != L7_SUCCESS))
          {
            intfFound = L7_TRUE;
          }
          else
          {
            rc = usmDbValidIntIfNumNext(intIfNum, &intIfNum);
          }
        }
      }
    }

    if (intIfNum != 0) /* Are there any secondary ip addresses configured ? */
    {
      ndx = 0;
      memset(ipAddrList, 0x00, sizeof(L7_rtrIntfIpAddr_t) * L7_L3_NUM_IP_ADDRS);
      /* Find the first configured address if it exists */
      if (usmDbIpRtrIntfCfgIpAddrListGet(unit, intIfNum, ipAddrList) == L7_SUCCESS)
      {
        /* Find the first configured address if it exists */
        ndx = 0;
        if (ipAddrList[ndx].ipAddr != 0) /* Primary configured */
        {
          ndx++;
          while ((ipAddrList[ndx].ipAddr == 0) && (ndx <L7_L3_NUM_IP_ADDRS-1))
            ndx++;   /*fast forward to the next occupied array cell*/
        }
        else
        {
          return NULL;
        }
      }
      else
      {
        return NULL;
      }
      if (ipAddrList[ndx].ipAddr != 0)
        return "TRUE";
      else
        return NULL;
    }

    return NULL;
'>
</EMWEB_IF>


<EMWEB_IF ID=USMWEB_PRIMARY_IPADDR_CONFIGURED C='

    EwaNetHandle        net;
    usmWeb_AppInfo_t    appInfo;
    L7_RC_t             rc;
    L7_BOOL             intfFound;
    L7_uint32           intIfNum;
    L7_uint32           sysIntfType;
    L7_uint32           lag;
    L7_uint32           status;
    L7_uint32           unit;
    L7_uint32           ipval, subval;

    unit = usmDbThisUnitGet();

    net = ewsContextNetHandle(ewsContext);
    if (net->app_pointer != NULL)
    {
      memcpy(&appInfo, net->app_pointer, sizeof(usmWeb_AppInfo_t));
      intIfNum = appInfo.data[0];
    }
    else  /* Find the first valid routing interface */
    {
      intfFound = L7_FALSE;
      rc = usmDbValidIntIfNumFirstGet(&intIfNum);
      while ((intfFound == L7_FALSE) && (rc == L7_SUCCESS))
      {
        if (usmDbIntfTypeGet(intIfNum, &sysIntfType) == L7_SUCCESS)
        {
          status = usmDbDot3adIntfIsMemberGet(unit, intIfNum, &lag);
          if ( ( ((sysIntfType == L7_PHYSICAL_INTF) &&
                  (usmDbComponentPresentCheck(unit, L7_IP_MAP_COMPONENT_ID) == L7_TRUE)) ||
                 (sysIntfType == L7_LOGICAL_VLAN_INTF)    ) &&
               (status != L7_SUCCESS))
          {
            intfFound = L7_TRUE;
          }
          else
          {
            rc = usmDbValidIntIfNumNext(intIfNum, &intIfNum);
          }
        }
      }
    }

    if (intIfNum != 0) /* Are there any secondary ip addresses configured ? */
    {
      ipval = 0;
      /* Find the first configured address if it exists */
      if (usmDbIpRtrIntfIpAddressGet(unit, intIfNum, &ipval, &subval) == L7_SUCCESS)
      {
        if (ipval != 0)
          return "TRUE";
        else
          return NULL;
      }
      else
      {
        return NULL;
      }
    }

    return NULL;
'>
</EMWEB_IF>

<EMWEB_IF ID=USMWEB_HELPER_IPADDR_CREATE C='

    EwaNetHandle      net;
    usmWeb_AppInfo_t  appInfo;

    net = ewsContextNetHandle(ewsContext);
    if (net->app_pointer != NULL)
    {
      memcpy(&appInfo, net->app_pointer, sizeof(usmWeb_AppInfo_t));
      if ( appInfo.data[1] == 0 )  /* Indicates that none are configured, create selected */
        return "TRUE";
      else
        return NULL;
    }

    return "TRUE";
'>
</EMWEB_IF>

<EMWEB_IF ID=USMWEB_VRSEC_IPADDR_CREATE C='
#ifdef L7_VRRP_PACKAGE
    EwaNetHandle      net;
    usmWeb_AppInfo_t  appInfo;

    net = ewsContextNetHandle(ewsContext);
    if (net->app_pointer != NULL)
    {
      memcpy(&appInfo, net->app_pointer, sizeof(usmWeb_AppInfo_t));
      if ( appInfo.data[1] == 0 )  /* Indicates that none are configured, create selected */
        return "TRUE";
      else
        return NULL;
    }

    return "TRUE";
#endif
'>
</EMWEB_IF>


<EMWEB_IF ID=USMWEB_VRSEC_IPADDR_EXISTS C='

#ifdef L7_VRRP_PACKAGE
    EwaNetHandle        net;
    usmWeb_AppInfo_t    appInfo;
    L7_uint32           intIfNum, vrid;
    L7_uint32           unit;
    L7_uint32           ipval;

    unit = usmDbThisUnitGet();

    net = ewsContextNetHandle(ewsContext);
    if (net->app_pointer != NULL)
    {
      memcpy(&appInfo, net->app_pointer, sizeof(usmWeb_AppInfo_t));
      intIfNum = appInfo.data[0];
      vrid = appInfo.data[5];
    }
    else
    {
      if (usmDbVrrpOperFirstGet(unit, (L7_uchar8 *) &vrid, &intIfNum) != L7_SUCCESS)
      {
        intIfNum = 0;
        vrid = 0;
      }
    }

    if (intIfNum != 0) /* Are there any secondary ip addresses configured ? */
    {
      ipval = 0;
      /* Find the first configured address if it exists */

      if (usmDbVrrpIpAddressNextGet(unit, (L7_uchar8) vrid, intIfNum, 0, &ipval) != L7_SUCCESS)
        return NULL;

      if (usmDbVrrpIpAddressNextGet(unit, (L7_uchar8) vrid, intIfNum, ipval, &ipval) != L7_SUCCESS)
        ipval = 0;

      if (ipval != 0)
        return "TRUE";
      else
        return NULL;
    }

    return NULL;
#endif
'>
</EMWEB_IF>


<EMWEB_IF ID=USMWEB_VRPRIMARY_IPADDR_CONFIGURED C='

#ifdef L7_VRRP_PACKAGE
    EwaNetHandle        net;
    usmWeb_AppInfo_t    appInfo;
    L7_uint32           intIfNum;
    L7_uint32           unit;
    L7_uint32           ipval, vrid;

    unit = usmDbThisUnitGet();

    net = ewsContextNetHandle(ewsContext);
    if (net->app_pointer != NULL)
    {
      memcpy(&appInfo, net->app_pointer, sizeof(usmWeb_AppInfo_t));
      intIfNum = appInfo.data[0];
      vrid = appInfo.data[5];
    }
    else  /* Find the first valid vrrp interface */
    {
      if (usmDbVrrpOperFirstGet(unit, (L7_uchar8 *) &vrid, &intIfNum) != L7_SUCCESS)
      {
        intIfNum = 0;
        vrid = 0;
      }
    }

    if (intIfNum != 0) /* Is the primary ip address configured ? */
    {
      ipval = 0;
      /* Find the first configured address if it exists */

      if (usmDbVrrpIpAddressNextGet(unit, (L7_uchar8) vrid, intIfNum, 0, &ipval) != L7_SUCCESS)
        ipval = 0;

      if (ipval != 0)
        return "TRUE";
      else
        return NULL;
    }

    return NULL;
#endif
'>
</EMWEB_IF>


</HTML>



