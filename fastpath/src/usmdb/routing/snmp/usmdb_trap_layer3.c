/*********************************************************************
*
* (C) Copyright Broadcom Corporation 2000-2007
*
**********************************************************************
*
* @filename src\usmdb\usmdb_trap_layer3.c
*
* @purpose Usmdb Layer 3 trap functions
*
* @component unitmgr
*
* @comments none
*
* @created 06/28/2001
*
* @author anayar
*
* @end
*             
**********************************************************************/

/*************************************************************
                    
*************************************************************/



#include "l7_common.h"
#include "usmdb_trap_layer3_api.h"

/*********************************************************************
*
* @purpose  Signifies a change in the state of an OSPF virtual interface.
*
* @param    UnitIndex              @b((input))L7_uint32 the unit for this operation
* @param  L7_uint32 routerid       @b((input)) The ip address of the router originating the trap.
* @param  L7_uint32 virtIfAreaId   @b((input)) The area ID of the Virtual Interface to which
*                                  this RTO is attached.
* @param  L7_uint32 virtIfNeighbor @b((input)) The Neighbor Router ID to which this interface
*                                  is connected.
* @param  L7_uint32 virtIfState    @b((input)) The Virtual Interface Hello protocol State machine state.
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes  This trap is generated when the interface state regresses or 
*         progresses to a terminal state. 
*
* @end
*********************************************************************/
L7_RC_t usmDbVirtIfStateChange(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 virtIfAreaId,
                                 L7_uint32 virtIfNeighbor, L7_uint32 virtIfState)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies a change in the state of a non-virtual OSPF neighbor.
*
* @param    UnitIndex             @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId    @b((input)) The ip address of the router originating the trap.
* @param    L7_uint32 nbrIpAddr   @b((input)) The IP address this neighbor is using as this 
*                                 IP Source Address.
* @param    L7_uint32 nbrAddressLessIndex  @b((input)) On an interface having and IP Address, "0".  
*                                          On an interface without an address, the 
*                                          corresponding value of ifIndex for this
*                                          interface in the Internet Standard MIB 
*                                          ifTable.  This index is usually used in 
*                                          an unnumbered interface as a reference to
*                                          the local router's control application 
*                                          interface table.
* @param    L7_uint32 nbrRtrId     @b((input)) A 32-bit integer uniquely indentifying the neighboring
*                                  router in the AS (Autonomous System).
* @param    L7_uint32 nbrState     @b((input)) The new NBR state.  NBR states are defined in the 
*                                  OSPF MIB.(pg. 126)
*
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes  This trap is generated when the neighbor state regresses or 
*         progresses to a terminal state.  When a neighbor transitions 
*         from or to Full on non-broadcast multi-access and broadcast 
*         networks, the trap should be generated by the designated router.
*         A designated router transitioning to Down will be noted by 
*         ospfIfStateChange. 
*
* @end
*********************************************************************/
L7_RC_t usmDbNbrStateChange(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 nbrIpAddr,
                              L7_uint32 nbrAddressLessIndex,
                              L7_uint32 nbrRtrId, L7_uint32 nbrState)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies that there  has been a change in the state of a 
*           virtual OSPF neighbor.
*
* @param    UnitIndex              @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId     @b((input)) The originator of the trap.
* @param    L7_uint32 virtNbrArea  @b((input)) The IP address this neighbor is using as this
* @param                           IP Source address.
* @param    L7_uint32 nbrRtrId     @b((input)) A 32-bit integer uniquely indentifying the neighboring
*                                  router in the AS (Autonomous System).
* @param    L7_uint32 virtNbrState @b((input)) The new state
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes   This  trap  should  be generated  when  the  neighbor
*          state regresses (e.g., goes from Attempt or Full 
*          to  1-Way  or Down)  or progresses to a terminal 
*          state (e.g., 2-Way or Full).  When an  neighbor 
*          transitions from  or  to Full on non-broadcast
*          multi-access and broadcast networks, the trap should
*          be generated  by the designated router.  A designated      
*          router transitioning to Down will be  noted  by      
*          ospfIfStateChange." 
*
* @end
*********************************************************************/
L7_RC_t usmDbVirtNbrStateChange(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 virtNbrArea,
                                  L7_uint32 virtNbrRtrId, L7_uint32 virtNbrState)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies that a packet has been received on a non-virtual 
*           interface from a router whose configuration parameters  conflict  
*           with this router's configuration parameters.
*
* @param    UnitIndex                 @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId        @b((input)) The originator of the trap.
* @param    L7_uint32 ifIpAddress     @b((input)) Interface's IP address.
* @param    L7_uint32 addressLessIf   @b((input)) On an interface having an IP address, "0".
*                                     On an interface without an address, the corresponding
*                                     value of ifIndex.
* @param    L7_uint32 packetSrc       @b((input)) The source IP Address.
* @param    L7_uint32 configErrorType @b((input)) Type of error.
* @param    L7_uint32 packetType      @b((input)) Type of packet.
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes   Note that the event optionMismatch should cause a trap only
*          if it prevents an adjacency from forming. 
*
* @end
*********************************************************************/
L7_RC_t usmDbIfConfigError(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 ifIpAddress,
                             L7_uint32 addressLessIf, L7_uint32 packetSrc,
                             L7_uint32 configErrorType, L7_uint32 packetType)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies that a packet has been received on a virtual 
*           interface from a router whose configuration parameters  conflict  
*           with this router's configuration parameters.
*
* @param    UnitIndex                 @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId        @b((input)) The originator of the Trap
* @param    L7_uint32 virtIfAreaId    @b((input)) The area ID of the Virtual Interface to which
*                                     this RTO is attached.
* @param    L7_uint32 virtIfNeighbor  @b((input)) The Neighbor Router ID to which this interface
*                                     is connected.
* @param    L7_uint32 configErrorType @b((input)) Type of error
* @param    L7_uint32 packetType      @b((input)) Type of packet.
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes   Note that the event optionMismatch should cause a trap only
*          if it prevents an adjacency from forming. 
*
* @end
*********************************************************************/
L7_RC_t usmDbVirtIfConfigError(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 virtIfAreaId,
                                 L7_uint32 virtIfNeighbor,
                                 L7_uint32 configErrorType,
                                 L7_uint32 packetType)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose Signifies that a packet has been received on a non-virtual
*          interface from a router whose authentication key or 
*          authentication type conflicts with this router's 
*          authentication key or authentication type.
*
* @param    UnitIndex                 @b((input))L7_uint32 the unit for this operation
* @param   L7_uint32 routerId         @b((input)) The originator of the trap.
* @param   L7_uint32 ifIpAddress      @b((input)) Interface's IP address.
* @param   L7_uint32 addressLessIf    @b((input)) On an interface having an IP address, "0".
*                                     On an interface without an address, the corresponding
*                                     value of ifIndex.
* @param   L7_uint32 packetSrc        @b((input)) The source IP Address
* @param   L7_uint32 configErrorType  @b((input)) Auth type mismatch or auth failure
* @param   L7_uint32 packetType       @b((input)) Type of packet.
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes   
*
* @end
*********************************************************************/
L7_RC_t usmDbIfAuthFailure(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 ifIpAddress,
                             L7_uint32 addressLessIf, L7_uint32 packetSrc,
                             L7_uint32 configErrorType, L7_uint32 packetType)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose Signifies that a packet has been received on a virtual
*          interface from a router whose authentication key or 
*          authentication type conflicts with this router's 
*          authentication key or authentication type.
*
* @param    UnitIndex                 @b((input))L7_uint32 the unit for this operation
* @param   L7_uint32 routerId         @b((input)) The originator of the trap.
* @param   L7_uint32 virtIfAreaId     @b((input)) The area ID of the Virtual Interface to which
*                                     this RTO is attached.
* @param   L7_uint32 virtIfNeighbor   @b((input)) The Neighbor Router ID to which this interface
*                                     is connected.
* @param   L7_uint32 configErrorType  @b((input)) Auth type mismatch or auth failure.
* @param   L7_uint32 packetType       @b((input)) Type of packet.
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes   
*
* @end
*********************************************************************/
L7_RC_t usmDbVirtIfAuthFailure(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 virtIfAreaId,
                                 L7_uint32 virtIfNeighbor,
                                 L7_uint32 configErrorType,
                                 L7_uint32 packetType)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies that an OSPF packet has been received on a 
*           non-virtual interface that cannot be parsed.
*
* @param    UnitIndex                 @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId        @b((input)) The originator of the Trap
* @param    L7_uint32 ifIpAddress     @b((input)) Interface's IP address.
* @param    L7_uint32 addressLessIf   @b((input)) On an interface having an IP address, "0".
*                                     On an interface without an address, the corresponding
*                                     value of ifIndex.
* @param    L7_uint32 packetSrc       @b((input)) The source IP address
* @param    L7_uint32 packetType      @b((input)) Type of packet.
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes    
*
* @end
*********************************************************************/
L7_RC_t usmDbIfRxBadPacket(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 ifIpAddress,
                             L7_uint32 addressLessIf, L7_uint32 packetSrc,
                             L7_uint32 packetType)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies that an OSPF packet has been received on a 
*           virtual interface that cannot be parsed.
*
* @param    UnitIndex                 @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId        @b((input)) The originator of the trap.
* @param    L7_uint32 virtIfAreaId    @b((input)) The area ID of the Virtual Interface to which
*                                     this RTO is attached.
* @param    L7_uint32 virtIfNeighbor  @b((input)) The Neighbor Router ID to which this interface
*                                     is connected.
* @param    L7_uint32 packetType      @b((input)) Type of packet.
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes    
*
* @end
*********************************************************************/
L7_RC_t usmDbVirtIfRxBadPacket(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 virtIfAreaId,
                                 L7_uint32 virtIfNeighbor, L7_uint32 packetType)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies than an OSPF packet has been retransmitted on a 
*           non-virtual interface.
*
* @param    UnitIndex                 @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId        @b((input)) The originator of the trap.
* @param    L7_uint32 ifIpAddress     @b((input)) Interface's IP address.
* @param    L7_uint32 addressLessIf   @b((input)) On an interface having an IP address, "0".
*                                     On an interface without an address, the corresponding
*                                     value of ifIndex.
* @param    L7_uint32 nbrRtrId        @b((input)) Neighboring router.
* @param    L7_uint32 packetType      @b((input)) Type of packet.
* @param    L7_uint32 lsdbType        @b((input)) The type of the link state advertisement.
* @param    L7_uint32 lsdbLsid        @b((input)) Link state ID.
* @param    L7_uint32 lsdbRouterId    @b((input)) Router ID of originating router.
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes    All packets that may be re-transmitted  are associated 
*           with an LSDB entry.  The LS type, LS ID, and Router ID 
*           are used to identify the LSDB entry.
*
* @end
*********************************************************************/
L7_RC_t usmDbTxRetransmit(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 ifIpAddress,
                            L7_uint32 addressLessIf, L7_uint32 nbrRtrId,
                            L7_uint32 packetType, L7_uint32 lsdbType,
                            L7_uint32 lsdbLsid, L7_uint32 lsdbRouterId)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies than an OSPF packet has been retransmitted on a 
*           virtual interface.
*
* @param    UnitIndex                 @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId        @b((input)) The originator of the trap
* @param    L7_uint32 virtIfAreaId    @b((input)) The area ID of the Virtual Interface to which
*                                     this RTO is attached.
* @param    L7_uint32 virtIfNeighbor  @b((input)) The Neighbor Router ID to which this interface
*                                     is connected.
* @param    L7_uint32 packetType      @b((input)) Type of packet.
* @param    L7_uint32 lsdbType        @b((input)) The type of the link state advertisement.
* @param    L7_uint32 lsdbLsid        @b((input)) Link state ID.
* @param    L7_uint32 lsdbRouterId    @b((input)) Router ID of originating router.
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes    All packets that may be re-transmitted  are associated 
*           with an LSDB entry.  The LS type, LS ID, and Router ID 
*           are used to identify the LSDB entry.
*
* @end
*********************************************************************/
L7_RC_t usmDbVirtTxRetransmit(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 virtIfAreaId,
                                L7_uint32 virtIfNeighbor, L7_uint32 packetType,
                                L7_uint32 lsdbType, L7_uint32 lsdbLsid,
                                L7_uint32 lsdbRouterId)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies that a  new LSA  has  been originated by this router.
*
* @param    UnitIndex                 @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId        @b((input)) The originator of the trap.
* @param    L7_uint32 lsdbAreaId      @b((input)) Area from which the LSA was received.
*                                     0.0.0.0 for AS Externals.
* @param    L7_uint32 lsdbType        @b((input)) The type of the link state advertisement.
* @param    L7_uint32 lsdbLsid        @b((input)) Link state ID.
* @param    L7_uint32 lsdbRouterId    @b((input)) Router ID of originating router.
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes    This trap should not be invoked for simple refreshes of  
*           LSAs  (which happesn every 30 minutes), but       
*           instead will only be invoked  when  an  LSA  is       
*           (re)originated due to a topology change.  Addi-       
*           tionally, this trap does not include LSAs  that       
*           are  being  flushed  because  they have reached       
*           MaxAge.
*
* @end
*********************************************************************/
L7_RC_t usmDbOriginateLsa(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 lsdbAreaId,
                            L7_uint32 lsdbType, L7_uint32 lsdbLsid,
                            L7_uint32 lsdbRouterId)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies that one of the LSA in the router's link-state 
*           database has aged to MaxAge.
*
* @param    UnitIndex                 @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId        @b((input)) The originator of the trap
* @param    L7_uint32 lsdbAreaId      @b((input)) Area from which the LSA was received.
*                                     0.0.0.0 for AS Externals.
* @param    L7_uint32 lsdbType        @b((input)) The type of the link state advertisement.
* @param    L7_uint32 lsdbLsid        @b((input)) Link state ID.
* @param    L7_uint32 lsdbRouterId    @b((input)) Router ID of originating router.
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes    
*
* @end
*********************************************************************/
L7_RC_t usmDbMaxAgeLsa(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 lsdbAreaId,
                         L7_uint32 lsdbType, L7_uint32 lsdbLsid,
                         L7_uint32 lsdbRouterId)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies that the number of LSAs in the router's link-state 
*           data-base has exceeded ospfExtLsdbLimit.
*
* @param    UnitIndex               @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId      @b((input)) The originator of the trap
* @param    L7_uint32 extLsdbLimit  @b((input)) The maximum number of non-default AS-external-LSAs
*                                   entries that can be stored in the link-state database.
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes    
*
* @end
*********************************************************************/
L7_RC_t usmDbLsdbOverflow(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 extLsdbLimit)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies that  the  number of LSAs in the router's link-
*           state database has exceeded ninety  percent  of      
*           ospfExtLsdbLimit.
*
* @param    UnitIndex               @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId      @b((input)) The originator of the trap
* @param    L7_uint32 extLsdbLimit  @b((input)) The maximum number of non-default AS-external-LSAs
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes    
*
* @end
*********************************************************************/
L7_RC_t usmDbLsdbApproachingOverflow(L7_uint32 UnitIndex, L7_uint32 routerId,
                                       L7_uint32 extLsdbLimit)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies that there has been a change in the state of a 
*           non-virtual OSPF interface.
*
* @param    UnitIndex                @b((input))L7_uint32 the unit for this operation
* @param    L7_uint32 routerId       @b((input)) The originator of the trap
* @param    L7_uint32 ifIpAddress    @b((input)) Interface's IP address.
* @param    L7_uint32 addressLessIf  @b((input)) On an interface having an IP address, "0".
*                                    On an interface without an address, the corresponding
*                                    value of ifIndex.
* @param    L7_uint32 ifState        @b((input)) New state
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes   This trap should  be  generated when  the interface state 
*          regresses (e.g., goes from Dr to Down) or progresses  to  a  terminal      
*          state  (i.e.,  Point-to-Point, DR Other, Dr, or Backup).
*
* @end
*********************************************************************/
L7_RC_t usmDbIfStateChange(L7_uint32 UnitIndex, L7_uint32 routerId, L7_uint32 ifIpAddress,
                             L7_uint32 addressLessIf, L7_uint32 ifState)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies that an OSPF packet was received on a non-virtual interface. 
*
* @param    UnitIndex              @b((input))L7_uint32 the unit for this operation
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes   
*
* @end
*********************************************************************/
L7_RC_t usmDbIfRxPacket(L7_uint32 UnitIndex)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}

/*********************************************************************
*
* @purpose  Signifies that an entry has been made in the OSPF routing table. 
*
* @param    UnitIndex              @b((input))L7_uint32 the unit for this operation
*
* @returns  L7_SUCCESS
* @returns  L7_FAILURE
*
* @notes    ATIC's proprietary Routing Table Entry Information trap.
*
* @end
*********************************************************************/
L7_RC_t usmDbRtbEntryInfo(L7_uint32 UnitIndex)
{
  /* snmp call goes here */
  return L7_NOT_IMPLEMENTED_YET;
}
