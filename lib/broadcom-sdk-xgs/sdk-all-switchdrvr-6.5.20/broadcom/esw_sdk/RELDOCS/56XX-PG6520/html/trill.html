<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDK API Guide: trill TRILL Management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_brcm.css" rel="stylesheet" type="text/css"/>
<link href="tabs_brcm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SDK API Guide
   &#160;<span id="projectnumber">Version 6.5.20</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">trill TRILL Management </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>BCM56840 provides TRILL functionality. BCM TRILL APIs allow application developers to manage BROADCOM TRILL features.</p>
<h1><a class="anchor" id="trill_overview"></a>
TRILL Overview</h1>
<p>TRILL is a L2 tunnel technology that overcomes the problems associated with spanning tree, while retaining the beneficial aspects of Ethernet. With TRILL, all links in the network are simultaneously active. Traffic travels along the shortest path between source and destination, and can be load balanced across multiple equal cost paths. In the event of a failure, the TRILL network can stay up because the effect of any temporary loops is mitigated by the use of a HopCount in the TRILL header.</p>
<h1><a class="anchor" id="trill_data_types"></a>
TRILL Data Types</h1>
<ul>
<li>The bcm_trill_port_t structure describes a TRILL virtual port used for creating TRILL Network endpoints.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__trill__port__s.html">bcm_trill_port_s</a> {</div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__trill__port__s.html#a626deb647e7d2a546b70baf108c68785">trill_port_id</a>;  <span class="comment">/* GPORT identifier. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__trill__port__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;               <span class="comment">/* BCM_TRILL_PORT_xxx. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__trill__port__s.html#afb43724358a2930f11effd8bbb6cdf71">if_class</a>;               <span class="comment">/* Interface class ID. */</span></div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__trill__port__s.html#a56da6f3a91f2f6d38953ef7c66fa78b2">port</a>;           <span class="comment">/* Egress port. */</span></div><div class="line">    <a class="code" href="group__types.html#ga30e6e81bfad0b18e55d3a1c8148fd75d">bcm_if_t</a> <a class="code" href="structbcm__trill__port__s.html#abb332a7a074df33554ed9da8218f56b4">egress_if</a>;         <span class="comment">/* TRILL egress object. */</span></div><div class="line">    <a class="code" href="group__types.html#ga04c6eee407827c6e305098013209b1de">bcm_trill_name_t</a> <a class="code" href="structbcm__trill__port__s.html#a5bdf76c7466d6687ee951e89f03a57b7">name</a>;      <span class="comment">/* Destination RBridge Nickname. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__trill__port__s.html#a5f8594e356005c64e4a2625755b6c849">mtu</a>;                    <span class="comment">/* TRILL port MTU. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__trill__port__s.html#a02b7926a0f0054b7b6d98d7ca7aa5ab0">hopcount</a>;               <span class="comment">/* Unicast Hopcount for TRILL. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__trill__port__s.html#a82e1ae2d40e5aedd6e4d968098975bd2">multicast_hopcount</a>;     <span class="comment">/* Multicast Hopcount for TRILL. */</span></div><div class="line">    <a class="code" href="group__types.html#ga30e6e81bfad0b18e55d3a1c8148fd75d">bcm_if_t</a> <a class="code" href="structbcm__trill__port__s.html#a399a9c2e57c84182ae4d633fb9340f11">encap_id</a>;          <span class="comment">/* Encap Identifier. */</span></div><div class="line">    <a class="code" href="group__types.html#ga04c6eee407827c6e305098013209b1de">bcm_trill_name_t</a> <a class="code" href="structbcm__trill__port__s.html#a7dabc08acee301b3180edf98d1153291">virtual_name</a>; <span class="comment">/* virtual RBridge Nickname */</span></div><div class="line">    <a class="code" href="group__types.html#ga356b17d1510b1781318bb0f840405e28">bcm_switch_network_group_t</a> <a class="code" href="structbcm__trill__port__s.html#af6d0ee687a1817417e66796f5af67a99">network_group_id</a>; <span class="comment">/* Switch split horizon network group ID this TRILL port belongs to*/</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__trill__port__s.html#a54d09c2ea30d38c9258f758ed92989af">inlif_counting_profile</a>;         <span class="comment">/* In LIF counting profile */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__trill__port__s.html#af6ad039dbf5967db3b9664ea9267d81a">outlif_counting_profile</a>;        <span class="comment">/* Out LIF counting profile */</span></div><div class="line">} <a class="code" href="group__trill.html#ga78a0f787634e5b858d29df34f2b1e3e2">bcm_trill_port_t</a>;</div></div><!-- fragment --><ul>
<li>The bcm_trill_rbridge_t structure describes a TRILL rbridge port.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__trill__rbridge__s.html">bcm_trill_rbridge_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__trill__rbridge__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;           <span class="comment">/* BCM_TRILL_RBRIDGE_xxx. */</span></div><div class="line">    <a class="code" href="group__types.html#ga04c6eee407827c6e305098013209b1de">bcm_trill_name_t</a> <a class="code" href="structbcm__trill__rbridge__s.html#a5bdf76c7466d6687ee951e89f03a57b7">name</a>;  <span class="comment">/* RBridge Nickname. */</span></div><div class="line">    <a class="code" href="group__types.html#ga30e6e81bfad0b18e55d3a1c8148fd75d">bcm_if_t</a> <a class="code" href="structbcm__trill__rbridge__s.html#abb332a7a074df33554ed9da8218f56b4">egress_if</a>;     <span class="comment">/* TRILL egress object. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__trill__rbridge__s.html#a5f8594e356005c64e4a2625755b6c849">mtu</a>;                <span class="comment">/* TRILL port MTU. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__trill__rbridge__s.html#a02b7926a0f0054b7b6d98d7ca7aa5ab0">hopcount</a>;           <span class="comment">/* Hopcount for TRILL. */</span></div><div class="line">} <a class="code" href="group__trill.html#gacd887d7567639fcdd8e5c5d11082162e">bcm_trill_rbridge_t</a>;</div></div><!-- fragment --><ul>
<li>The bcm_trill_multicast_entry_t structure describes a TRILL multicast entry used for creating pruned as well as unpruned Multicast distribution tree.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__trill__multicast__entry__s.html">bcm_trill_multicast_entry_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__trill__multicast__entry__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;               <span class="comment">/* BCM_TRILL_MULTICAST_xxx. */</span></div><div class="line">    <a class="code" href="group__types.html#ga04c6eee407827c6e305098013209b1de">bcm_trill_name_t</a> <a class="code" href="structbcm__trill__multicast__entry__s.html#a47d158912aeb4993866c0c86b154ec13">root_name</a>; <span class="comment">/* Trill Root Rbridge. */</span></div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a> <a class="code" href="structbcm__trill__multicast__entry__s.html#a9115c7d3220f1d5ec358f16f935c7afd">c_vlan</a>;          <span class="comment">/* Customer Vlan */</span></div><div class="line">    <a class="code" href="group__types.html#ga4ccf23ca53e7e7e9a7be38b950aa7943">bcm_mac_t</a> <a class="code" href="structbcm__trill__multicast__entry__s.html#a75f154c29fe5cee305fd2505badce069">c_dmac</a>;           <span class="comment">/* Customer Destination MAC Address. */</span></div><div class="line">    <a class="code" href="group__types.html#ga0f3f07b8f11cb4e625b0f42d6cc7f94c">bcm_multicast_t</a> <a class="code" href="structbcm__trill__multicast__entry__s.html#ae92fd10f191e5260b750355dbc292f54">group</a>;      <span class="comment">/* TRILL Multicast Group */</span></div><div class="line">    <a class="code" href="group__types.html#ga30e6e81bfad0b18e55d3a1c8148fd75d">bcm_if_t</a> <a class="code" href="structbcm__trill__multicast__entry__s.html#af9685bfb7bc28cca716c4041bbcf10bf">encap_intf</a>;        <span class="comment">/* RPF interface for Multipath. */</span></div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a> <a class="code" href="structbcm__trill__multicast__entry__s.html#a845ebf2791ec1a4e420bd7e241e3b130">c_vlan_inner</a>;    <span class="comment">/* low-vlan, when using fine-grained trill, and customer Ethernet header is double-tagged */</span></div><div class="line">} <a class="code" href="group__trill.html#gadce923a97bce46dbc8cf6989c082a2fe">bcm_trill_multicast_entry_t</a>;</div></div><!-- fragment --><ul>
<li>The bcm_trill_multicast_adjacency_t structure describes a TRILL multicast adjacency entry used for performing trill adjacency check</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__trill__multicast__adjacency__s.html">bcm_trill_multicast_adjacency_s</a> {</div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__trill__multicast__adjacency__s.html#a56da6f3a91f2f6d38953ef7c66fa78b2">port</a>;       <span class="comment">/* Match Trill network port. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__trill__multicast__adjacency__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;           <span class="comment">/* BCM_TRILL_MULTICAST_ADJACENCY_xxx. */</span></div><div class="line">    <a class="code" href="group__types.html#ga30e6e81bfad0b18e55d3a1c8148fd75d">bcm_if_t</a> <a class="code" href="structbcm__trill__multicast__adjacency__s.html#af9685bfb7bc28cca716c4041bbcf10bf">encap_intf</a>;    <span class="comment">/* Neighbor interface. */</span></div><div class="line">} <a class="code" href="group__trill.html#ga1b850bcb7e191bd8599429582a004a0c">bcm_trill_multicast_adjacency_t</a>;</div></div><!-- fragment --><ul>
<li>bcm_trill_stat_t structure defines the TRILL Statistics type used for obtaining stats data.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="group__trill.html#ga5fef0700c338a5fa53e9e4122355b740">bcm_trill_stat_e</a> {</div><div class="line">    <a class="code" href="group__trill.html#gga5fef0700c338a5fa53e9e4122355b740a9e0dfc6178b35938b34382dcc48b8b29">bcmTrillInPkts</a>,</div><div class="line">    <a class="code" href="group__trill.html#gga5fef0700c338a5fa53e9e4122355b740a89be19da0795e0bb5ec89f7d11142df2">bcmTrillOutPkts</a>,</div><div class="line">    <a class="code" href="group__trill.html#gga5fef0700c338a5fa53e9e4122355b740a847bb593e10bd9ebacf04a465407a0d4">bcmTrillErrorPkts</a>,</div><div class="line">    <a class="code" href="group__trill.html#gga5fef0700c338a5fa53e9e4122355b740a87f503c4d6509333a06f09a2a8c7e2b3">bcmTrillNameMissPkts</a>,</div><div class="line">    <a class="code" href="group__trill.html#gga5fef0700c338a5fa53e9e4122355b740a58407ed7a04936c884cda7d43b6752d5">bcmTrillRpfFailPkts</a>,</div><div class="line">    <a class="code" href="group__trill.html#gga5fef0700c338a5fa53e9e4122355b740a2667342bbd3f0284ef1e7a920a9414b2">bcmTrillTtlFailPkts</a></div><div class="line">} <a class="code" href="group__trill.html#gafc13cbb69eef654479f16851dcacbea9">bcm_trill_stat_t</a>;</div></div><!-- fragment --><ul>
<li>bcm_vpn_t is the ID that uniquely identifies a trill vpn.</li>
<li>The bcm_trill_vpn_config_t structure describes the trill VPN attributes. It represents a mapping between customer-VSI and FGL labels.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__trill__vpn__config__s.html">bcm_trill_vpn_config_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__trill__vpn__config__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;                       <span class="comment">/* Configuration flags */</span></div><div class="line">    <a class="code" href="group__types.html#gad0476041b742ee817043d5d0c99fc2ac">bcm_vpn_t</a> <a class="code" href="structbcm__trill__vpn__config__s.html#ab4aa203386fefc77212e8a50b58d7ca5">vpn</a>;                      <span class="comment">/* VPN ID. */</span></div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a> <a class="code" href="structbcm__trill__vpn__config__s.html#a99bae383be1edbc1f9fbd70e547add4c">high_vid</a>;                <span class="comment">/* Outer vlan */</span></div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a> <a class="code" href="structbcm__trill__vpn__config__s.html#a57b5d1e815e0670d29ffe1d6fad4cfbc">low_vid</a>;                 <span class="comment">/* Inner vlan */</span></div><div class="line">    <a class="code" href="group__types.html#ga0f3f07b8f11cb4e625b0f42d6cc7f94c">bcm_multicast_t</a> <a class="code" href="structbcm__trill__vpn__config__s.html#a114da9007e9014c9b8cb11206e0e0163">broadcast_group</a>;    <span class="comment">/* Broadcast group */</span></div><div class="line">    <a class="code" href="group__types.html#ga0f3f07b8f11cb4e625b0f42d6cc7f94c">bcm_multicast_t</a> <a class="code" href="structbcm__trill__vpn__config__s.html#a23da875b7522ca342116c784be3cdcc1">unknown_unicast_group</a>; <span class="comment">/* Unknown unicast group */</span></div><div class="line">    <a class="code" href="group__types.html#ga0f3f07b8f11cb4e625b0f42d6cc7f94c">bcm_multicast_t</a> <a class="code" href="structbcm__trill__vpn__config__s.html#aea986011b6e84795ff6689a580e315ae">unknown_multicast_group</a>; <span class="comment">/* Unknown multicast group */</span></div><div class="line">} <a class="code" href="group__trill.html#gab1a0646737cc1b7ff8d9a9b50d5d1272">bcm_trill_vpn_config_t</a>;</div></div><!-- fragment --><a class="anchor" id=""></a>
<table class="doxtable">
<caption>TRILL port flags</caption>
<tr>
<th>Name </th><th>Purpose  </th></tr>
<tr>
<td>BCM_TRILL_PORT_WITH_ID </td><td>Create TRILL port with specified ID  </td></tr>
<tr>
<td>BCM_TRILL_PORT_DROP </td><td>Drop packets on TRILL port  </td></tr>
<tr>
<td>BCM_TRILL_PORT_COPYTOCPU </td><td>Copy matching TRILL packets to CPU  </td></tr>
<tr>
<td>BCM_TRILL_PORT_NETWORK </td><td>Create Unicast RBridge  </td></tr>
<tr>
<td>BCM_TRILL_PORT_UNICAST </td><td>Create Unicast Rbridge  </td></tr>
<tr>
<td>BCM_TRILL_PORT_COUNTED </td><td>Maintain packet/Byte counts  </td></tr>
<tr>
<td>BCM_TRILL_PORT_REPLACE </td><td>Replace existing TRILL entry  </td></tr>
<tr>
<td>BCM_TRILL_PORT_MULTICAST </td><td>Create Root Multicast RBridge  </td></tr>
<tr>
<td>BCM_TRILL_PORT_LOCAL </td><td>Create Local RBridge  </td></tr>
<tr>
<td>BCM_TRILL_MULTICAST_ACCESS_TO_NETWORK </td><td>Multicast from Access to Network  </td></tr>
<tr>
<td>BCM_TRILL_MULTICAST_ESADI </td><td>Use ESADI bit as a part of the MC key  </td></tr>
<tr>
<td>BCM_TRILL_MULTICAST_STATIC </td><td>Trill MC entries marked static, not aged out  </td></tr>
<tr>
<td>BCM_TRILL_PORT_VIRTUAL </td><td>Virtual/pseudo nicknames for trill multi homing support  </td></tr>
<tr>
<td>BCM_TRILL_PORT_TUNNEL </td><td>Create unicast Rbridge without transit functionality  </td></tr>
<tr>
<td>BCM_TRILL_PORT_INGRESS </td><td>Create Ingress Rbridge  </td></tr>
<tr>
<td>BCM_TRILL_PORT_EGRESS </td><td>Create Egress Rbridge  </td></tr>
<tr>
<td>BCM_TRILL_MULTICAST_TRANSPARENT_SERVICE </td><td>Create TRILL multicast transparent service  </td></tr>
<tr>
<td>BCM_TRILL_PORT_TERM_ETHERNET </td><td>Terminate Ethernet header after terminated Trill  </td></tr>
<tr>
<td>BCM_TRILL_PORT_INGRESS_WIDE </td><td>Create TRILL port eligible for additional data  </td></tr>
<tr>
<td>BCM_TRILL_MULTICAST_REPLACE_DYNAMIC </td><td>Replace an existing dynamic L2 entry with TRILL entry, when table is full  </td></tr>
</table>
<h1><a class="anchor" id="trill_apis"></a>
TRILL APIs</h1>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="footer-brcm-wrapper">
<table class="footer-brcm">
	<tbody><tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align="left"></td>
		<td class="footer-brcm"><small><b>Proprietary and Confidential &copy; 2020 Broadcom</b></small>
			<div class="footer-brcm">Broadcom Incorporated reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design.
Information furnished by Broadcom Incorporated is believed to be accurate and reliable. However, Broadcom Incorporated does not assume any liability arising
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license
under its patent rights nor the rights of others.
			</div>
		</td>
	</tr>
</tbody></table>
</div>
</body>
</html>
