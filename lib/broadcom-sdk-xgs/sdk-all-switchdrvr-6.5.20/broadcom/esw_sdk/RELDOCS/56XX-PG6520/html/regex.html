<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDK API Guide: Regex API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_brcm.css" rel="stylesheet" type="text/css"/>
<link href="tabs_brcm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SDK API Guide
   &#160;<span id="projectnumber">Version 6.5.20</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Regex API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="regex_intro"></a>
Introduction to Broadcom Regex API</h1>
<p>Broadcom regex APIs provide the ability to analyze and recognize the contents of data packets and hence the applications. The identification criteria is specified using regular expressions, along with other criteria like the protocol, L4 port, etc. (only TCP and UDP flows can be analyzed). The regex API can be used to assign actions to a matching application like dropping the packets in that flow, rate limiting the flow, etc.</p>
<p>The Regex module includes a regular expression to DFA conversion engine which maps the user-provided regular expression(s) to DFA(s).</p>
<p>All Regex API identifiers have the prefix bcm_regex_.</p>
<p>The Regex APIs fall into the following categories:</p>
<ul>
<li>Switch Configuration</li>
<li>Port level configuration</li>
<li>FP level configuration to override tracking</li>
<li>Management of signatures and corresponding actions</li>
<li>Event notification API to notify of tracking events</li>
</ul>
<h1><a class="anchor" id="regex_switch"></a>
Regex Switch Configuration</h1>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a8e40823341b3eb0c0cd04db0816beb73" title="Initialize BCM regex module.">bcm_regex_init(int unit)</a>  </td><td>Initialize the Regex module.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#af5b582b2ad13f0139d252bdc5d687fb0" title="bcm_regex_config_t_init">bcm_regex_config_t_init(bcm_regex_config_t* config)</a>  </td><td>Initialize a regex configuration structure.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#abfb1df54ed370463f8b99d9a70d19974" title="Set configuration for Regex module.">bcm_regex_config_set(int unit, bcm_regex_config_t* config)</a>  </td><td>Set or Return the Regex configuration.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#aec98dfcc4dc0251bcd02b01be6e14320" title="Get configuration for Regex module.">bcm_regex_config_get(int unit, bcm_regex_config_t* config)</a>  </td><td>Set or Return the Regex configuration.   </td></tr>
</table>
<h1><a class="anchor" id="regex_port"></a>
Regex Port Configuration</h1>
<p>This feature is enabled/disabled on ports using <a class="el" href="group__port.html#bcm_port_control_set">bcm_port_control_set</a> (bcmPortControlRegex, bcmPortControlRegexUdp, bcmPortControlRegexTcp). Enabling any of these features causes the Regex module to be enabled globally. Enabling the bcmPortControlRegexUdp feature enables inspection of UDP sessions. Enabling the bcmPortControlRegexTcp feature enables inspection of TCP sessions. Enabling the bcmPortControlRegex feature enables inspection of both types of sessions.</p>
<p>When getting the status of these features, the bcmPortControlRegex feature value is enabled if the Regex module is enabled globally. The bcmPortControlRegexUdp feature value is enabled if inspection of UDP sessions is enabled. The bcmPortControlRegexTcp feature value is enabled if inspection of TCP sessions is enabled.</p>
<h1><a class="anchor" id="regex_tracking"></a>
Regex Tracking Configuration</h1>
<p>Whether or not a flow is tracked can be controlled by a VCAP rule. See bcmFieldActionRegex, bcmFieldActionNoRegex in fp_actions</p>
<p>The regex feature also provides APIs to control which L4 ports have flows tracked.</p>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="bregex_8h.html#ad752437dd981aec93cb184a05730111d" title="Add a range of L4 ports to be excluded from flow tracking.">bcm_regex_exclude_add(int unit, uint8 protocol, uint16 l4_start, uint16 l4_end)</a>  </td><td>Exclude a range of L4 ports from packet inspection.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a2f4961ab27f09fa3bf9180481cc52bc7" title="Delete L4 ports range excluded from flow tracking.">bcm_regex_exclude_delete(int unit, uint8 protocol, uint16 l4_start, uint16 l4_end)</a>  </td><td>Delete a range of L4 ports excluded from packet inspection.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a8f186d7bd6e14b3dd10c98782f2f661d" title="Delete all L4 ports excluded from flow tracking.">bcm_regex_exclude_delete_all(int unit)</a>  </td><td>Delete all the L4 port ranges that are excluded from packet inspection.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#aca7346a50a23660b1e5cb89703a00f76" title="Delete L4 ports range excluded from flow tracking.">bcm_regex_exclude_get(int unit, int array_size, uint8* protocol, uint16* l4low, uint16* l4high, int* array_count)</a>  </td><td>Return the L4 port ranges excluded from packet inspection   </td></tr>
</table>
<h1><a class="anchor" id="regex_api"></a>
Regex match API</h1>
<p>The Regex module includes a regular expression compiler. This compiler converts the user specified regex pattern into a DFA, which in turn gets converted to a device specific hardware DFA state machine.</p>
<p>The Regex compiler supports the following features shown in <a class="el" href="regex.html#regex_features_supported">regex_features_supported</a></p>
<p><a class="anchor" id="regex_features_supported"></a></p><a class="anchor" id=""></a>
<table class="doxtable">
<caption>Regular expression features supported</caption>
<tr>
<th>Construct </th><th>Description  </th></tr>
<tr>
<td>Alternation </td><td>zero or more branches, separated by '|'. A regular expression matches if at least one of the alternative branches matches. e.g. (a|b|c) will match either pattern a or pattern b or pattern c.  </td></tr>
<tr>
<td>Concatenation </td><td>a branch consists of a sequence of zero or more pieces. To match, a branch must match all of the pieces in the sequence, in the order specified. e.g. a pattern "abc" will match 'a' followed by 'b' and followed by 'c'.  </td></tr>
<tr>
<td>Quantification (closure) </td><td>A piece consists of an atom possibly followed by one of the following characters: '*', '+' or '?' (these are referred to as repetition characters). An atom followed by '*' matches a sequence of 0 or more matches of the atom. An atom followed by '+' matches a sequence of 1 or more matches of the atom. An atom followed by '?' optionally matches the atom or the null string. An atom followed by a number enclosed in {} matches a sequence of that exact number of matches of the atom. e.g. a{2,3} will match atleast 2 'a' upto 3 'a' characters.  </td></tr>
<tr>
<td>Character class </td><td>A character class matches only a single character in the range specified within []. for example [a-c] will match if the character is a or b or c.  </td></tr>
<tr>
<td>'\d' </td><td>Any digit character [0-9]  </td></tr>
<tr>
<td>'\D' </td><td>Any non digit character [^0-9]  </td></tr>
<tr>
<td>Dot </td><td>Any character  </td></tr>
<tr>
<td>Anchor </td><td>A regular expression will be anchored at the beginning of the packet if the first character is '^'. A regular expression will be anchored at the end of the packet if the final character is '$'.  </td></tr>
</table>
<p>It is recommended to group case insensitive patterns separately from case sensitive patterns, otherwise the DFA state machine can explode. This is because when the two are mixed, if the pattern match 'abc' is case insensitive, it will be converted to '[aA][bB][cC]'. If all the patterns are case insensitive, software can enable the character remap feature which should result in fewer DFA states. The upper case characters in the packet are converted to lower case before being presented to the regex engine to search for a match so the regex would remain 'abc'.</p>
<h2><a class="anchor" id="regex_signatures"></a>
Regex Engine and Signature Management</h2>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a81037e8745d6dbace58f48c85485c884" title="bcm_regex_engine_config_t_init">bcm_regex_engine_config_t_init(bcm_regex_engine_config_t* config)</a>  </td><td>Initialize a regex engine configuration structure.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#af44bfc0959413f6822d9db2e91aa354f" title="Create regex engine.">bcm_regex_engine_create(int unit, bcm_regex_engine_config_t* config, bcm_regex_engine_t* engid)</a>  </td><td>Create a Regex matching engine.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a4488ae599340f0ebe84bbe801d71a1ef" title="destroy regex engine.">bcm_regex_engine_destroy(int unit, bcm_regex_engine_t engid)</a>  </td><td>Destroys a Regex matching engine.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a320eb6329123c53b705a0d7abd15bcdc" title="Get regex engine configuration.">bcm_regex_engine_get(int unit, bcm_regex_engine_t engid, bcm_regex_engine_config_t* config)</a>  </td><td>Retrieve the information corresponding to the Regex engine   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a2a1aba3f0393d5b59fa67a47c4c00d35" title="Traverse regex engines.">bcm_regex_engine_traverse(int unit, bcm_regex_engine_traverse_cb cb, void* user_data)</a>  </td><td>Traverse all the Regex engines for the specified unit.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a30eb65966e9b0ff80bdc60d104756336" title="Return information about the Signature Matching Engine.">bcm_regex_engine_info_get(int unit, int engine_id, bcm_regex_engine_info_t* regex_engine_info)</a>  </td><td>Return information about the Signature Matching Engine.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a84159c9efdc8305a6f5cb70afed00349" title="bcm_regex_engine_config_t_init">bcm_regex_match_t_init(bcm_regex_match_t* match)</a>  </td><td>Initialize a regex match structure.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a230e4ff2587a445953a37dfa767d89ae" title="check Regex match objects.">bcm_regex_match_check(int unit, bcm_regex_match_t* matches, int count, int* metric)</a>  </td><td>Compute the DFA size for the specified group of match objects.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a30f0a61d6461796822355193bdcec050" title="Add Regex match objects to engine.">bcm_regex_match_set(int unit, bcm_regex_engine_t engid, bcm_regex_match_t* matches, int count)</a>  </td><td>Installs the DFA for the specified group of match objects.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#ae15c8f42c47c2ccefb76057b62d05dd4" title="Return user-provided Match ID for a created signature ID.">bcm_regex_get_match_id(int unit, int signature_id, int* match_id)</a>  </td><td>Return user-provided Match ID for a created signature ID.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a02b930100f27b96ca2a576eab9a777e3" title="Return hardware Signature ID for a user provided Match ID.">bcm_regex_get_sig_id(int unit, int match_id, int* signature_id)</a>  </td><td>Return hardware Signature ID for a user provided Match ID.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a4d8c524d9532f3cc6e6b9acbe34fcc99" title="Return various info about the Flow Tracker Session and Policy tables.">bcm_regex_info_get(int unit, bcm_regex_info_t* regex_info)</a>  </td><td>Return various info about the Flow Tracker Session and Policy tables.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a940e097d71dad07fbdc7c5a8d9ef3763" title="Retrieve a specified regex Flow Tracker statistic.">bcm_regex_stat_get(int unit, bcm_regex_stat_t type, uint64* val)</a>  </td><td>Retrieve a specified regex Flow Tracker statistic.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a1d6f73d166eeb2da9e72abb50fd8590b" title="Set a specified regex Flow Tracker statistic.">bcm_regex_stat_set(int unit, bcm_regex_stat_t type, uint64 val)</a>  </td><td>Set a specified regex Flow Tracker statistic.   </td></tr>
</table>
<h2><a class="anchor" id="regex_policy"></a>
Regex Policies</h2>
<p>Actions taken as a result of a signature match are configured using policies. The policy table used by the regex module is identical to that used by the Ingress Field Processor. The APIs for configuring policies are also similar to those used by the Field Processor. Note that policy 0 is reserved. It is used when the Flow Tracker fails to create a session entry in its table.</p>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="bregex_8h.html#ab0d3d105ea499e88a06ba675984a341d" title="Create a blank regex policy.">bcm_regex_policy_create(int unit, int flags, bcm_regex_policy_t* policy)</a>  </td><td>Create a blank regex policy.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#afd7eac1f58d0fd480b05e52c925bd048" title="Destroy a regex policy. This deallocates memory only.">bcm_regex_policy_destroy(int unit, bcm_regex_policy_t policy)</a>  </td><td>Destroy a regex policy. This deallocates memory only.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a8faab068bc810de676d4dc7117965ca6" title="Destroy all regex policy entries.">bcm_regex_policy_destroy_all(int unit)</a>  </td><td>Destroy all regex policy entries.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a1d677da3e50bb2c764c197bc92a2cdf1" title="Install a regex policy into the hardware tables.">bcm_regex_policy_install(int unit, bcm_regex_policy_t policy)</a>  </td><td>Install a regex policy into the hardware tables.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a73e8bf1a7ee558bf0034be5fb2685bab" title="Remove a regex policy from the hardware tables.">bcm_regex_policy_remove(int unit, bcm_regex_policy_t policy)</a>  </td><td>Remove a regex policy from the hardware tables.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#aecf773e8059fc9130d84105d2af3c562" title="Add an action to a regex policy.">bcm_regex_policy_action_add(int unit, bcm_regex_policy_t policy, bcm_field_action_t action, uint32 param0, uint32 param1)</a>  </td><td>Add an action to a regex policy.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a66d4af05e0384c493e2cc1bfe7005204" title="Add an action to a policy.">bcm_regex_policy_action_mac_add(int unit, bcm_regex_policy_t policy, bcm_field_action_t action, bcm_mac_t mac)</a>  </td><td>Add an action to a policy.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#ad0c0faaece5b840229fdfa221c4c7750" title="Add an action to a regex policy.">bcm_regex_policy_action_ports_add(int unit, bcm_regex_policy_t policy, bcm_field_action_t action, bcm_pbmp_t pbmp)</a>  </td><td>Add an action to a regex policy.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a0f17ec2e6ed2e054c8bd3a9cff1e148d" title="Delete an action from a regex policy.">bcm_regex_policy_action_delete(int unit, bcm_regex_policy_t policy, bcm_field_action_t action, uint32 param0, uint32 param1)</a>  </td><td>Delete an action from a regex policy.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a62807338537c9fb13c40a4c06e3b74f2" title="Retrieve the parameters for an action previously added to a regex policy.">bcm_regex_policy_action_get(int unit, bcm_regex_policy_t policy, bcm_field_action_t action, uint32* param0, uint32* param1)</a>  </td><td>Retrieve the parameters for an action previously added to a regex policy.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a28880832bae944ed0cf167eba2ff463a" title="Retrieve the parameters for an action previously added to a regex policy.">bcm_regex_policy_action_mac_get(int unit, bcm_regex_policy_t policy, bcm_field_action_t action, bcm_mac_t* mac)</a>  </td><td>Retrieve the parameters for an action previously added to a regex policy.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a1ba17e8a5385009a4ef2fbe746004d79" title="Retrieve the parameters for an action previously added to a regex policy.">bcm_regex_policy_action_ports_get(int unit, bcm_regex_policy_t policy, bcm_field_action_t action, bcm_pbmp_t* pbmp)</a>  </td><td>Retrieve the parameters for an action previously added to a regex policy.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a0f7885c8a7d57f8e45bbcb88d88a2e15" title="Remove an action from a regex_policy. Same as bcm_regex_policy_action_delete for actions without para...">bcm_regex_policy_action_remove(int unit, bcm_regex_policy_t policy, bcm_field_action_t action)</a>  </td><td>Remove an action from a regex_policy. Same as bcm_regex_policy_action_delete for actions without parameters.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a20902db155108ff8a7e588caf12802e3" title="Remove all actions from a regex_policy.">bcm_regex_policy_action_remove_all(int unit, bcm_regex_policy_t policy)</a>  </td><td>Remove all actions from a regex_policy.   </td></tr>
</table>
<h2><a class="anchor" id="regex_policers"></a>
Regex Policy Policers</h2>
<p>The regex engine policies may have policers (meters) attached for tracking ingress bandwidth. Since each policy may be applied to multiple flows, the tracking granularity is on a per-policy basis. Only one meter pool is allocated for use by the regex engine. As a result, hierarchical meters are not supported so only level 0 may be used.</p>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a2c8dbb674844c232eb5cbe26efeb5c32" title="Attach a policer to a regex policy.">bcm_regex_policy_policer_attach(int unit, bcm_regex_policy_t policy, int level, bcm_policer_t policer_id)</a>  </td><td>Attach a policer to a regex policy.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a5594d0164a8a8a1ed4a3650db7c6b626" title="Detach a policer from a regex policy.">bcm_regex_policy_policer_detach(int unit, bcm_regex_policy_t policy, int level)</a>  </td><td>Detach a policer from a regex policy.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#adb67bfb90626e61ca862fe2bf3ef50a2" title="Detach all policers from a regex policy.">bcm_regex_policy_policer_detach_all(int unit, bcm_regex_policy_t policy)</a>  </td><td>Detach all policers from a regex policy.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a3a1c9da248c371a98dcae796e9e6cda8" title="Get the policer(s) attached to a regex policy.">bcm_regex_policy_policer_get(int unit, bcm_regex_policy_t policy, int level, bcm_policer_t* policer_id)</a>  </td><td>Get the policer(s) attached to a regex policy.   </td></tr>
</table>
<h1><a class="anchor" id="regex_sessions"></a>
Regex Session Management</h1>
<p>The Regex engine provides for management of the session table.</p>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a272e53e02c29b551513c04211c0f013d" title="Initialize regex session key structure.">bcm_regex_session_key_t_init(bcm_regex_session_key_t* session_key)</a>  </td><td>Initialize regex session key structure.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a87a2f36b1451b604bcb08d0b6cf92a41" title="Initialize regex session structure.">bcm_regex_session_t_init(bcm_regex_session_t* session)</a>  </td><td>Initialize regex session structure.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a4ad63d1222dc6258dbee243703fac8e5" title="Adds or updates a session entry. Flags param for future use, values 0x1-0x8 reserved.">bcm_regex_session_add(int unit, int flags, bcm_regex_session_key_t* key, bcm_regex_session_t* session)</a>  </td><td>Adds or updates a session entry. Flags param for future use, values 0x1-0x8 are reserved.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a6d7a0cf1264afbfcbd6749db1c64f6c9" title="Updates the policy ID in a session entry.">bcm_regex_session_policy_update(int unit, int flags, int flow_index, bcm_regex_policy_t policy)</a>  </td><td>Updates the policy ID in a session entry.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a55c21a5ddf998e7f01ce9955a26c5f65" title="Deletes an entry from the regex session table.">bcm_regex_session_delete(int unit, bcm_regex_session_key_t* key)</a>  </td><td>Deletes an entry from the regex session table.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a512114ff8f0e6ec6e2ff2b104f32b785" title="Deletes all the entries from the regex session table.">bcm_regex_session_delete_all(int unit)</a>  </td><td>Deletes all the entries from the regex session table.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#adb84f779d7482e9255d5a2f4586b46f6" title="Returns the session data (if any). Flags param for future use.">bcm_regex_session_get(int unit, int flags, bcm_regex_session_key_t* key, bcm_regex_session_t* session)</a>  </td><td>Returns the session data (if any). Flags param for future use.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a9b65608a7b1081f831689bf61457076c" title="Traverse regex sessions.">bcm_regex_session_traverse(int unit, int flags, bcm_regex_session_traverse_cb cb, void* user_data)</a>  </td><td>Traverse regex sessions.   </td></tr>
</table>
<h1><a class="anchor" id="regex_event"></a>
Regex event processing</h1>
<p>The Regex engine can generate events which are sent to registered users. These events provide information on what flows are being tracked, if there is a match and the corresponding match identifier so that application can relate it back to particular application. The following table summarizes the various events for which the application can register.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>Regex events</caption>
<tr>
<th>report_flag Value </th><th>Description  </th></tr>
<tr>
<td>BCM_REGEX_REPORT_NEW </td><td>Notify when a new flow is tracked, this event is triggered whenever a session entry is created.  </td></tr>
<tr>
<td>BCM_REGEX_REPORT_MATCHED </td><td>Notify if the flow matches any of the match patterns installed. The notification provides information on the source and destination IP address, L4 port and the match identifier.  </td></tr>
<tr>
<td>BCM_REGEX_REPORT_END </td><td>Notify when the session is no longer being tracked, either due to session termination or session expiry.  </td></tr>
<tr>
<td>BCM_REGEX_REPORT_ALL </td><td>Notify all events, including when a session does not have a match.  </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="bregex_8h.html#aeac7e9a33a51e62853c2d597957f0131" title="bcm_regex_engine_config_t_init">bcm_regex_report_t_init(bcm_regex_report_t* match)</a>  </td><td>Initialize a regex report structure.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a2260be01e8043a9fb196af697d1bf736" title="register user provided callback for regex report.">bcm_regex_report_register(int unit, uint32 reports, bcm_regex_report_cb callback, void* user_data)</a>  </td><td>Register user-provided callback function for Regex event notification.   </td></tr>
<tr>
<td><a class="el" href="bregex_8h.html#a3d52478e271ab3d1eb6f2725edbfebe1" title="Unregister user provided callback for regex report.">bcm_regex_report_unregister(int unit, uint32 reports, bcm_regex_report_cb callback, void* user_data)</a>  </td><td>Unregister user-provided application callback function for Regex event notification.   </td></tr>
</table>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="footer-brcm-wrapper">
<table class="footer-brcm">
	<tbody><tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align="left"></td>
		<td class="footer-brcm"><small><b>Proprietary and Confidential &copy; 2020 Broadcom</b></small>
			<div class="footer-brcm">Broadcom Incorporated reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design.
Information furnished by Broadcom Incorporated is believed to be accurate and reliable. However, Broadcom Incorporated does not assume any liability arising
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license
under its patent rights nor the rights of others.
			</div>
		</td>
	</tr>
</tbody></table>
</div>
</body>
</html>
