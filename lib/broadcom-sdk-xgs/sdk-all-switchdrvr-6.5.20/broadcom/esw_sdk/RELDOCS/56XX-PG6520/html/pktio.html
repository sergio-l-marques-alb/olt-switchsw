<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDK API Guide: Packet I/O</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_brcm.css" rel="stylesheet" type="text/css"/>
<link href="tabs_brcm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SDK API Guide
   &#160;<span id="projectnumber">Version 6.5.20</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Packet I/O </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Packet I/O is a set of libraries and network device drivers that provide data paths for fast packet exchange between the host CPU and the switch device via a PCIe link.</p>
<ul>
<li>bcm_pktio_pmd_t contains the packet metadata information.</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#define BCM_PKTIO_PMD_SIZE_WORDS    48         </span><span class="comment">/* Packet metadata size. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="comment">/* Packet metadata information. */</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__pktio__pmd__s.html">bcm_pktio_pmd_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> *<a class="code" href="structbcm__pktio__pmd__s.html#ac1cb95040e3f97818d0500a0f6110994">rxpmd</a>;                      <span class="comment">/* RX Packet metadata handle. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> *<a class="code" href="structbcm__pktio__pmd__s.html#a75c273c8df91498520e7f0dd2a7ff82f">txpmd</a>;                      <span class="comment">/* TX Packet metadata handle. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> *<a class="code" href="structbcm__pktio__pmd__s.html#a0c7fb8cd5574c6aae10c1013059551bd">higig</a>;                      <span class="comment">/* HiGig handle. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> *<a class="code" href="structbcm__pktio__pmd__s.html#aa3cc5a90b652c593f41ee521758a4f49">lbhdr</a>;                      <span class="comment">/* Loopback Header handle. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__pmd__s.html#abc897af1dd9c0cac6718cd651ee4e90d">data</a>[BCM_PKTIO_PMD_SIZE_WORDS]; <span class="comment">/* Headers&#39; data. */</span></div><div class="line">} <a class="code" href="group__pktio.html#gaa9f1079c1f14e88410d6ccb27ef0f6be">bcm_pktio_pmd_t</a>;</div></div><!-- fragment --><ul>
<li>bcm_pktio_pkt_t contains the packet information.</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">/* Packet structure. */</span></div><div class="line"><span class="keyword">struct </span><a class="code" href="structbcm__pktio__pkt__s.html">bcm_pktio_pkt_s</a> {-</div><div class="line">    <a class="code" href="structbcm__pktio__pkt__s.html">bcm_pktio_pkt_t</a> *<a class="code" href="structbcm__pktio__pkt__s.html#af4d608b780298010017b8cf5e67c4547">next</a>;  <span class="comment">/* Point to next packet in the list. */</span></div><div class="line">    <a class="code" href="structbcm__pktio__pkt__s.html">bcm_pktio_pkt_t</a> *<a class="code" href="structbcm__pktio__pkt__s.html#a5380f0d17ee7e991eef843ecd133c2f0">prev</a>;  <span class="comment">/* Point to previous packet in the list. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__pkt__s.html#affc6a42f59d0f323874565f3b52fc10f">unit</a>;               <span class="comment">/* Switch unit number. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__pkt__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;           <span class="comment">/* Internal used only. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__pkt__s.html#af356674bbaaf9bb782af79059eef1346">type</a>;            <span class="comment">/* Packet forwarding type. */</span></div><div class="line">    <a class="code" href="structbcm__pktio__pmd__s.html">bcm_pktio_pmd_t</a> <a class="code" href="structbcm__pktio__pkt__s.html#ab7ac9b350ffb5adfb49bbf6b18983d4c">pmd</a>;    <span class="comment">/* Packet metadata information. */</span></div><div class="line">    <span class="keywordtype">void</span> *<a class="code" href="structbcm__pktio__pkt__s.html#aeee196444a52f6cac4222cde1bd31031">data_buf</a>;         <span class="comment">/* Packet data buffer information. */</span></div><div class="line">};</div></div><!-- fragment --><ul>
<li>BCM_PKTIO_BUF_F_TX With this flag, TX internal operation header space will be created in the front of data_buf.</li>
</ul>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__pktio.html#gabac4aed33ea5ef4ffd0277804f2eb683" title="Allocate a packet structure and packet data.">bcm_pktio_alloc(int unit, uint32 max_size, uint32 flags, bcm_pktio_pkt_t** packet)</a>  </td><td>Allocate a packet structure and packet data.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga01216c73cd0532461e1116a571519d8d" title="Release packet data buffer and destroy packet object.">bcm_pktio_free(int unit, bcm_pktio_pkt_t* packet)</a>  </td><td>Release packet data buffer and destroy packet object.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga06a530fc308333ceb6f2b0fcf02ebffa" title="Claim the packet.">bcm_pktio_claim(int unit, bcm_pktio_pkt_t* pkt, bcm_pktio_pkt_t** new_pkt)</a>  </td><td>Claim the packet.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga2e1aba9339c8f97643c4dafb793e208c" title="Retrieve packet data handle and length.">bcm_pktio_pkt_data_get(int unit, bcm_pktio_pkt_t* packet, void** data, uint32* length)</a>  </td><td>Retrieve packet data handle and length.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga766a825fbf7bb9be301b096603340478" title="Reserve buffer size in headroom.">bcm_pktio_reserve(int unit, bcm_pktio_pkt_t* packet, uint32 len, void** data)</a>  </td><td>Reserve buffer size in headroom.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga8706d81cf1ecefd052bb698def745d95" title="Add extra size in the front of a packet data.">bcm_pktio_push(int unit, bcm_pktio_pkt_t* packet, uint32 len, void** data)</a>  </td><td>Add extra size in the front of a packet data.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga3aa0e4990fbfc7e2635dc6989d8ed4ac" title="Add bytes in the end of a packet data.">bcm_pktio_put(int unit, bcm_pktio_pkt_t* packet, uint32 len, void** data)</a>  </td><td>Add bytes in the end of a packet data.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga5ba5a6aa7d38ab1089182ec551a59348" title="Remove bytes from the start of packet data.">bcm_pktio_pull(int unit, bcm_pktio_pkt_t* packet, uint32 len, void** data)</a>  </td><td>Remove bytes from the start of packet data.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga3cf243adf793867396af59da773ba4ef" title="Remove end from packet buffer.">bcm_pktio_trim(int unit, bcm_pktio_pkt_t* packet, uint32 len)</a>  </td><td>Remove end from packet buffer.   </td></tr>
</table>
<ul>
<li>bcm_pktio_bitmap_t is the structure to hold packet metadata field ID bitmap or packet reason bitmap.</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#define BCM_PKTIO_BITMAP_WORD_SIZE  8          </span><span class="comment">/* Bitmap array size. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__pktio__bitmap__s.html">bcm_pktio_bitmap_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__bitmap__s.html#ae1baf42b3deb8dd75147df9a31a5de98">pbits</a>[BCM_PKTIO_BITMAP_WORD_SIZE];</div><div class="line">} <a class="code" href="group__pktio.html#ga0319869880e59bc4cccf02fd5b841a24">bcm_pktio_bitmap_t</a>;</div></div><!-- fragment --><ul>
<li>bcm_pktio_fid_support_t contains the different packet metadata field ID supported bit arrays.</li>
</ul>
<p>txpmd is refer to BCMPKT_TXPMD_XXX rxpmd is refer to BCMPKT_RXPMD_XXX gih is refer to BCMPKT_GIH_XXX rxflex is refer to BCMPKT_RXPMD_FLEX_XXX higig3 is refer to BCMPKT_HIGIG3_XXX</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define BCM_PKTIO_FID_INVALID   -1         </span><span class="comment">/* Invalid field id. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FID_COUNT     BCM_PKTIO_BITMAP_WORD_SIZE * 32 </span><span class="comment">/* Field id number. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__pktio__fid__support__s.html">bcm_pktio_fid_support_s</a> {</div><div class="line">    <a class="code" href="structbcm__pktio__bitmap__s.html">bcm_pktio_bitmap_t</a> <a class="code" href="structbcm__pktio__fid__support__s.html#aca4ab6049aecd4021bea0efd8d2490dd">txpmd_support</a>; <span class="comment">/* TXPMD field ID supported bit array. */</span></div><div class="line">    <a class="code" href="structbcm__pktio__bitmap__s.html">bcm_pktio_bitmap_t</a> <a class="code" href="structbcm__pktio__fid__support__s.html#a8ffe967be5578c32a804b176fc525c0d">rxpmd_support</a>; <span class="comment">/* RXPMD field ID supported bit array. */</span></div><div class="line">    <a class="code" href="structbcm__pktio__bitmap__s.html">bcm_pktio_bitmap_t</a> <a class="code" href="structbcm__pktio__fid__support__s.html#af4979e5b719339d156399fc7e1559d49">gih_support</a>; <span class="comment">/* GIH field ID supported bit array. */</span></div><div class="line">    <a class="code" href="structbcm__pktio__bitmap__s.html">bcm_pktio_bitmap_t</a> <a class="code" href="structbcm__pktio__fid__support__s.html#a0df406fbe3afa4e1ea0793682a29b462">rxflex_support</a>; <span class="comment">/* FLEXPMD field ID supported bit array. */</span></div><div class="line">    <a class="code" href="structbcm__pktio__bitmap__s.html">bcm_pktio_bitmap_t</a> <a class="code" href="structbcm__pktio__fid__support__s.html#abfbeba777bfc55162c79277168d456a1">higig3_support</a>; <span class="comment">/* HiGig3 field ID supported bit array. */</span></div><div class="line">} <a class="code" href="group__pktio.html#ga2840e2118d18dd96da88bdd1ffe9d38b">bcm_pktio_fid_support_t</a>;</div></div><!-- fragment --> <table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga6a679dfbce8ec68e21aa8c8c3a4a4d62" title="Get the pmd support bitmap of different pmd types.">bcm_pktio_pmd_fid_support_get(int unit, bcm_pktio_fid_support_t* support)</a>  </td><td>Get the pmd support bitmap of different pmd types.   </td></tr>
</table>
<div class="fragment"><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Macro to get a field ID&#39;s supported status.</span></div><div class="line"><span class="comment">  </span></div><div class="line"><span class="comment"> * Returns:</span></div><div class="line"><span class="comment"> *   zero     =&gt; Not supported</span></div><div class="line"><span class="comment"> *   non-zero =&gt; Supported</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FID_SUPPORT_GET(_support, _fid)  \</span></div><div class="line"><span class="preprocessor">    SHR_BITGET(((_support).pbits), (_fid))</span></div><div class="line"></div><div class="line"><span class="comment">/* Macro to iterate over all supported field IDs in the _support. */</span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FID_SUPPORT_ITER(_support, _fid)  \</span></div><div class="line"><span class="preprocessor">    for ((_fid) = BCM_PKTIO_FID_INVALID + 1; \</span></div><div class="line"><span class="preprocessor">         (_fid) &lt; BCM_PKTIO_FID_COUNT; \</span></div><div class="line"><span class="preprocessor">         (_fid)++) \</span></div><div class="line"><span class="preprocessor">        if (BCM_PKTIO_FID_SUPPORT_GET(_support, _fid))</span></div></div><!-- fragment --><p><a class="anchor" id="Packet_Metadata_Types_x"></a></p><a class="anchor" id=""></a>
<table class="doxtable">
<caption>Packet Metadata Types</caption>
<tr>
<th>Name </th><th>Purpose  </th></tr>
<tr>
<td>bcmPktioPmdTypeTx = 0 </td><td>TX Metadata Type  </td></tr>
<tr>
<td>bcmPktioPmdTypeRx = 1 </td><td>RX Metadata Type  </td></tr>
<tr>
<td>bcmPktioPmdTypeGih = 2 </td><td>Generic Internal Header  </td></tr>
<tr>
<td>bcmPktioPmdTypeRxFlex = 3 </td><td>RX Flex Metadata  </td></tr>
<tr>
<td>bcmPktioPmdTypeHigig3 = 4 </td><td>HiGig3 Metadata  </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga05fb49449bc3d24f28faa42292c80cb6" title="Set value into a specific PMD field.">bcm_pktio_pmd_field_set(int unit, bcm_pktio_pkt_t* packet, bcm_pktio_pmd_type_t type, int fid, uint32 val)</a>  </td><td>Set value into a specific PMD field.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#gad11166dd854433dc8bed7bf501f53146" title="Get value from a specific PMD field.">bcm_pktio_pmd_field_get(int unit, bcm_pktio_pkt_t* packet, bcm_pktio_pmd_type_t type, int fid, uint32* val)</a>  </td><td>Get value from a specific PMD field.   </td></tr>
</table>
<ul>
<li>bcm_pktio_reasons_t contains the packet reasons bitmap.</li>
</ul>
<p>rx_reasons is refer to BCMPKT_RX_REASON_XXX flex_reasons is refer to BCMPKT_RXPMD_FLEX_REASON_XXX</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define BCM_PKTIO_REASON_NONE   0          </span><span class="comment">/* No reason. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_REASON_COUNTS BCM_PKTIO_BITMAP_WORD_SIZE * 32 </span><span class="comment">/* Reason id number. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__pktio__reasons__s.html">bcm_pktio_reasons_s</a> {</div><div class="line">    <a class="code" href="structbcm__pktio__bitmap__s.html">bcm_pktio_bitmap_t</a> <a class="code" href="structbcm__pktio__reasons__s.html#a5859ec595aed00d2effd600a8c3b3e28">rx_reasons</a>;     <span class="comment">/* Packet rx reasons bitmap. */</span></div><div class="line">    <a class="code" href="structbcm__pktio__bitmap__s.html">bcm_pktio_bitmap_t</a> <a class="code" href="structbcm__pktio__reasons__s.html#ac310b75c84fb2793bb41c4ad66c5c94f">flex_reasons</a>; <span class="comment">/* Packet flex reasons bitmap. */</span></div><div class="line">} <a class="code" href="group__pktio.html#ga351a1b2b6f6416cc36c11ae7be86137f">bcm_pktio_reasons_t</a>;</div></div><!-- fragment --> <table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__pktio.html#gaa5d1e76cfab8870450d00ec3de664a8c" title="Get RX reasons from RXPMD and RXFLEXPMD.">bcm_pktio_pmd_reasons_get(int unit, bcm_pktio_pkt_t* packet, bcm_pktio_reasons_t* reasons)</a>  </td><td>Get RX reasons from RXPMD and RXFLEXPMD.   </td></tr>
</table>
<div class="fragment"><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Macro to check if a reason is included in a set of reasons.</span></div><div class="line"><span class="comment">  </span></div><div class="line"><span class="comment"> * Returns:</span></div><div class="line"><span class="comment"> *   zero     =&gt; reason is not included in the set</span></div><div class="line"><span class="comment"> *   non-zero =&gt; reason is included in the set</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_REASON_GET(_reasons, _reason)  \</span></div><div class="line"><span class="preprocessor">    SHR_BITGET(((_reasons).pbits), (_reason))</span></div><div class="line"></div><div class="line"><span class="comment">/* Macro to add a reason to a set of reasons. */</span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_REASON_SET(_reasons, _reason)  \</span></div><div class="line"><span class="preprocessor">    SHR_BITSET(((_reasons).pbits), (_reason))</span></div><div class="line"></div><div class="line"><span class="comment">/* Macro to add all reasons to a set of reasons. */</span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_REASON_SET_ALL(_reasons)  \</span></div><div class="line"><span class="preprocessor">    SHR_BITSET_RANGE(((_reasons).pbits), 0, BCM_PKTIO_REASON_COUNTS)</span></div><div class="line"></div><div class="line"><span class="comment">/* Macro to clear a reason from a set of reasons. */</span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_REASON_CLEAR(_reasons, _reason)  \</span></div><div class="line"><span class="preprocessor">    SHR_BITCLR(((_reasons).pbits), (_reason))</span></div><div class="line"></div><div class="line"><span class="comment">/* Macro to clear a set of reasons. */</span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_REASON_CLEAR_ALL(_reasons)  \</span></div><div class="line"><span class="preprocessor">    SHR_BITCLR_RANGE(((_reasons).pbits), 0, BCM_PKTIO_REASON_COUNTS)</span></div><div class="line"></div><div class="line"><span class="comment">/* Macro to check if a set of reasons is empty. */</span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_REASON_IS_NULL(_reasons)  \</span></div><div class="line"><span class="preprocessor">    SHR_BITNULL_RANGE(((_reasons).pbits), 0, BCM_PKTIO_REASON_COUNTS)</span></div><div class="line"></div><div class="line"><span class="comment">/* Macro to itterate over a set of reasons. */</span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_REASON_ITER(_reasons, _reason)  \</span></div><div class="line"><span class="preprocessor">    for((_reason) = BCM_PKTIO_REASON_NONE; \</span></div><div class="line"><span class="preprocessor">        (_reason) &lt; BCM_PKTIO_REASON_COUNTS; \</span></div><div class="line"><span class="preprocessor">        (_reason)++) \</span></div><div class="line"><span class="preprocessor">        if(BCM_PKTIO_REASON_GET(_reasons, _reason))</span></div><div class="line"></div><div class="line"><span class="comment">/* Macro to count number of active reasons in a set of reasons. */</span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_REASON_COUNT(_reasons, _count)  \</span></div><div class="line"><span class="preprocessor">    SHR_BITCOUNT_RANGE(((_reasons).pbits), _count, 0, BCM_PKTIO_REASON_COUNTS)</span></div><div class="line"></div><div class="line"><span class="comment">/* Macro to compare two sets of reasons. */</span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_REASON_EQ(_reasons1, _reasons2)  \</span></div><div class="line"><span class="preprocessor">    SHR_BITEQ_RANGE(((_reasons1).pbits), ((_reasons2).pbits), \</span></div><div class="line"><span class="preprocessor">                    0, BCM_PKTIO_REASON_COUNTS)</span></div></div><!-- fragment --><ul>
<li>BCM_PKTIO_TX_MC_QUEUE Indicates packet goes to MC queue.</li>
<li>bcm_pktio_txpmd_t contains some wellknown TX metadata.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__pktio__txpmd__s.html">bcm_pktio_txpmd_s</a> {</div><div class="line">    <a class="code" href="group__types.html#gad7e36a8d90f5765e8ca58770666c0860">bcm_port_t</a> <a class="code" href="structbcm__pktio__txpmd__s.html#a2e033702c7efd62d5dc82d91e8d698b9">tx_port</a>; <span class="comment">/* TX port. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__pktio__txpmd__s.html#aeb68756dcb1f6a81201acc63eacadc47">prio_int</a>;   <span class="comment">/* Internal priority of the packet. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__pktio__txpmd__s.html#af73b51eb8d2111f3d20acc8d7cd8dbe3">cos</a>;        <span class="comment">/* The local COS queue to use. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__txpmd__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;     <span class="comment">/* BCM_PKTIO_TX_xxx flags. */</span></div><div class="line">} <a class="code" href="group__pktio.html#gaa9f1079c1f14e88410d6ccb27ef0f6be">bcm_pktio_pmd_t</a>;</div></div><!-- fragment --><table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga7e5fc7a8c0e03077010d418f01964afc" title="Transmit one packet.">bcm_pktio_pmd_set(int unit, bcm_pktio_pkt_t* packet, bcm_pktio_txpmd_t* txpmd)</a>  </td><td>Transmit one packet.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#gae0659c7091a5af28395f1464eedb9486" title="Transmit one packet.">bcm_pktio_tx(int unit, bcm_pktio_pkt_t* packet)</a>  </td><td>Transmit one packet.   </td></tr>
</table>
<ul>
<li>BCM_PKTIO_RX_NOT_HANDLED indicates packet not processed. Dispatcher will deliver it to the next callback.</li>
<li>BCM_PKTIO_RX_HANDLED indicates packet handled. Dispatcher will skip next callback.</li>
<li>bcm_pktio_rx_cb_f is the callback function type for packet RX.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="group__pktio.html#ga9055333c407db1ff13112b3bbd7b6616">bcm_pktio_rx_t</a> (*<a class="code" href="group__pktio.html#ga2276c18df3b5100ee9721f33bfdffc7e">bcm_pktio_rx_cb_f</a>)(</div><div class="line">    <span class="keywordtype">int</span> unit,</div><div class="line">    <a class="code" href="structbcm__pktio__pkt__s.html">bcm_pktio_pkt_t</a> *packet,</div><div class="line">    <span class="keywordtype">void</span> *cookie);</div></div><!-- fragment --><table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td>bcm_pktio_rx_register(int unit, constchar* name, bcm_pktio_rx_cb_f callback, uint8 priority, void* cookie, uint32 flags)  </td><td>Register receive callbacks for received packets.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga5838a1f03c460b7041f282f2dd41f27a" title="Unregister receive callbacks for received packets.">bcm_pktio_rx_unregister(int unit, bcm_pktio_rx_cb_f callback, uint8 priority)</a>  </td><td>Unregister receive callbacks for received packets.   </td></tr>
</table>
<ul>
<li>bcm_pktio_netif_t contains a network interface configuration.</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#define BCM_PKTIO_NETIF_NAME_MAX    16         </span><span class="comment">/* Maximum chars are allowed in</span></div><div class="line"><span class="comment">                                                  network interface name. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_NETIF_MAX_IDS     64         </span><span class="comment">/* Maximum Network interface ID</span></div><div class="line"><span class="comment">                                                  number. Valid ID is from 1 to</span></div><div class="line"><span class="comment">                                                  63. 0 is reserved. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_NETIF_F_RCPU_ENCAP    (1 &lt;&lt; 0)   </span><span class="comment">/* RCPU header encapsulation</span></div><div class="line"><span class="comment">                                                      is used for delivering packet</span></div><div class="line"><span class="comment">                                                      metadata to/from</span></div><div class="line"><span class="comment">                                                      applications.</span></div><div class="line"><span class="comment">                                                      Applications should</span></div><div class="line"><span class="comment">                                                      encapsulate RCPU header</span></div><div class="line"><span class="comment">                                                      when transmitting packets to the</span></div><div class="line"><span class="comment">                                                      netif,</span></div><div class="line"><span class="comment">                                                      and may parser RCPU header</span></div><div class="line"><span class="comment">                                                      when receiving packets from</span></div><div class="line"><span class="comment">                                                      the netif. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_NETIF_F_BIND_RX_CH    (1 &lt;&lt; 1)   </span><span class="comment">/* Bind this netif with a RX</span></div><div class="line"><span class="comment">                                                      DMA channel. All packets</span></div><div class="line"><span class="comment">                                                      from</span></div><div class="line"><span class="comment">                                                      the DMA channel will be</span></div><div class="line"><span class="comment">                                                      forwarded to this netif. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_NETIF_F_BIND_TX_PORT  (1 &lt;&lt; 2)   </span><span class="comment">/* Bind this network</span></div><div class="line"><span class="comment">                                                      interface to a front-panel</span></div><div class="line"><span class="comment">                                                      switch port for</span></div><div class="line"><span class="comment">                                                      transmission.  All packets</span></div><div class="line"><span class="comment">                                                      from this network</span></div><div class="line"><span class="comment">                                                      interface will be</span></div><div class="line"><span class="comment">                                                      forwarded to the bound</span></div><div class="line"><span class="comment">                                                      switch port. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_NETIF_F_ADD_TAG       (1 &lt;&lt; 3)   </span><span class="comment">/* Add VLAN tag for packets</span></div><div class="line"><span class="comment">                                                      transmitted via this</span></div><div class="line"><span class="comment">                                                      network interface. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="comment">/* Packet network interface structure. */</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__pktio__netif__s.html">bcm_pktio_netif_s</a> {</div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__netif__s.html#a7441ef0865bcb3db9b8064dd7375c1ea">id</a>;                             <span class="comment">/* Network interface ID. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__netif__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;                       <span class="comment">/* Creation flag. Refer to</span></div><div class="line"><span class="comment">                                           BCM_PKTIO_NETIF_F_XXX flags. */</span></div><div class="line">    <a class="code" href="group__types.html#ga4ccf23ca53e7e7e9a7be38b950aa7943">bcm_mac_t</a> <a class="code" href="structbcm__pktio__netif__s.html#a06405859ff7fe2f5bc4eef7ad0a226e3">mac_addr</a>;                 <span class="comment">/* MAC address associated with this</span></div><div class="line"><span class="comment">                                           network interface. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__pktio__netif__s.html#acedfb903fedf54fbcdd82fa28e9e4c7a">vlan</a>;                        <span class="comment">/* Default VLAN ID associated with this</span></div><div class="line"><span class="comment">                                           network interface. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__netif__s.html#a1ce53999f0a069c5ce2e2716f19178ba">port</a>;                           <span class="comment">/* Bind with a network interface for</span></div><div class="line"><span class="comment">                                           transmit destination port. */</span></div><div class="line">    <span class="keywordtype">char</span> <a class="code" href="structbcm__pktio__netif__s.html#a57f9cbf24fd25ec19e541998d7bbf5a5">port_encap</a>[10];                <span class="comment">/* port_encap works with port to tell</span></div><div class="line"><span class="comment">                                           the encapsulation type of the port. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__netif__s.html#a62857856838ccfa92470340e73a4d1d8">port_queue</a>;                     <span class="comment">/* port_queue works with port to tell</span></div><div class="line"><span class="comment">                                           egress queue number. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__netif__s.html#a87ecc64f4bed7a33ee8bca55cd7bea2f">dma_chan_id</a>;                    <span class="comment">/* Bind a Rx DMA channel with this</span></div><div class="line"><span class="comment">                                           netif. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__netif__s.html#ad0f2c926195109332da30d31d6cafbd9">max_frame_size</a>;              <span class="comment">/* Max packet size is for this netif.</span></div><div class="line"><span class="comment">                                           Any packet which size is bigger than</span></div><div class="line"><span class="comment">                                           this setting will be dropped. */</span></div><div class="line">    <span class="keywordtype">char</span> <a class="code" href="structbcm__pktio__netif__s.html#a961d09acbf7547b3c6fe818d0d5b3ad8">name</a>[BCM_PKTIO_NETIF_NAME_MAX]; <span class="comment">/* Network interface name. */</span></div><div class="line">} <a class="code" href="group__pktio.html#gaefa47f214f43c0f104ff5cd2f2de8706">bcm_pktio_netif_t</a>;</div></div><!-- fragment --><table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga56003acdfbc0babc27a585dcf475e9d2" title="Create a kernel network interface.">bcm_pktio_netif_create(int unit, bcm_pktio_netif_t* netif)</a>  </td><td>Create a kernel network interface.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#gaea78c279e3019af598022b7545bf874a" title="Get a kernel network interface configuration.">bcm_pktio_netif_get(int unit, int netif_id, bcm_pktio_netif_t* netif)</a>  </td><td>Get a kernel network interface configuration.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#gac87df6bb1e3dd1bd375c3fb18b8f1eb3" title="Destroy a kernel network interface.">bcm_pktio_netif_destroy(int unit, int netif_id)</a>  </td><td>Destroy a kernel network interface.   </td></tr>
</table>
<ul>
<li>bcm_pktio_netif_traverse_cb_f Network interface traverse callback function type.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> int (*<a class="code" href="group__pktio.html#ga07b5bbdbff419361525cdeaab00980f1">bcm_pktio_netif_traverse_cb_f</a>) (<span class="keywordtype">int</span> unit,</div><div class="line">                                              <span class="keyword">const</span> <a class="code" href="structbcm__pktio__netif__s.html">bcm_pktio_netif_t</a> *netif,</div><div class="line">                                              <span class="keywordtype">void</span> *cb_data);</div></div><!-- fragment --> <table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga13269a5d2dbab54842aeef48c56a57ee" title="Traverse kernel network interface objects.">bcm_pktio_netif_traverse(int unit, bcm_pktio_netif_traverse_cb_f cb_func, void* cb_data)</a>  </td><td>Traverse kernel network interface objects   </td></tr>
</table>
<ul>
<li>bcm_pktio_filter_t contains the netif fileter configuration.</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_T_RX_PKT   1          </span><span class="comment">/* Packet filter for RX</span></div><div class="line"><span class="comment">                                                  direction. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_F_STRIP_TAG    0x00000001 </span><span class="comment">/* Strip VLAN tag from</span></div><div class="line"><span class="comment">                                                      packets sent to virtual</span></div><div class="line"><span class="comment">                                                      network interfaces. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_DEST_T_NULL       0          </span><span class="comment">/* Null destination (drop</span></div><div class="line"><span class="comment">                                                  packet). */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_DEST_T_NETIF      1          </span><span class="comment">/* Send packet to virtual network</span></div><div class="line"><span class="comment">                                                  interface. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_DEST_T_BCM_RX_API 2          </span><span class="comment">/* Send packet to BCM Rx API. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_DEST_T_CALLBACK   3          </span><span class="comment">/* Send packet to kernel</span></div><div class="line"><span class="comment">                                                  call-back function. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_M_RAW          0x00000001 </span><span class="comment">/* Match raw packet data. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_M_VLAN         0x00000002 </span><span class="comment">/* Match VLAN ID. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_M_INGPORT      0x00000004 </span><span class="comment">/* Match local ingress port. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_M_SRC_MODPORT  0x00000008 </span><span class="comment">/* Match source module port. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_M_SRC_MODID    0x00000010 </span><span class="comment">/* Match source module ID. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_M_REASON       0x00000020 </span><span class="comment">/* Match copy-to-CPU reason</span></div><div class="line"><span class="comment">                                                      code */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_M_FP_RULE      0x00000040 </span><span class="comment">/* Match filter processor</span></div><div class="line"><span class="comment">                                                      rule number. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_M_ERROR        0x00000080 </span><span class="comment">/* Match error bit. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_M_CPU_QUEUE    0x00000100 </span><span class="comment">/* Match CPU queue (rx</span></div><div class="line"><span class="comment">                                                      queue). */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_DESC_MAX   32         </span><span class="comment">/* Filter description maximum</span></div><div class="line"><span class="comment">                                                  size. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_FILTER_SIZE_MAX   256        </span><span class="comment">/* Packet raw data maximum size. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="comment">/* Packet filter structure. */</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__pktio__filter__s.html">bcm_pktio_filter_s</a> {</div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__filter__s.html#a7441ef0865bcb3db9b8064dd7375c1ea">id</a>;                             <span class="comment">/* Filter ID. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__filter__s.html#af356674bbaaf9bb782af79059eef1346">type</a>;                        <span class="comment">/* Filter type. Refer to</span></div><div class="line"><span class="comment">                                           BCM_PKTIO_FILTER_T_XXX. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__filter__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;                       <span class="comment">/* Filter flags. Refer to</span></div><div class="line"><span class="comment">                                           BCM_PKTIO_FILTER_F_XXX. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__filter__s.html#a457469539f7f23121fea412f04fb7cde">priority</a>;                    <span class="comment">/* Filter priority (0 is highest). */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__filter__s.html#a0a605b6e465f6e259a2208d6c5c130eb">dest_type</a>;                   <span class="comment">/* Destination type. Refer to</span></div><div class="line"><span class="comment">                                           BCM_PKTIO_DEST_T_XXX. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__filter__s.html#a236e6c78fc3a72aaef4db0cc99e656ab">dest_id</a>;                        <span class="comment">/* Filter destination ID. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__pktio__filter__s.html#af824fcfeb019dde614c6faead36f7899">dest_proto</a>;                  <span class="comment">/* If non-zero this value overrides the</span></div><div class="line"><span class="comment">                                           default protocol type when matching</span></div><div class="line"><span class="comment">                                           packet is passed to network stack. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__filter__s.html#a2f70faf0227021b61e076883ec33afc7">mirror_type</a>;                 <span class="comment">/* Destination type. Refer to</span></div><div class="line"><span class="comment">                                           BCM_PKTIO_DEST_T_XXX. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__filter__s.html#a1159fc9b61f614f7955073fb90d9c6f6">mirror_id</a>;                      <span class="comment">/* Mirror destination ID. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__pktio__filter__s.html#a5de2e917e01ffaffc43a2477d52ad25f">mirror_proto</a>;                <span class="comment">/* If non-zero this value overrides the</span></div><div class="line"><span class="comment">                                           default protocol type when matching</span></div><div class="line"><span class="comment">                                           packet is passed to network stack. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__filter__s.html#a456684b326733e9d7a283b12f7316770">dma_chan</a>;                       <span class="comment">/* Source RX DMA channel to match. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__filter__s.html#a034ff3d64b4327b9b99690cb8ee17548">match_flags</a>;                 <span class="comment">/* Refert to BCM_PKTIO_FILTER_M_XXX. */</span></div><div class="line">    <span class="keywordtype">char</span> <a class="code" href="structbcm__pktio__filter__s.html#ac9c8d5e3e75b35bf5ebddc596e971016">desc</a>[BCM_PKTIO_FILTER_DESC_MAX]; <span class="comment">/* Filter description (optional). */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__pktio__filter__s.html#ac2dd024954ea78d5e3ce00fcb02a107f">m_vlan</a>;                      <span class="comment">/* VLAN ID to match. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__filter__s.html#a0cb5253bf8442eaedf0bfae61a731bef">m_ingport</a>;                      <span class="comment">/* Local ingress port to match. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__filter__s.html#a033acc7b36b62c8a478526782c0e93fb">m_src_modport</a>;                  <span class="comment">/* Source module port to match. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__filter__s.html#aa307c45d0c59fb17f0425967b1ca0b7c">m_src_modid</a>;                    <span class="comment">/* Source module ID to match. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__filter__s.html#a3e92c03d279dbd5cd62c08020c0e74bf">m_cpu_queue</a>;                    <span class="comment">/* Source CPU port queue to match. */</span></div><div class="line">    <a class="code" href="structbcm__pktio__bitmap__s.html">bcm_pktio_bitmap_t</a> <a class="code" href="structbcm__pktio__filter__s.html#a3c1bfd48e7031b579ff8be216cee2efa">m_reason</a>;        <span class="comment">/* Copy-to-CPU reason to match. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__filter__s.html#adb5e05614cc13d3d9d737ae6e5782060">m_fp_rule</a>;                   <span class="comment">/* Filter processor rule to match. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__filter__s.html#af7228eef0f8892fa8535c243f08b151c">raw_size</a>;                    <span class="comment">/* Size of valid raw data and mask. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__pktio__filter__s.html#a62d242249c3f6bcb25a2142e90a332e5">m_raw_data</a>[BCM_PKTIO_FILTER_SIZE_MAX]; <span class="comment">/* Raw data to match. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__pktio__filter__s.html#a466f17a47604fb6eb35939661a0234d6">m_raw_mask</a>[BCM_PKTIO_FILTER_SIZE_MAX]; <span class="comment">/* Raw data mask to match. */</span></div><div class="line">} <a class="code" href="group__pktio.html#ga7edeeccad7e70e832d8d11bb0ab32f3e">bcm_pktio_filter_t</a>;</div></div><!-- fragment --><table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga8fa5d8d1aeba5d7a1714509b2ed1ad16" title="Create a kernel packet filter.">bcm_pktio_filter_create(int unit, bcm_pktio_filter_t* filter)</a>  </td><td>Create a kernel packet filter.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga196cb2d066b68eba53363b3a3f9d09d8" title="Get a kernel packet filter configuration.">bcm_pktio_filter_get(int unit, int filter_id, bcm_pktio_filter_t* filter)</a>  </td><td>Get a kernel packet filter configuration.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga8dcb29a239f881dd73dd0ddfa37c9dcd" title="Destroy a kernel packet filter.">bcm_pktio_filter_destroy(int unit, int filter_id)</a>  </td><td>Destroy a kernel packet filter.   </td></tr>
</table>
<ul>
<li>bcm_pktio_filter_traverse_cb_f Network filter traverse callback function type.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> int (*<a class="code" href="group__pktio.html#gafddfdf76b43dea54b43d8d711e4c2d3b">bcm_pktio_filter_traverse_cb_f</a>) (<span class="keywordtype">int</span> unit,</div><div class="line">                                               <span class="keyword">const</span> <a class="code" href="structbcm__pktio__filter__s.html">bcm_pktio_filter_t</a> *filter,</div><div class="line">                                               <span class="keywordtype">void</span> *cb_data);</div></div><!-- fragment --> <table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__pktio.html#gac945be4340f81d27db0d7df86f2e9817" title="Traverse kernel packet filter objects.">bcm_pktio_filter_traverse(int unit, bcm_pktio_filter_traverse_cb_f cb_func, void* cb_data)</a>  </td><td>Traverse kernel packet filter objects   </td></tr>
</table>
<ul>
<li>bcm_pktio_trace_pkt_t contains trace information used to construct trace packet.</li>
</ul>
<div class="fragment"><div class="line"><span class="preprocessor">#define BCM_PKTIO_TRACE_LEARN   0x1        </span><span class="comment">/* Learning enable on trace</span></div><div class="line"><span class="comment">                                                  packet. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_TRACE_NO_IFP  0x2        </span><span class="comment">/* Disable ingress field</span></div><div class="line"><span class="comment">                                                  processor lookup on trace</span></div><div class="line"><span class="comment">                                                  packet. */</span><span class="preprocessor"></span></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_TRACE_FORWARD 0x4        </span><span class="comment">/* Forward internal trace packet</span></div><div class="line"><span class="comment">                                                  to egress. */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><span class="comment">/* Trace information used to construct trace packet. */</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__pktio__trace__pkt__s.html">bcm_pktio_trace_pkt_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__trace__pkt__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;   <span class="comment">/* Trace flags refer to BCM_PKTIO_TRACE_OPT_XXX. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__pktio__trace__pkt__s.html#a1ce53999f0a069c5ce2e2716f19178ba">port</a>;     <span class="comment">/* Local front panel port that acts as a masquerade port. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__pktio__trace__pkt__s.html#afed088663f8704004425cdae2120b9b3">len</a>;        <span class="comment">/* Trace packet length. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> *<a class="code" href="structbcm__pktio__trace__pkt__s.html#a8f25d15058ff4218d08627a7c829a6c4">pkt</a>;     <span class="comment">/* Trace packet data. */</span></div><div class="line">} <a class="code" href="group__pktio.html#gaafb338c2f42215f97fb0f29e10d54528">bcm_pktio_trace_pkt_t</a>;</div></div><!-- fragment --><ul>
<li>bcm_pktio_trace_data_t contains the raw trace data.</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">/* Raw trace data. */</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__pktio__trace__data__s.html">bcm_pktio_trace_data_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__pktio__trace__data__s.html#a63941c3a03dc9736f3234bb756d9a305">len</a>;         <span class="comment">/* Amount of available trace data (may exceed buf_size). */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> *<a class="code" href="structbcm__pktio__trace__data__s.html#acd323cb8cc31a58c3c6416f660e89a24">buf</a>;         <span class="comment">/* Trace data buffer. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> buf_size;    <span class="comment">/* Size of trace data buffer. */</span></div><div class="line">} <a class="code" href="group__pktio.html#gacc3ddaa7b31f37270cc1b4a3933d14c9">bcm_pktio_trace_data_t</a>;</div></div><!-- fragment --><table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td>bcm_pktio_trace_data_len_get(int unit, uint32* len)  </td><td>Get trace data`s size   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga3e0d78396e502a8ef5389de3d241a353" title="Send out a trace packet and get trace raw data.">bcm_pktio_trace_data_collect(int unit, bcm_pktio_trace_pkt_t* trace_pkt, bcm_pktio_trace_data_t* trace_data)</a>  </td><td>Send out a trace packet and get trace raw data.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga7188a0981a6fbfc0bc931b6764d4864e" title="Get value of an trace info field.">bcm_pktio_trace_field_get(int unit, bcm_pktio_trace_data_t* trace_data, int fid, uint32* val)</a>  </td><td>Get value of an trace info field.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#ga67518b19827bda5c55d335f88f45f6b4" title="Get drop reason of trace info. Setting all bits 1 in trace_data can get supported drop reason bitmap.">bcm_pktio_trace_drop_reasons_get(int unit, bcm_pktio_trace_data_t* trace_data, bcm_pktio_bitmap_t* bitmap)</a>  </td><td>Get drop reason of trace info.   </td></tr>
<tr>
<td><a class="el" href="group__pktio.html#gaad2917dcf0d8d10d7475e4846a2f55d6" title="Get counter of trace info. Setting all bits 1 in trace_data can get supported trace counter bitmap.">bcm_pktio_trace_counter_get(int unit, bcm_pktio_trace_data_t* trace_data, bcm_pktio_bitmap_t* bitmap)</a>  </td><td>Get counter of trace info.   </td></tr>
</table>
<div class="fragment"><div class="line"><span class="preprocessor">#define BCM_PKTIO_TRACE_BITMAP_GET(_bitmap, _bit)  \</span></div><div class="line"><span class="preprocessor">    SHR_BITGET(((_bitmap).pbits), (_bit))</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_TRACE_BITMAP_SET(_bitmap, _bit)  \</span></div><div class="line"><span class="preprocessor">    SHR_BITSET(((_bitmap).pbits), (_bit))</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define BCM_PKTIO_TRACE_BITMAP_CLEAR_ALL(_bitmap)  \</span></div><div class="line"><span class="preprocessor">    SHR_BITCLR_RANGE(((_bitmap).pbits), 0, BCM_PKTIO_BITMAP_WORD_SIZE * 32)</span></div></div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="footer-brcm-wrapper">
<table class="footer-brcm">
	<tbody><tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align="left"></td>
		<td class="footer-brcm"><small><b>Proprietary and Confidential &copy; 2020 Broadcom</b></small>
			<div class="footer-brcm">Broadcom Incorporated reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design.
Information furnished by Broadcom Incorporated is believed to be accurate and reliable. However, Broadcom Incorporated does not assume any liability arising
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license
under its patent rights nor the rights of others.
			</div>
		</td>
	</tr>
</tbody></table>
</div>
</body>
</html>
