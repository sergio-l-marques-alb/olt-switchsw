<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDK API Guide: Network Interface Virtualization Management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_brcm.css" rel="stylesheet" type="text/css"/>
<link href="tabs_brcm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SDK API Guide
   &#160;<span id="projectnumber">Version 6.5.20</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Network Interface Virtualization Management </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>BCM56840 provides Network Interface Virtualization (NIV) functionality. The BCM NIV APIs allow application developers to manage the Broadcom NIV features.</p>
<h1><a class="anchor" id="niv_overview"></a>
NIV Overview</h1>
<p>In today's data center, there are multiple layers of L2 switches between virtual machines and top-of-the-rack switches, introduced by hypervisors, converged network adapters, and blade switches. These intermediate switches complicate network management as the server is no longer directly connected to a port on the top-of-the-rack switch. Network Interface Virtualization (NIV) addresses this situation by defining two new network elements, Interface Virtualizers (IV) and Virtual Interface Switch (VIS). The intermediate switches serve as the IV, which forwards frames between virtual machines and the VIS. The top-of-the-rack switch serves as the VIS, the central point for making forwarding decisions and enforcing policy.</p>
<h1><a class="anchor" id="niv_data_types"></a>
NIV Data Types</h1>
<ul>
<li>The bcm_niv_port_t structure describes a NIV virtual port used in VIS.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__niv__port__s.html">bcm_niv_port_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__niv__port__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;                   <span class="comment">/* BCM_NIV_PORT_xxx */</span></div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__niv__port__s.html#a9d9cde7f588c0d9ed5bdacc7646fd619">niv_port_id</a>;        <span class="comment">/* BCM_GPORT_NIV_PORT type object */</span></div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__niv__port__s.html#a56da6f3a91f2f6d38953ef7c66fa78b2">port</a>;               <span class="comment">/* Physical port / trunk */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__niv__port__s.html#a485b054f359cefdfadd41ab27d29a8b8">virtual_interface_id</a>;    <span class="comment">/* Virtual interface identifier */</span></div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a> <a class="code" href="structbcm__niv__port__s.html#ad22679e36d7259c4d88d606c80d6d4c5">match_vlan</a>;          <span class="comment">/* Optional outer VLAN ID to match. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__niv__port__s.html#a671d9302c8b4c4318e5d9cdf56929c26">match_service_tpid</a>;      <span class="comment">/* Ingress SD-tag TPID. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__niv__port__s.html#a93ec8bd3b1e35ff73e12191664f035d8">if_class</a>;                <span class="comment">/* Interface class ID. */</span></div><div class="line">} <a class="code" href="group__niv.html#ga52c987a4baaf97b07f0a1687c56efbcd">bcm_niv_port_t</a>;</div></div><!-- fragment --><a class="anchor" id=""></a>
<table class="doxtable">
<caption>NIV port flags</caption>
<tr>
<th>Name </th><th>Purpose  </th></tr>
<tr>
<td>BCM_NIV_PORT_WITH_ID </td><td>Create NIV port with specified ID  </td></tr>
<tr>
<td>BCM_NIV_PORT_REPLACE </td><td>Replace existing NIV entry  </td></tr>
<tr>
<td>BCM_NIV_PORT_MULTICAST </td><td>Create a multicast NIV port  </td></tr>
<tr>
<td>BCM_NIV_PORT_MATCH_NONE </td><td>Create a NIV port without match criteria (i.e. port, virtual_interface_id, match_vlan)   </td></tr>
<tr>
<td>BCM_NIV_VNTAG_L_BIT_FORCE_1 </td><td>Allow frames head back  </td></tr>
<tr>
<td>BCM_NIV_PORT_MATCH_DO_NOT_ADD </td><td>Do not add match criteria when creating a NIV port, but other resource can be created as normal.   </td></tr>
</table>
<ul>
<li>The bcm_niv_egress_t structure describes a NIV egress object used in VIS.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__niv__egress__s.html">bcm_niv_egress_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__niv__egress__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;                   <span class="comment">/* BCM_NIV_EGRESS_xxx */</span></div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__niv__egress__s.html#a56da6f3a91f2f6d38953ef7c66fa78b2">port</a>;               <span class="comment">/* Physical port / trunk */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__niv__egress__s.html#a485b054f359cefdfadd41ab27d29a8b8">virtual_interface_id</a>;    <span class="comment">/* Virtual Interface Identifier */</span></div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a> <a class="code" href="structbcm__niv__egress__s.html#ad22679e36d7259c4d88d606c80d6d4c5">match_vlan</a>;          <span class="comment">/* Optional outer VLAN ID to match */</span></div><div class="line">    <a class="code" href="group__types.html#ga30e6e81bfad0b18e55d3a1c8148fd75d">bcm_if_t</a> <a class="code" href="structbcm__niv__egress__s.html#abb332a7a074df33554ed9da8218f56b4">egress_if</a>;             <span class="comment">/* Egress object ID */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__niv__egress__s.html#a425591b9d5d30bd9c4485b300bb9a878">service_tpid</a>;            <span class="comment">/* Egress SD-tag TPID */</span></div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a> <a class="code" href="structbcm__niv__egress__s.html#af4d21103f1cc887973b1720f900a9c9c">service_vlan</a>;        <span class="comment">/* Egress SD-tag VLAN ID */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__niv__egress__s.html#a88f0deb2d75bc930ac605eed08c0e555">service_pri</a>;              <span class="comment">/* Egress SD-tag default Priority */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__niv__egress__s.html#a855619b51a8750a02c9259816650251f">service_cfi</a>;              <span class="comment">/* Egress SD-tag default CFI */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__niv__egress__s.html#aff9f12d6eece300f1791e8769e387a9e">service_qos_map_id</a>;         <span class="comment">/* Egress SD-tag Priority and CFI mapping</span></div><div class="line"><span class="comment">                                       profile ID */</span></div><div class="line">    <a class="code" href="group__types.html#ga30e6e81bfad0b18e55d3a1c8148fd75d">bcm_if_t</a> <a class="code" href="structbcm__niv__egress__s.html#a56ead26537d07bc392e17b49dcdb686e">intf</a>;                  <span class="comment">/* L3 interface */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__niv__egress__s.html#a498cf3d321134f2850f08f10cf7645d5">multicast_flags</a>;         <span class="comment">/* BCM_L3_MULTICAST flag definitions */</span></div><div class="line">} <a class="code" href="group__niv.html#gab64b18f30977eed57e809c7bca0af93f">bcm_niv_egress_t</a>;</div></div><!-- fragment --><a class="anchor" id=""></a>
<table class="doxtable">
<caption>NIV egress object flags</caption>
<tr>
<th>Name </th><th>Purpose  </th></tr>
<tr>
<td>BCM_NIV_EGRESS_MULTICAST </td><td>Create a multicast NIV egress object  </td></tr>
<tr>
<td>BCM_NIV_EGRESS_SERVICE_VLAN_ADD </td><td>Add SD-tag  </td></tr>
<tr>
<td>BCM_NIV_EGRESS_SERVICE_VLAN_DELETE </td><td>Delete SD-tag  </td></tr>
<tr>
<td>BCM_NIV_EGRESS_SERVICE_VLAN_REPLACE </td><td>Replace SD-tag VLAN ID  </td></tr>
<tr>
<td>BCM_NIV_EGRESS_SERVICE_PRI_REPLACE </td><td>Replace SD-tag Priority  </td></tr>
<tr>
<td>BCM_NIV_EGRESS_SERVICE_TPID_REPLACE </td><td>Replace SD-tag TPID  </td></tr>
<tr>
<td>BCM_NIV_EGRESS_L3 </td><td>Create L3 egress object  </td></tr>
<tr>
<td>BCM_NIV_EGRESS_P_BIT_CLEAR </td><td>Clear the P bit for multicast packets  </td></tr>
</table>
<ul>
<li>The bcm_niv_forward_t structure describes a forwarding entry used in IV.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__niv__forward__s.html">bcm_niv_forward_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__niv__forward__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;                   <span class="comment">/* BCM_NIV_FORWARD_xxx */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__niv__forward__s.html#a093d1a09da076b98e8177cc50296d76e">name_space</a>;              <span class="comment">/* NIV name space */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__niv__forward__s.html#a485b054f359cefdfadd41ab27d29a8b8">virtual_interface_id</a>;    <span class="comment">/* Virtual interface identifier */</span></div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__niv__forward__s.html#a255c6c44ccef1eafd1b32dea322f6f88">dest_port</a>;          <span class="comment">/* Destination Gport */</span></div><div class="line">    <a class="code" href="group__types.html#ga0f3f07b8f11cb4e625b0f42d6cc7f94c">bcm_multicast_t</a> <a class="code" href="structbcm__niv__forward__s.html#a28114750f41b09ce6534c8e77a6c7865">dest_multicast</a>; <span class="comment">/* Destination multicast group */</span></div><div class="line">} <a class="code" href="group__niv.html#ga70b82f254da495c5a2845d4d2e5d2cb5">bcm_niv_forward_t</a>;</div></div><!-- fragment --><a class="anchor" id=""></a>
<table class="doxtable">
<caption>NIV IV flags</caption>
<tr>
<th>Name </th><th>Purpose  </th></tr>
<tr>
<td>BCM_NIV_FORWARD_MULTICAST </td><td>Destination is a multicast group  </td></tr>
</table>
<h1><a class="anchor" id="niv_generic_apis"></a>
Generic NIV APIs</h1>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="footer-brcm-wrapper">
<table class="footer-brcm">
	<tbody><tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align="left"></td>
		<td class="footer-brcm"><small><b>Proprietary and Confidential &copy; 2020 Broadcom</b></small>
			<div class="footer-brcm">Broadcom Incorporated reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design.
Information furnished by Broadcom Incorporated is believed to be accurate and reliable. However, Broadcom Incorporated does not assume any liability arising
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license
under its patent rights nor the rights of others.
			</div>
		</td>
	</tr>
</tbody></table>
</div>
</body>
</html>
