<?xml version="1.0" encoding="UTF-8"?>
<top>
    <parsing-objects>
        <!-- ~~~~~~~~~ Dynamicly parsed ETH header ~~~~~~~~~ -->
        <!-- This object has no structure, one of ETH0/1/2 will be used -->
        <object name="ETH" size="176" plugin="eth_parser" structure="Invalid">
            <description>Ethernet Header for packet parsing (Use ETH0/1/2/3 for packet compose)</description>
        </object>
        <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
        <object name="ETH0" size="112">
            <description>Untagged Ethernet Header</description>
            <next-header field="ETH0.Type" options="ETH_Next_Protocol"/>
        </object>
        <object name="ETH1" size="144">
            <description>Ethernet Header with a single VLAN</description>
            <next-header field="ETH1.Type" options="ETH_Next_Protocol"/>
        </object>
        <object name="ETH2" size="176">
            <description>Ethernet Header with 2 VLANs (use Inner_VLAN/Outer_VLAN for packet compose)</description>
            <next-header field="ETH2.Type" options="ETH_Next_Protocol"/>
        </object>
        <object name="ETH3" size="208">
            <description>Ethernet Header with 3 VLANs (use Inner_VLAN/Middle_VLAN/Outer_VLAN for packet compose)</description>
            <next-header field="ETH3.Type" options="ETH_Next_Protocol"/>
        </object>
        <object name="ARP" size="224">
            <description>ARP Header</description>
        </object>
        <object name="MPLS" size="32">
            <description>MPLS/PWE header</description>
            <extension name="MPLS">
                <condition type="field" mode="enable">
                    <enable val="0" />
                    <field path="MPLS.BOS" />
                </condition>
            </extension>
            <extension name="MPLS_Next_Proto">
                <condition type="field" mode="enable">
                    <enable val="1" />
                    <field path="MPLS.BOS" />
                </condition>
            </extension>
        </object>
        <object name="MPLS_Next_Proto" size="320" plugin="2nd_parser" structure="Invalid"/>
        <object name="GACH" size="32">
            <description>G-ACH Control word</description>
            <next-header field="GACH.Channel" options="GACH_Next_Protocol"/>
        </object>
        <object name="Control_Word" size="32">
            <description>PWE Control word</description>
            <extension name="ETH"/>
        </object>
        <object name="BIER" size="320">
            <description>Bier(MPLS) header</description>
            <next-header field="BIER.Proto" options="BIER_Next_Protocol"/>
        </object>
        <object name="IPv4" size="160">
            <description>IPv4 Header</description>
            <next-header field="IPv4.Protocol" options="IP_Next_Protocol"/>
        </object>
        <object name="IPv6" size="320">
           <next-header field="IPv6.Next_Header" options="IP_Next_Protocol"/>
            <description>IPv6 Header</description>
        </object>
        <object name="TCP" size="160" structure="TCP">
            <description>TCP Header</description>
        </object>
        <object name="UDP" size="64" structure="UDP">
            <description>UDP Header</description>
            <next-header field="UDP.Dst_Port" options="UDP_Applications"/>
        </object>
        <object name="GRE" size="32" structure="GRE">
            <description>GRE header</description>
            <next-header field="GRE.Protocol" options="ETH_Next_Protocol"/>
        </object>
        <object name="SRv6" size="1472" plugin="srv6_parser" structure="Invalid">
            <description>SRv6 Header</description>
           <next-header field="SRv6.Next_Header" options="IP_Next_Protocol"/>
        </object>
        <object name="BFD" size="192" structure="BFD">
            <description>BFD PDU</description>
        </object>
        <object name="VXLAN" size="64" structure="VXLAN">
            <description>VXLAN Header</description>
            <extension name="ETH"/>
        </object>
        <object name="VXLAN_GPE" size="64" structure="VXLAN_GPE">
            <description>VXLAN Header</description>
            <extension name="ETH">
                <condition type="field" mode="enable">
                    <enable val="0" />
                    <field path="VXLAN_GPE.GPE_Flags.P"/>
                </condition>
            </extension>
            <extension name="IPv4">
                <condition type="field" mode="enable">
                    <enable val="1" />
                    <field path="VXLAN_GPE.GPE_Flags.P"/>
                </condition>
                <condition type="field" mode="enable">
                    <enable val="0x1" />
                    <field path="VXLAN_GPE.GPE_Next_Protocol"/>
                </condition>
            </extension>
            <extension name="IPv6">
                <condition type="field" mode="enable">
                    <enable val="1" />
                    <field path="VXLAN_GPE.GPE_Flags.P"/>
                </condition>
                <condition type="field" mode="enable">
                    <enable val="0x2" />
                    <field path="VXLAN_GPE.GPE_Next_Protocol"/>
                </condition>
            </extension>
            <extension name="ETH">
                <condition type="field" mode="enable">
                    <enable val="1" />
                    <field path="VXLAN_GPE.GPE_Flags.P"/>
                </condition>
                <condition type="field" mode="enable">
                    <enable val="0x3" />
                    <field path="VXLAN_GPE.GPE_Next_Protocol"/>
                </condition>
            </extension>
            <extension name="MPLS">
                <condition type="field" mode="enable">
                    <enable val="1" />
                    <field path="VXLAN_GPE.GPE_Flags.P"/>
                </condition>
                <condition type="field" mode="enable">
                    <enable val="0x5" />
                    <field path="VXLAN_GPE.GPE_Next_Protocol"/>
                </condition>
            </extension>
        </object>
        <object name="ETH_OAM" size="600" structure="ETH_OAM">
            <description>Y.1731 over ETH PDU</description>
        </object>
    </parsing-objects>
    <next-headers>
        <next-header-options name="ETH_Next_Protocol">
            <option object="ARP"      val="0x0806"/>
            <option object="MPLS"     val="0x8847"/>
            <option object="MPLS"     val="0x8848"/>
            <option object="IPv4"     val="0x0800"/>
            <option object="IPv6"     val="0x86dd"/>
            <option object="ETH_OAM"  val="0x8902"/>
        </next-header-options>
        <next-header-options name="IP_Next_Protocol">
            <option object="UDP"      val="0x11"/>
            <option object="GRE"      val="0x2f"/>
            <option object="TCP"      val="0x06"/>
            <option object="IPv4"     val="0x04"/>
            <option object="IPv6"     val="0x29"/>
            <option object="SRv6"     val="0x2B"/>
        </next-header-options>
        <next-header-options name="UDP_Applications">
            <option object="BFD"       val="3784"/>
            <option object="MPLS"      val="6635"/>
            <option object="VXLAN"     val="4789"/>
            <option object="VXLAN"     val="0x5555"/>
            <option object="VXLAN_GPE" val="4790"/>
        </next-header-options>
        <next-header-options name="BIER_Next_Protocol">
            <option object="MPLS" val="1"/>
            <option object="MPLS" val="2"/>
            <option object="ETH"  val="3"/>
            <option object="IPv4" val="4"/>
            <option object="OAM"  val="5"/>
            <option object="IPv6" val="6"/>
        </next-header-options>
        <next-header-options name="GACH_Next_Protocol">
            <option object="ETH_OAM" val="0x8902"/>
            <option object="BFD"     val="0x0007"/>
        </next-header-options>
    </next-headers>
</top>
