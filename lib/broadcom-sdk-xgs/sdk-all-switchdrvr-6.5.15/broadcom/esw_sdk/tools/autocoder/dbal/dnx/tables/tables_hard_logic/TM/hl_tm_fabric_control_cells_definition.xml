<?xml version="1.0" encoding="UTF-8"?>

<!--
    ******************************************************
    DBAL Hard-Logic Logical Tables:
    This xml contains the hard-logic logical DB for the DBAL.
    The data is loaded to the device during init process
    ******************************************************

    DB Rules:
    *********
-->

<AppDbCatalog xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../hard_logic_schema.xsd">

    <AppDB Name="FABRIC_CONTROL_CELLS_REACHABILITY">
        <OneLineDescription>Configure reachability</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
            </Key>
            <Result>
                <Field Name="RATE" Type="UINT" Size="11" Description="Generation rate of a single reachability message"/>
                <Field Name="GLOBAL_RATE" Type="UINT" Size="13" Description="Generation rate of all reachability messages"/>
                <Field Name="WATCHDOG_THRESHOLD" Type="UINT" Size="6" Description="Maximum time between 2 reachability messages on the same link before link is faulty"/>
                <Field Name="LINK_STATUS_MASK_ENABLE" Type="BOOL" Description="Enable link status masking"/>
                <Field Name="IN_MSG_UPDATE_ENABLE" Type="BOOL" Description="Enable updating the reachability table by incoming reachability messages"/>
            </Result>
            <TableLabels>FABRIC</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                <Field Name="RATE">
                    <Access>
                        <Register Name="RTP_RTP_ENABLEr">
                            <HwField Name="RMGRf"/>
                        </Register>
                    </Access>
                </Field>
                <Field Name="GLOBAL_RATE">
                    <Access>
                        <Register Name="RTP_RTP_ENABLEr">
                            <HwField Name="RMGR_GLOBALf"/>
                        </Register>
                    </Access>
                </Field>
                <Field Name="WATCHDOG_THRESHOLD">
                    <Access>
                        <Register Name="RTP_RTP_ENABLEr">
                            <HwField Name="RTPWPf"/>
                        </Register>
                    </Access>
                </Field>
                <Field Name="LINK_STATUS_MASK_ENABLE">
                    <Access>
                        <Register Name="RTP_RTP_ENABLEr">
                            <HwField Name="RTP_EN_MSKf"/>
                        </Register>
                    </Access>
                </Field>
                <Field Name="IN_MSG_UPDATE_ENABLE">
                    <Access>
                        <Register Name="RTP_RTP_ENABLEr">
                            <HwField Name="RTP_UP_ENf"/>
                        </Register>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>

    <AppDB Name="FABRIC_CONTROL_CELLS_TX_DISCARD">
        <OneLineDescription>Discard outgoing control cells</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
            </Key>
            <Result>
                <Field Name="IS_FLOW_STATUS_DISCARD" Type="BOOL" Description="Discard flow status control cells"/>
                <Field Name="IS_CREDIT_DISCARD" Type="BOOL" Description="Discard credit control cells"/>
                <Field Name="IS_REACHABILITY_DISCARD" Type="BOOL" Description="Discard reachability control cells"/>
                <Field Name="IS_ALL_PACKETS_DISCARD" Type="BOOL" Description="Discard all packets"/>
            </Result>
            <TableLabels>FABRIC</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                <Field Name="IS_FLOW_STATUS_DISCARD">
                    <Access>
                        <Register Name="FCT_FCT_ENABLER_REGISTERr">
                            <HwField Name="DIS_STSf"/>
                        </Register>
                    </Access>
                </Field>
                <Field Name="IS_CREDIT_DISCARD">
                    <Access>
                        <Register Name="FCT_FCT_ENABLER_REGISTERr">
                            <HwField Name="DIS_CRDf"/>
                        </Register>
                    </Access>
                </Field>
                <Field Name="IS_REACHABILITY_DISCARD">
                    <Access>
                        <Register Name="FCT_FCT_ENABLER_REGISTERr">
                            <HwField Name="DIS_RCHf"/>
                        </Register>
                    </Access>
                </Field>
                <Field Name="IS_ALL_PACKETS_DISCARD">
                    <Access>
                        <Register Name="FDT_FDT_ENABLER_REGISTERr">
                            <HwField Name="DISCARD_ALL_PKTSf"/>
                        </Register>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>

    <AppDB Name="FABRIC_CONTROL_CELLS_RX_DISCARD">
        <OneLineDescription>Discard incoming control cells</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
            </Key>
            <Result>
                <Field Name="IS_TRAP_ALL" Type="BOOL" Description="Trap all incoming control cells to the CPU"/>
            </Result>
            <TableLabels>FABRIC</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                <Field Name="IS_TRAP_ALL">
                    <Access>
                        <Register Name="FCR_FCR_ENABLERS_AND_FILTER_MATCH_INPUT_LINKr">
                            <HwField Name="TRAP_ALL_CNTf"/>
                        </Register>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>

    <AppDB Name="FABRIC_CONTROL_CELLS_LINK_ACTIVE">
        <OneLineDescription>Indicates if link is up (available to transmit cells)</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
            </Key>
            <Result>
                <Field Name="IS_LINK_ACTIVE" Type="BOOL" Size="1" NofInstances="DNX_DATA.fabric.links.nof_links" Permission="READONLY" Description="Is link available to transmit cells"/>
            </Result>
            <TableLabels>FABRIC</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                <Field Name="IS_LINK_ACTIVE">
                    <Access instanceIndex="ALL" EncodeType="BITWISE_NOT">
                        <Register Name="RTP_LINK_ACTIVE_MASKr">
                            <HwField Name="LNK_ACTV_MSKf"/>
                            <DataOffset Formula="INSTANCE"/>
                        </Register>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>

    <AppDB Name="FABRIC_CONTROL_CELLS_RECEIVE_DATA">
        <OneLineDescription>Memory where cells captured for the CPU are stored</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
            </Key>
            <Result>
                <Field Name="CONTROL_CELL_DATA" Type="ARRAY32" Size="110" Permission="READONLY" Description="Control cell place to read"/>
            </Result>
            <TableLabels>FABRIC</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                 <Field Name="CONTROL_CELL_DATA">
                    <Access>
                        <Register Name="FCR_CONTROL_CELL_FIFO_BUFFERr">
                            <HwField Name="CONTROL_CELL_FIFO_BUFFERf"/>
                        </Register>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>
    
    <AppDB Name="FABRIC_CONTROL_CELLS_RECEIVE_CONTROL">
        <OneLineDescription>Controls regarding the memory where cells captured for the CPU are stored</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
            </Key>
            <Result>
                <Field Name="CONTROL_CELL_DATA_READY" Type="BOOL" Permission="READONLY" Description="is CPU-control-FIFO not empty"/>
            </Result>
            <TableLabels>FABRIC</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                 <Field Name="CONTROL_CELL_DATA_READY">
                    <Access>
                        <Register Name="FCR_INTERRUPT_REGISTERr">
                            <HwField Name="CPU_CNT_CELL_FNEf"/>
                        </Register>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>

    <AppDB Name="FABRIC_CONTROL_CELLS_LLFC">
        <OneLineDescription>Set LLFC control cells configuration</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
                <Field Name="MAC" Type="FMAC_BLK_ID" Description="MAC id"/>
            </Key>
            <Result>
                <Field Name="ENABLE" Type="BOOL" Description="Enable the creation of link level flow control cells at the transmission side"/>
            </Result>
            <TableLabels>FABRIC</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                 <Field Name="ENABLE">
                    <Access EncodeType="BITWISE_NOT">
                        <Register Name="FMAC_GENERAL_CONFIGURATION_REGISTERr">
                            <BlockIndex Formula="MAC"/>
                            <HwField Name="ENABLE_SERIAL_LINKf"/>
                        </Register>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>
</AppDbCatalog>

