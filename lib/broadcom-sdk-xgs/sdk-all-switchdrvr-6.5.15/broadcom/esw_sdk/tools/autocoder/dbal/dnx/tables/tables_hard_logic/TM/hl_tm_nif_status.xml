<?xml version="1.0" encoding="UTF-8"?>

<!--
    ******************************************************
    DBAL Hard-Logic Logical Tables:
    This xml contains the hard-logic logical DB for the DBAL.
    The data is loaded to the device during init process
    ******************************************************

    DB Rules:
    *********
-->

<AppDbCatalog xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../hard_logic_schema.xsd">

    <AppDB Name="NIF_RX_FIFO_STATUS">
        <OneLineDescription>Table used for Rx FIFO status</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
                <Field Name="CORE_ID"/>
                <Field Name="CDU" Type="CDU_ID"/>
                <Field Name="RMC" Size="4" Type="UINT"/>
            </Key>
            <Result>
                <Field Name="MAX_OCCUPANCY" Size="15" Type="UINT" Permission="READONLY" Description="Indicates the corresponding lane MLF MAX fullness level of the FIFO"/>
                <Field Name="FIFO_LEVEL" Size="15" Type="UINT" Permission="READONLY" Description="Indicates the corresponding lane MLF fullness level of the FIFO"/>
            </Result>
            <TableLabels>NIF</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="DPC"/>
            <FieldMapping>
                <Field Name="MAX_OCCUPANCY">
                    <Access>
                        <KeyCondition Field="CDU" Type="EQUAL_TO" Value="0"/>
                        <Register Name="CDUM_RX_MLF_MAX_OCCUPANCYr">
                            <BlockIndex Formula="CORE_ID" />
                            <DataOffset Formula="RMC*15" />
                        </Register>
                    </Access>
                    <Access>
                        <KeyCondition Field="CDU" Type="BIGGER_THAN" Value="0"/>
                        <Register Name="CDU_RX_MLF_MAX_OCCUPANCYr">
                            <!--BlockIndex calculation: 12 CDUs in JER2, 2 are named CDUMs, 10 are CDUs. 
                            CDU0=>CDUM0, CDU1..5=>CDU0..4, CDU6=>CDUM1 CDU7..11=>CDU5..9 -->
                            <BlockIndex Formula="CORE_ID*5+CDU-1"/>
                            <DataOffset Formula="RMC*15" />
                        </Register>
                    </Access>
                </Field>
                <Field Name="FIFO_LEVEL">
                    <Access>
                        <KeyCondition Field="CDU" Type="EQUAL_TO" Value="0"/>
                        <Register Name="CDUM_RX_MLF_LEVELr">
                            <ArrayOffset Formula="RMC"/>
                            <BlockIndex Formula="CORE_ID" />
                            <HwField Name="RX_MLF_LEVEL_MLF_Nf"/>
                        </Register>
                    </Access>
                    <Access>
                        <KeyCondition Field="CDU" Type="BIGGER_THAN" Value="0"/>
                        <Register Name="CDU_RX_MLF_LEVELr">
                            <ArrayOffset Formula="RMC"/>
                            <BlockIndex Formula="CORE_ID*5+CDU-1"/>
                            <HwField Name="RX_MLF_LEVEL_MLF_Nf"/>
                        </Register>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>

    <AppDB Name="NIF_TX_FIFO_STATUS">
        <OneLineDescription>Table used for TX FIFO status.</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
                <Field Name="CORE_ID" />
                <Field Name="CDU" Type="CDU_ID"/>
                <Field Name="LANE" Size="3" Type="UINT" />
            </Key>
            <Result>
                <Field Name="MAX_OCCUPANCY" Size="14" Type="UINT" Permission="READONLY" Description="Indicates the corresponding lane MLF MAX fullness level of the FIFO"/>
                <Field Name="FIFO_LEVEL" Size="14" Type="UINT" Permission="READONLY" Description="Indicates the corresponding lane MLF fullness level of the FIFO"/>
                <Field Name="PM_CREDITS" Size="6"  Type="UINT" Permission="READONLY" Description="the number of credits received from the port-macro Tx buffer"/>
            </Result>
            <TableLabels>NIF</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="DPC"/>
            <FieldMapping>
                <Field Name="MAX_OCCUPANCY">
                    <Access>
                        <KeyCondition Field="CDU" Type="EQUAL_TO" Value="0"/>
                        <Register Name="CDUM_TX_MLF_MAX_OCCUPANCYr">
                            <BlockIndex Formula="CORE_ID" />
                            <DataOffset Formula="LANE*14" />
                        </Register>
                    </Access>
                    <Access>
                        <KeyCondition Field="CDU" Type="BIGGER_THAN" Value="0"/>
                        <Register Name="CDU_TX_MLF_MAX_OCCUPANCYr">
                            <BlockIndex Formula="CORE_ID*5+CDU-1"/>
                            <DataOffset Formula="LANE*14" />
                        </Register>
                    </Access>
                </Field>
                <Field Name="FIFO_LEVEL">
                    <Access>
                        <KeyCondition Field="CDU" Type="EQUAL_TO" Value="0"/>
                        <Register Name="CDUM_TX_MLF_LEVEL_PMr">
                            <BlockIndex Formula="CORE_ID" />
                            <DataOffset Formula="LANE*14" />
                        </Register>
                    </Access>
                    <Access>
                        <KeyCondition Field="CDU" Type="BIGGER_THAN" Value="0"/>
                        <Register Name="CDU_TX_MLF_LEVEL_PMr">
                            <BlockIndex Formula="CORE_ID*5+CDU-1"/>
                            <DataOffset Formula="LANE*14" />
                        </Register>
                    </Access>
                </Field>
                <Field Name="PM_CREDITS">
                    <Access>
                        <KeyCondition Field="CDU" Type="EQUAL_TO" Value="0"/>
                        <Register Name="CDUM_TX_MLF_NUM_CREDITS_FROM_PMr">
                            <BlockIndex Formula="CORE_ID" />
                            <DataOffset Formula="LANE*6" />
                        </Register>
                    </Access>
                    <Access>
                        <KeyCondition Field="CDU" Type="BIGGER_THAN" Value="0"/>
                        <Register Name="CDU_TX_MLF_NUM_CREDITS_FROM_PMr">
                            <BlockIndex Formula="CORE_ID*5+CDU-1"/>
                            <DataOffset Formula="LANE*6" />
                        </Register>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>

</AppDbCatalog> 

