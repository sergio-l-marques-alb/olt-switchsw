<?xml version="1.0" encoding="UTF-8"?>

<!-- ****************************************************** DBAL Hard-Logic
    Logical Tables: This xml contains the hard-logic logical DB for the DBAL.
    The data is loaded to the device during init process ******************************************************
    DB Rules: ********* -->

<AppDbCatalog xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../../hard_logic_schema.xsd">

    <!-- Ingress Protection Path Select -->
    <AppDB Name="FAILOVER_INGRESS_PATH_SELECT">
        <OneLineDescription>Ingress Protection Path Select - Used by Inlif Table</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
                <Field Name="PROTECTION_POINTER" Size="14"/>
            </Key>
            <Result>
                <Field Name="PROTECTION_PATH"/>
            </Result>
            <TableLabels>FAILOVER</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                <Field Name="PROTECTION_PATH">
                    <Access>
                        <Memory Name="IPPA_VTT_PATH_SELECTm">
                            <EntryOffset Formula="PROTECTION_POINTER/4" />
                            <DataOffset Formula="PROTECTION_POINTER%4" />
                        </Memory>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>

    <!-- Egress Protection Path Select -->
    <AppDB Name="FAILOVER_EGRESS_PATH_SELECT">
        <OneLineDescription>Egress Protection Path Select - Used by Outlif Table</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
                <Field Name="PROTECTION_POINTER" Size="18"/>
            </Key>
            <Result>
                <Field Name="PROTECTION_PATH"/>
            </Result>
            <TableLabels>FAILOVER</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                <Field Name="PROTECTION_PATH">
                    <Access>
                        <Memory Name="ETPPC_PROTECTION_TABLEm">
                            <EntryOffset Formula="PROTECTION_POINTER/32" />
                            <DataOffset Formula="PROTECTION_POINTER%32" />
                        </Memory>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>

    <!-- FEC Protection Path Select -->
    <AppDB Name="FAILOVER_FEC_PATH_SELECT">
        <OneLineDescription>FEC Protection Path Select - Used by FEC Table</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
                <Field Name="PROTECTION_POINTER" Size="18"/>
            </Key>
            <Result>
                <Field Name="PROTECTION_PATH"/>
            </Result>
            <TableLabels>FAILOVER</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                <Field Name="PROTECTION_PATH">
                    <Access>
                        <!-- For RPF -->
                        <Memory Name="IPPD_FEC_PATH_SELECTm">
                            <ArrayOffset Formula="PROTECTION_POINTER/16384" />
                            <EntryOffset Formula="PROTECTION_POINTER%16384/32" />
                            <DataOffset Formula="PROTECTION_POINTER%32" />
                        </Memory>
                    </Access>
                    <Access>
                        <!-- For forward -->
                        <Memory Name="IPPD_FEC_PATH_SELECTm">
                            <ArrayOffset Formula="PROTECTION_POINTER/16384+DNX_DATA.failover.path_select.nof_fec_path_select_banks"/>
                            <EntryOffset Formula="PROTECTION_POINTER%16384/32" />
                            <DataOffset Formula="PROTECTION_POINTER%32" />
                        </Memory>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>

    <AppDB Name="FAILOVER_FEC_PATH_SELECT_BANK_CONFIG">
        <OneLineDescription>Per Bank configuration of FEC protection path select table</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
                <Field Name="BANK_ID" Type="UINT" Size="4"
                    Description="bank ID in the table"/>
            </Key>
            <Result>
                <Field Name="HIERARCHY_LEVEL"/>
            </Result>
            <TableLabels>FAILOVER</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                <Field Name="HIERARCHY_LEVEL">
                    <Access>
                        <!-- For RPF -->
                        <Register Name="IPPD_FER_POINTER_CONSRUCTIONr">
                            <HwField Name="PROTECTION_TO_STAGE_MAP_RPFf"/>
                            <DataOffset Formula="BANK_ID*2" />
                        </Register>
                    </Access>
                    <Access>
                        <!-- For forward -->
                        <Register Name="IPPD_FER_POINTER_CONSRUCTIONr">
                            <HwField Name="PROTECTION_TO_STAGE_MAP_FWDf"/>
                            <DataOffset Formula="BANK_ID*2" />
                        </Register>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>
    
    <AppDB Name="FAILOVER_FEC_PATH_SELECT_CONFIG">
        <OneLineDescription>Global configuration of FEC protection path select table</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
            </Key>
            <Result>
                <Field Name="NO_PROTECTION_PTR" Type="PROTECTION_POINTER" Size="18" />
                <Field Name="FACILITY_PROTECTION_PTR" Type="PROTECTION_POINTER" Size="18"/>
                <Field Name="FACILITY_ACCELERATED_MODE_ENABLE" Type="BOOL" Description="Enable/Disable Facility accelerated mode" />
                <Field Name="FACILITY_LOGIC" Type="ARRAY32" Size="512" Description="Facility protection resolution logic" /> 
                <Field Name="FACILITY_TRAP_LOGIC" Type="ARRAY32" Size="512" Description="Facility trap protection resolution logic" />                                
            </Result>
            <TableLabels>FAILOVER</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                <Field Name="NO_PROTECTION_PTR">
                    <Access>
                        <Register Name="IPPD_RESOLUTION_CFGr">
                            <HwField Name="NOT_PROTECTED_CODEf"/>
                        </Register>
                    </Access>
                </Field>
                <Field Name="FACILITY_PROTECTION_PTR">
                    <Access>
                        <Register Name="IPPD_RESOLUTION_CFGr">
                            <HwField Name="FACILITY_PROTECTED_CODEf"/>
                        </Register>
                    </Access>
                </Field>
                <Field Name="FACILITY_ACCELERATED_MODE_ENABLE">
                    <Access>
                        <Register Name="IPPD_RESOLUTION_CFGr">
                            <HwField Name="ENABLE_PATH_AND_FACILITIY_PROTECTIONf"/>
                        </Register>
                    </Access>
                </Field>
                <Field Name="FACILITY_LOGIC">
                    <Access>
                        <Register Name="IPPD_RESOLUTION_FACILITY_PROTECTION_LOGICr">
                            <HwField Name="FACILITY_PROTECTION_LOGICf"/>
                        </Register>
                    </Access>
                </Field>
                <Field Name="FACILITY_TRAP_LOGIC">
                    <Access>
                        <Register Name="IPPD_RESOLUTION_FACILITY_TRAP_LOGICr">
                            <HwField Name="FACILITY_TRAP_LOGICf"/>
                        </Register>
                    </Access>
                </Field>                                                 
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>

    <AppDB Name="FAILOVER_FACILITY_DESTINATION_STATUS">
        <OneLineDescription>Per system port (physical system port/LAG) state table</OneLineDescription>
        <AccessMethod>HARD_LOGIC</AccessMethod>
        <Maturity Level="HIGH"/>
        <AppDbInterface Type="DIRECT">
            <Key>
                <Field Name="SYSTEM_PORT"/>
            </Key>
            <Result>
                <Field Name="ENABLE" Type="BOOL"/>
            </Result>
            <TableLabels>L3</TableLabels>
        </AppDbInterface>
        <AppToPhyDbMapping>
            <CoreMode Mode="SBC"/>
            <FieldMapping>
                <Field Name="ENABLE">
                    <Access>
                        <Memory Name="IPPD_DESTINATION_STATUSm">
                            <EntryOffset Formula="SYSTEM_PORT/8" />
                            <DataOffset Formula="SYSTEM_PORT%8" />
                        </Memory>
                    </Access>
                </Field>
            </FieldMapping>
        </AppToPhyDbMapping>
    </AppDB>
    
</AppDbCatalog>

