
/*
 * $Copyright: (c) 2021 Broadcom.
 * Broadcom Proprietary and Confidential. All rights reserved.$
 */


#include <shared/shrextend/shrextend_debug.h>
#include <soc/dnx/dbal/dbal.h>
#include <soc/dnx/mdb.h>
#include <soc/dnx/swstate/auto_generated/access/mdb_em_access.h>

#include "mdb_init_internal.h"

#ifdef BSL_LOG_MODULE
#error "BSL_LOG_MODULE redefined"
#endif
#define BSL_LOG_MODULE BSL_LS_SOCDNX_MDBDNX









typedef enum
{

    

    MDB_STEP_TABLE_SIZE_512 = 512,

    

    MDB_STEP_TABLE_SIZE_1024 = 1024,

    

    MDB_STEP_TABLE_SIZE_2048 = 2048
} mdb_step_table_array_size_e;



typedef enum
{

    

    MDB_STEP_TABLE_OPCODE_FE_QUARTER = 0,

    

    MDB_STEP_TABLE_OPCODE_FF_QUARTER = 1,

    

    MDB_STEP_TABLE_OPCODE_FE_HALF = 2,

    

    MDB_STEP_TABLE_OPCODE_FF_HALF = 3,

    

    MDB_STEP_TABLE_OPCODE_FE_ONE = 4,

    

    MDB_STEP_TABLE_OPCODE_FF_ONE = 5,

    

    MDB_STEP_TABLE_OPCODE_FF_ANY = 6,

    

    MDB_STEP_TABLE_OPCODE_FE_ANY = 7,

    

    MDB_STEP_TABLE_OPCODE_FE_EIGHTH = 10,

    

    MDB_STEP_TABLE_OPCODE_FF_EIGHTH = 11,

    

    MDB_STEP_TABLE_OPCODE_END = 14,
} mdb_step_table_opcodes_e;






#define MDB_STEP_TABLE_SIZE_2_TABLE_SIZE_INDEX(table_size) (utilex_log2_round_up(table_size) - 9)



#define MDB_STEP_TABLE_ASPECT_RATIO_COMBINATION(ar_array) ( ar_array[MDB_STEP_TABLE_ENTRY_SIZE_ONE] << MDB_STEP_TABLE_ENTRY_SIZE_ONE | \
                                                            ar_array[MDB_STEP_TABLE_ENTRY_SIZE_HALF] << MDB_STEP_TABLE_ENTRY_SIZE_HALF | \
                                                            ar_array[MDB_STEP_TABLE_ENTRY_SIZE_QUARTER] << MDB_STEP_TABLE_ENTRY_SIZE_QUARTER | \
                                                            ar_array[MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH] << MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH )






typedef struct mdb_step_table_row_info
{

    

    mdb_step_table_opcodes_e command;

    

    uint8 eot;

    

    uint32 success_ptr;

    

    uint32 fail_ptr;

    

    uint32 success_was_updated;
} mdb_step_table_row_info_t;



typedef struct mdb_step_table_info
{



    uint32 step_table_size;



    uint32 entry_offset;



    mdb_step_table_entry_size_e smallest_ar;



    uint8 ar_list[MDB_STEP_TABLE_NOF_ENTRY_SIZES];



    uint32 start_pointers[MDB_STEP_TABLE_NOF_ENTRY_SIZES];

    
    mdb_step_table_row_info_t step_table[DNX_DATA_MAX_MDB_EM_STEP_TABLE_MAX_SIZE];
} mdb_step_table_info_t;






const mdb_em_entry_encoding_e mdb_step_table_map_ratio_size_to_enc_ratio[MDB_STEP_TABLE_NOF_ENTRY_SIZES] =
    { MDB_EM_ENTRY_ENCODING_ONE, MDB_EM_ENTRY_ENCODING_HALF, MDB_EM_ENTRY_ENCODING_QUARTER,
    MDB_EM_ENTRY_ENCODING_EIGHTH
};



const mdb_step_table_opcodes_e mdb_step_table_fe_values[MDB_STEP_TABLE_NOF_ENTRY_SIZES] =
    { MDB_STEP_TABLE_OPCODE_FE_ONE, MDB_STEP_TABLE_OPCODE_FE_HALF, MDB_STEP_TABLE_OPCODE_FE_QUARTER,
    MDB_STEP_TABLE_OPCODE_FE_EIGHTH
};



const uint32 mdb_init_step_table_start_pointers[MDB_STEP_TABLE_NOF_ENTRY_SIZES] = { 1, 16, 36, 1 };



const uint32 mdb_init_step_table_512[MDB_STEP_TABLE_SIZE_512] = {
    0x007ffffe, 0x00008004, 0x00010065, 0x00008034, 0x0001c0a5, 0x000100d5, 0x00014074, 0x0002c105, 0x0001c135,
    0x00020155, 0x000240d4, 0x00000195, 0x0002c1b5, 0x000301d5, 0x000341f5, 0x00038154, 0x00044002, 0x00048004,
    0x00054263, 0x00050202, 0x00048214, 0x000642c3, 0x000542f3, 0x00060262, 0x00058274, 0x00078343, 0x00064373,
    0x00068393, 0x000742e2, 0x0006c2f4, 0x000003f3, 0x00078413, 0x0007c433, 0x00080453, 0x0008c382, 0x00084394,
    0x00094000, 0x00098002, 0x0009c004, 0x000ac501, 0x000a4480, 0x000a8482, 0x0009c494, 0x000c0581, 0x000ac5b1,
    0x000b8500, 0x000bc502, 0x000b0514, 0x000d8621, 0x000c0651, 0x000c4671, 0x000d05a0, 0x000d45a2, 0x000c85b4,
    0x000006f1, 0x000d8711, 0x000dc731, 0x000e0751, 0x000ec660, 0x000f0662, 0x000e4674, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000
};



const uint32 mdb_init_step_table_1024[MDB_STEP_TABLE_SIZE_1024] = {
    0x01fffffe, 0x00010004, 0x00020065, 0x00010034, 0x000380a5, 0x000200d5, 0x00028074, 0x00058105, 0x00038135,
    0x00040155, 0x000480d4, 0x00000195, 0x000581b5, 0x000601d5, 0x000681f5, 0x00070154, 0x00088002, 0x00090004,
    0x000a8263, 0x000a0202, 0x00090214, 0x000c82c3, 0x000a82f3, 0x000c0262, 0x000b0274, 0x000f0343, 0x000c8373,
    0x000d0393, 0x000e82e2, 0x000d82f4, 0x000003f3, 0x000f0413, 0x000f8433, 0x00100453, 0x00118382, 0x00108394,
    0x00128000, 0x00130002, 0x00138004, 0x00158501, 0x00148480, 0x00150482, 0x00138494, 0x00180581, 0x001585b1,
    0x00170500, 0x00178502, 0x00160514, 0x001b0621, 0x00180651, 0x00188671, 0x001a05a0, 0x001a85a2, 0x001905b4,
    0x000006f1, 0x001b0711, 0x001b8731, 0x001c0751, 0x001d8660, 0x001e0662, 0x001c8674, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000
};



const uint32 mdb_init_step_table_2048[MDB_STEP_TABLE_SIZE_2048] = {
    0x07fffffe, 0x00020004, 0x00040065, 0x00020034, 0x000700a5, 0x000400d5, 0x00050074, 0x000b0105, 0x00070135,
    0x00080155, 0x000900d4, 0x00000195, 0x000b01b5, 0x000c01d5, 0x000d01f5, 0x000e0154, 0x00110002, 0x00120004,
    0x00150263, 0x00140202, 0x00120214, 0x001902c3, 0x001502f3, 0x00180262, 0x00160274, 0x001e0343, 0x00190373,
    0x001a0393, 0x001d02e2, 0x001b02f4, 0x000003f3, 0x001e0413, 0x001f0433, 0x00200453, 0x00230382, 0x00210394,
    0x00250000, 0x00260002, 0x00270004, 0x002b0501, 0x00290480, 0x002a0482, 0x00270494, 0x00300581, 0x002b05b1,
    0x002e0500, 0x002f0502, 0x002c0514, 0x00360621, 0x00300651, 0x00310671, 0x003405a0, 0x003505a2, 0x003205b4,
    0x000006f1, 0x00360711, 0x00370731, 0x00380751, 0x003b0660, 0x003c0662, 0x00390674, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
    0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000
};






shr_error_e
mdb_get_step_table_values(
    int unit,
    dbal_physical_tables_e dbal_physical_table_id,
    const uint32 **step_table_array)
{
    SHR_FUNC_INIT_VARS(unit);

    switch (dnx_data_mdb.em.em_info_get(unit, dbal_physical_table_id)->step_table_size)
    {
        case MDB_STEP_TABLE_SIZE_512:
            *step_table_array = mdb_init_step_table_512;
            break;
        case MDB_STEP_TABLE_SIZE_1024:
            *step_table_array = mdb_init_step_table_1024;
            break;
        case MDB_STEP_TABLE_SIZE_2048:
            *step_table_array = mdb_init_step_table_2048;
            break;
        default:
            SHR_ERR_EXIT(_SHR_E_BADID, "Error. This table %d doesn't have a matching step table array.\n",
                         dbal_physical_table_id);
    }

exit:
    SHR_FUNC_EXIT;
}



shr_error_e
mdb_step_table_add_entry(
    int unit,
    uint32 entry_offset,
    mdb_step_table_opcodes_e command,
    uint32 success_ptr,
    uint32 fail_ptr,
    uint8 eot,
    uint8 success_was_updated,
    mdb_step_table_info_t * step_info)
{
    SHR_FUNC_INIT_VARS(unit);
    if (entry_offset < step_info->step_table_size)
    {
        step_info->step_table[entry_offset].command = command;
        step_info->step_table[entry_offset].success_ptr = success_ptr;
        step_info->step_table[entry_offset].fail_ptr = fail_ptr;
        step_info->step_table[entry_offset].eot = eot;
        step_info->step_table[entry_offset].success_was_updated = success_was_updated;
    }
    

    SHR_EXIT();

exit:
    SHR_FUNC_EXIT;
}



shr_error_e
mdb_step_table_wrap_section(
    int unit,
    uint32 section_start,
    mdb_step_table_entry_size_e entry_type,
    uint8 new_depth,
    mdb_step_table_info_t * step_info)
{
    uint32 next_success = new_depth ? 0 : step_info->entry_offset;
    mdb_step_table_entry_size_e entry_type_iter;

    SHR_FUNC_INIT_VARS(unit);



    for (entry_type_iter = entry_type; entry_type_iter > MDB_STEP_TABLE_ENTRY_SIZE_ONE; entry_type_iter--)
    {
        SHR_IF_ERR_EXIT(mdb_step_table_add_entry
                        (unit, step_info->entry_offset, mdb_step_table_fe_values[entry_type_iter], next_success,
                         step_info->entry_offset + 1, FALSE, FALSE, step_info));
        step_info->entry_offset++;
    }



    SHR_IF_ERR_EXIT(mdb_step_table_add_entry
                    (unit, step_info->entry_offset++, MDB_STEP_TABLE_OPCODE_FE_ONE, next_success, section_start, FALSE,
                     FALSE, step_info));
exit:
    SHR_FUNC_EXIT;
}



shr_error_e
mdb_step_table_generate_any(
    int unit,
    mdb_step_table_info_t * step_info,
    uint8 depth,
    uint8 last_depth)
{
    uint32 depth_offset;
    uint32 ff_depth_offset;
    uint8 depth_inner_iter;

    SHR_FUNC_INIT_VARS(unit);

    depth_offset = step_info->entry_offset;

    
    for (depth_inner_iter = 0; depth_inner_iter < depth; depth_inner_iter++)
    {
        
        if (step_info->entry_offset < step_info->step_table_size)
        {
            step_info->step_table[step_info->entry_offset].command = MDB_STEP_TABLE_OPCODE_FF_ANY;
            
            if ((depth_inner_iter == 0) && (last_depth == FALSE))
            {
                step_info->step_table[step_info->entry_offset].eot = 0;
            }
            else
            {
                step_info->step_table[step_info->entry_offset].eot = 1;
            }
            
            step_info->step_table[step_info->entry_offset].success_ptr = step_info->entry_offset + 1;
            
            if ((last_depth == TRUE) && (depth_inner_iter == 0))
            {
                step_info->step_table[step_info->entry_offset].fail_ptr = 0;
            }
            else
            {
                if (depth_inner_iter != 0)
                {
                    step_info->step_table[step_info->entry_offset].fail_ptr = step_info->entry_offset - 1;
                }
            }
        }

        step_info->entry_offset++;
    }

    
    ff_depth_offset = step_info->entry_offset - 1;

    
    for (depth_inner_iter = 0; depth_inner_iter < depth + 1; depth_inner_iter++)
    {
        uint8 offset_from_ff;

        
        if (step_info->entry_offset < step_info->step_table_size)
        {
            step_info->step_table[step_info->entry_offset].command = MDB_STEP_TABLE_OPCODE_FE_ANY;
            
            if ((depth_inner_iter == 0) && (depth_inner_iter != depth))
            {
                step_info->step_table[step_info->entry_offset].eot = 1;
            }
            else
            {
                step_info->step_table[step_info->entry_offset].eot = 0;
            }
            
            if (depth_inner_iter == depth)
            {
                step_info->step_table[step_info->entry_offset].success_ptr = 0;
            }
            else
            {
                step_info->step_table[step_info->entry_offset].success_ptr = step_info->entry_offset + 1;
            }

            
            offset_from_ff = step_info->entry_offset - ff_depth_offset;
            if (offset_from_ff <= 2)
            {
                step_info->step_table[step_info->entry_offset].fail_ptr = ff_depth_offset;
            }
            else
            {
                step_info->step_table[step_info->entry_offset].fail_ptr = ff_depth_offset - (offset_from_ff - 2);
            }
        }

        step_info->entry_offset++;
    }

    
    if (last_depth == FALSE)
    {
        
        if (depth_offset < step_info->step_table_size)
        {
            step_info->step_table[depth_offset].fail_ptr = step_info->entry_offset;
        }
    }

    SHR_EXIT();

exit:
    SHR_FUNC_EXIT;
}



shr_error_e
mdb_step_table_generate(
    int unit,
    mdb_step_table_info_t * step_info,
    uint8 depth,
    mdb_step_table_entry_size_e entry_type,
    uint8 last_depth,
    uint8 new_depth)
{
    uint8 success_wrapped[MDB_STEP_TABLE_NOF_ENTRY_SIZES];
    SHR_FUNC_INIT_VARS(unit);

    sal_memset(success_wrapped, FALSE, MDB_STEP_TABLE_NOF_ENTRY_SIZES);

    
    if (depth > 0)
    {
        uint32 success_itr;
        uint32 original_offset[MDB_STEP_TABLE_NOF_ENTRY_SIZES];
        uint32 next_success_start;

        
        if (step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_ONE] == TRUE)
        {
            
            original_offset[MDB_STEP_TABLE_ENTRY_SIZE_ONE] = step_info->entry_offset++;

            
            SHR_IF_ERR_EXIT(mdb_step_table_generate
                            (unit, step_info, depth - 1, MDB_STEP_TABLE_ENTRY_SIZE_ONE, FALSE, FALSE));

            
            if (step_info->entry_offset >= step_info->step_table_size)
            {
                SHR_EXIT();
            }

            
            if (!step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH]
                && !step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_QUARTER]
                && !step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_HALF])
            {
                
                for (success_itr = original_offset[MDB_STEP_TABLE_ENTRY_SIZE_ONE];
                     success_itr < step_info->entry_offset; success_itr++)
                {
                    if (!step_info->step_table[success_itr].success_was_updated)
                    {
                        step_info->step_table[success_itr].success_ptr = step_info->entry_offset;
                        step_info->step_table[success_itr].success_was_updated = TRUE;
                    }
                }

                
                SHR_IF_ERR_EXIT(mdb_step_table_wrap_section
                                (unit, original_offset[MDB_STEP_TABLE_ENTRY_SIZE_ONE], entry_type, new_depth,
                                 step_info));
                success_wrapped[MDB_STEP_TABLE_ENTRY_SIZE_ONE] = TRUE;
            }
            SHR_IF_ERR_EXIT(mdb_step_table_add_entry
                            (unit, original_offset[MDB_STEP_TABLE_ENTRY_SIZE_ONE], MDB_STEP_TABLE_OPCODE_FF_ONE,
                             original_offset[MDB_STEP_TABLE_ENTRY_SIZE_ONE] + 1, step_info->entry_offset, FALSE, TRUE,
                             step_info));
        }
        else
        {
            original_offset[MDB_STEP_TABLE_ENTRY_SIZE_ONE] = step_info->entry_offset;
        }

        if (step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_HALF] == TRUE)
        {
            original_offset[MDB_STEP_TABLE_ENTRY_SIZE_HALF] = step_info->entry_offset++;
            SHR_IF_ERR_EXIT(mdb_step_table_generate
                            (unit, step_info, depth - 1, MDB_STEP_TABLE_ENTRY_SIZE_HALF, FALSE, FALSE));

            
            if (step_info->entry_offset >= step_info->step_table_size)
            {
                SHR_EXIT();
            }

            if ((!step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_QUARTER]
                 && !step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH])
                || (entry_type == MDB_STEP_TABLE_ENTRY_SIZE_ONE) || (new_depth
                                                                     &&
                                                                     step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_ONE]
                                                                     == TRUE))
            {
                next_success_start =
                    success_wrapped[MDB_STEP_TABLE_ENTRY_SIZE_ONE] ? original_offset[MDB_STEP_TABLE_ENTRY_SIZE_HALF] :
                    original_offset[MDB_STEP_TABLE_ENTRY_SIZE_ONE];

                for (success_itr = next_success_start; success_itr < step_info->entry_offset; success_itr++)
                {
                    if (!step_info->step_table[success_itr].success_was_updated)
                    {
                        step_info->step_table[success_itr].success_ptr = step_info->entry_offset;
                        step_info->step_table[success_itr].success_was_updated = TRUE;
                    }
                }
                SHR_IF_ERR_EXIT(mdb_step_table_wrap_section
                                (unit, original_offset[MDB_STEP_TABLE_ENTRY_SIZE_HALF], entry_type, new_depth,
                                 step_info));
                success_wrapped[MDB_STEP_TABLE_ENTRY_SIZE_HALF] = TRUE;
            }
            SHR_IF_ERR_EXIT(mdb_step_table_add_entry
                            (unit, original_offset[MDB_STEP_TABLE_ENTRY_SIZE_HALF], MDB_STEP_TABLE_OPCODE_FF_HALF,
                             original_offset[MDB_STEP_TABLE_ENTRY_SIZE_HALF] + 1, step_info->entry_offset, FALSE, TRUE,
                             step_info));
        }
        else
        {
            original_offset[MDB_STEP_TABLE_ENTRY_SIZE_HALF] = step_info->entry_offset;
        }

        if (step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_QUARTER] == TRUE)
        {
            original_offset[MDB_STEP_TABLE_ENTRY_SIZE_QUARTER] = step_info->entry_offset++;
            SHR_IF_ERR_EXIT(mdb_step_table_generate
                            (unit, step_info, depth - 1, MDB_STEP_TABLE_ENTRY_SIZE_QUARTER, FALSE, FALSE));

            
            if (step_info->entry_offset >= step_info->step_table_size)
            {
                SHR_EXIT();
            }

            if (!step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH]
                || ((entry_type == MDB_STEP_TABLE_ENTRY_SIZE_ONE) || (entry_type == MDB_STEP_TABLE_ENTRY_SIZE_HALF))
                || (new_depth
                    && ((step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_ONE] == TRUE)
                        || (step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_HALF] == TRUE))))
            {
                next_success_start = (success_wrapped[MDB_STEP_TABLE_ENTRY_SIZE_ONE]
                                      || success_wrapped[MDB_STEP_TABLE_ENTRY_SIZE_HALF]) ?
                    original_offset[MDB_STEP_TABLE_ENTRY_SIZE_QUARTER] : original_offset[MDB_STEP_TABLE_ENTRY_SIZE_ONE];

                for (success_itr = next_success_start; success_itr < step_info->entry_offset; success_itr++)
                {
                    if (!step_info->step_table[success_itr].success_was_updated)
                    {
                        step_info->step_table[success_itr].success_ptr = step_info->entry_offset;
                        step_info->step_table[success_itr].success_was_updated = TRUE;
                    }
                }
                SHR_IF_ERR_EXIT(mdb_step_table_wrap_section
                                (unit, original_offset[MDB_STEP_TABLE_ENTRY_SIZE_QUARTER], entry_type, new_depth,
                                 step_info));
                success_wrapped[MDB_STEP_TABLE_ENTRY_SIZE_QUARTER] = TRUE;
            }
            SHR_IF_ERR_EXIT(mdb_step_table_add_entry
                            (unit, original_offset[MDB_STEP_TABLE_ENTRY_SIZE_QUARTER], MDB_STEP_TABLE_OPCODE_FF_QUARTER,
                             original_offset[MDB_STEP_TABLE_ENTRY_SIZE_QUARTER] + 1, step_info->entry_offset, FALSE,
                             TRUE, step_info));
        }
        else
        {
            original_offset[MDB_STEP_TABLE_ENTRY_SIZE_QUARTER] = step_info->entry_offset;
        }

        if (step_info->ar_list[MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH] == TRUE)
        {
            original_offset[MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH] = step_info->entry_offset++;
            SHR_IF_ERR_EXIT(mdb_step_table_generate
                            (unit, step_info, depth - 1, MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH, FALSE, FALSE));

            
            if (step_info->entry_offset >= step_info->step_table_size)
            {
                SHR_EXIT();
            }

            next_success_start = (success_wrapped[MDB_STEP_TABLE_ENTRY_SIZE_ONE]
                                  || success_wrapped[MDB_STEP_TABLE_ENTRY_SIZE_HALF]
                                  || success_wrapped[MDB_STEP_TABLE_ENTRY_SIZE_QUARTER]) ?
                original_offset[MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH] : original_offset[MDB_STEP_TABLE_ENTRY_SIZE_ONE];

            for (success_itr = next_success_start; success_itr < step_info->entry_offset; success_itr++)
            {
                if (!step_info->step_table[success_itr].success_was_updated)
                {
                    step_info->step_table[success_itr].success_ptr = step_info->entry_offset;
                    step_info->step_table[success_itr].success_was_updated = TRUE;
                }
            }
            SHR_IF_ERR_EXIT(mdb_step_table_wrap_section
                            (unit, original_offset[MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH], entry_type, new_depth,
                             step_info));
            success_wrapped[MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH] = TRUE;

            SHR_IF_ERR_EXIT(mdb_step_table_add_entry
                            (unit, original_offset[MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH], MDB_STEP_TABLE_OPCODE_FF_EIGHTH,
                             original_offset[MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH] + 1, step_info->entry_offset, FALSE,
                             TRUE, step_info));
        }
        else
        {
            original_offset[MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH] = step_info->entry_offset;
        }

        if (last_depth)
        {
            step_info->step_table[original_offset[step_info->smallest_ar]].fail_ptr = 0;
            step_info->step_table[original_offset[step_info->smallest_ar]].eot = 1;

        }
        else if (new_depth)
        {
            step_info->step_table[original_offset[step_info->smallest_ar]].fail_ptr = step_info->entry_offset;
            step_info->step_table[original_offset[step_info->smallest_ar]].eot = 0;
        }
        else
        {
            step_info->step_table[original_offset[step_info->smallest_ar]].fail_ptr =
                original_offset[MDB_STEP_TABLE_ENTRY_SIZE_ONE] - 1;
            step_info->step_table[original_offset[step_info->smallest_ar]].eot = 1;
        }

    }
    else
    {
        uint8 eot = (new_depth && !last_depth) ? 0 : 1;
        uint32 next_fail = step_info->entry_offset - 1;
        mdb_step_table_entry_size_e entry_type_iter;

        
        for (entry_type_iter = entry_type; entry_type_iter > MDB_STEP_TABLE_ENTRY_SIZE_ONE; entry_type_iter--)
        {
            SHR_IF_ERR_EXIT(mdb_step_table_add_entry
                            (unit, step_info->entry_offset, mdb_step_table_fe_values[entry_type_iter], 0,
                             step_info->entry_offset + 1, FALSE, FALSE, step_info));
            step_info->entry_offset++;
        }

        if (new_depth)
        {
            next_fail = last_depth ? 0 : step_info->entry_offset + 1;
        }

        SHR_IF_ERR_EXIT(mdb_step_table_add_entry
                        (unit, step_info->entry_offset++, MDB_STEP_TABLE_OPCODE_FE_ONE, 0, next_fail, eot, FALSE,
                         step_info));

    }

exit:
    SHR_FUNC_EXIT;
}



shr_error_e
mdb_step_info_init(
    int unit,
    dbal_physical_tables_e dbal_physical_table_id,
    mdb_step_table_info_t * step_info)
{
    int entry_size;
    SHR_FUNC_INIT_VARS(unit);

    step_info->smallest_ar = MDB_STEP_TABLE_NOF_ENTRY_SIZES;
    step_info->step_table_size = dnx_data_mdb.em.em_info_get(unit, dbal_physical_table_id)->step_table_size;



    for (entry_size = MDB_STEP_TABLE_ENTRY_SIZE_ONE; entry_size < MDB_STEP_TABLE_ENTRY_SIZE_EIGHTH; entry_size++)
    {
        uint8 vmv_value = 0;

        SHR_IF_ERR_EXIT(mdb_em_db.vmv_info.value.get(unit, dbal_physical_table_id, entry_size, &vmv_value));

        if (MDB_EM_TABLE_USE_ALL_ASPECT_RATIOS(dbal_physical_table_id) || vmv_value)
        {
            step_info->ar_list[entry_size] = TRUE;
            step_info->smallest_ar = entry_size;
        }
    }

exit:
    SHR_FUNC_EXIT;
}



shr_error_e
mdb_step_table_init_single(
    int unit,
    dbal_physical_tables_e dbal_physical_table_id)
{
    uint32 entry_handle_mdb_step_table;
    uint32 entry_handle_mdb_32_table;
    const uint32 *step_table_array;
    int array_index, start_ptr_index;
    dbal_tables_e step_table;
    SHR_FUNC_INIT_VARS(unit);
    DBAL_FUNC_INIT_VARS(unit);



    step_table = dnx_data_mdb.em.mdb_step_table_map_get(unit, dbal_physical_table_id)->dbal_table;

    SHR_IF_ERR_EXIT(DBAL_HANDLE_ALLOC(unit, step_table, &entry_handle_mdb_step_table));

    SHR_IF_ERR_EXIT(DBAL_HANDLE_ALLOC
                    (unit,
                     dnx_data_mdb.em.mdb_32_info_get(unit,
                                                     dbal_physical_table_id)->dbal_table, &entry_handle_mdb_32_table));

    SHR_IF_ERR_EXIT(mdb_get_step_table_values(unit, dbal_physical_table_id, &step_table_array));

    for (array_index = 0; array_index < dnx_data_mdb.em.em_info_get(unit, dbal_physical_table_id)->step_table_size;
         array_index++)
    {

        dbal_entry_key_field32_set(unit, entry_handle_mdb_step_table, DBAL_FIELD_MDB_KEY_0, array_index);

        dbal_entry_value_field32_set(unit, entry_handle_mdb_step_table, DBAL_FIELD_MDB_ITEM_0, INST_SINGLE,
                                     step_table_array[array_index]);

        SHR_IF_ERR_EXIT(dbal_entry_commit(unit, entry_handle_mdb_step_table, DBAL_COMMIT));

        SHR_IF_ERR_EXIT(DBAL_HANDLE_CLEAR(unit, step_table, entry_handle_mdb_step_table));
    }

    for (start_ptr_index = 0; start_ptr_index < MDB_STEP_TABLE_NOF_ENTRY_SIZES; start_ptr_index++)
    {
        dbal_entry_value_field32_set(unit, entry_handle_mdb_32_table, DBAL_FIELD_MDB_ITEM_0, start_ptr_index,
                                     mdb_init_step_table_start_pointers[start_ptr_index]);
    }
    SHR_IF_ERR_EXIT(dbal_entry_commit(unit, entry_handle_mdb_32_table, DBAL_COMMIT));

exit:
    DBAL_FUNC_FREE_VARS;
    SHR_FUNC_EXIT;
}



shr_error_e
mdb_step_table_init_mix(
    int unit,
    dbal_physical_tables_e dbal_physical_table_id)
{
    uint32 entry_handle_mdb_step_table;
    uint32 entry_handle_mdb_32_table;
    uint32 depth_itr;
    uint32 max_step_table_depth;
    uint32 prev_step_table_depth = 0;
    int array_index, start_ptr_index;
    mdb_step_table_info_t *step_info = NULL;
    dbal_tables_e step_table;
    uint32 nof_ways, nof_flex_ways;
    uint8 aspect_ratio_iter;
    uint32 previous_entry_offset = 0;

    SHR_FUNC_INIT_VARS(unit);
    DBAL_FUNC_INIT_VARS(unit);

    
    step_table = dnx_data_mdb.em.mdb_step_table_map_get(unit, dbal_physical_table_id)->dbal_table;

    SHR_IF_ERR_EXIT(DBAL_HANDLE_ALLOC(unit, step_table, &entry_handle_mdb_step_table));

    SHR_IF_ERR_EXIT(DBAL_HANDLE_ALLOC
                    (unit,
                     dnx_data_mdb.em.mdb_32_info_get(unit,
                                                     dbal_physical_table_id)->dbal_table, &entry_handle_mdb_32_table));

    SHR_ALLOC_SET_ZERO_ERR_EXIT(step_info, sizeof(mdb_step_table_info_t), "step table structure was allocated",
                                "%s%s%s\r\n", EMPTY, EMPTY, EMPTY);

    SHR_IF_ERR_EXIT(mdb_step_info_init(unit, dbal_physical_table_id, step_info));

    
    max_step_table_depth = UTILEX_MIN(dnx_data_mdb.em.step_table_max_depth_possible_get(unit,
                                                                                        MDB_STEP_TABLE_SIZE_2_TABLE_SIZE_INDEX
                                                                                        (step_info->step_table_size),
                                                                                        MDB_STEP_TABLE_ASPECT_RATIO_COMBINATION
                                                                                        (step_info->
                                                                                         ar_list))->max_depth,
                                      dnx_data_mdb.em.step_table_pdb_max_depth_get(unit,
                                                                                   dbal_physical_table_id)->max_depth);

    
    SHR_IF_ERR_EXIT(mdb_db_infos.em_key_format.nof_ways.get(unit, dbal_physical_table_id, &nof_ways));
    SHR_IF_ERR_EXIT(mdb_db_infos.em_key_format.nof_flex_ways.get(unit, dbal_physical_table_id, &nof_flex_ways));

    
    for (aspect_ratio_iter = 0; aspect_ratio_iter < MDB_STEP_TABLE_NOF_ENTRY_SIZES; aspect_ratio_iter++)
    {
        uint32 step_table_depth;
        int aspect_ratio_iter_inner;

        if (step_info->ar_list[aspect_ratio_iter] == FALSE)
        {
            continue;
        }

        
        step_table_depth =
            UTILEX_MIN(max_step_table_depth,
                       dnx_data_mdb.em.step_table_max_depth_nof_ways_ar_get(unit, aspect_ratio_iter,
                                                                            UTILEX_MIN
                                                                            (DNX_DATA_MAX_MDB_PDBS_MAX_NOF_INTERFACE_DHS,
                                                                             nof_ways + nof_flex_ways))->max_depth);

        
        if (prev_step_table_depth == step_table_depth)
        {
            continue;
        }
        prev_step_table_depth = step_table_depth;

        
        SHR_IF_ERR_EXIT(mdb_step_table_add_entry
                        (unit, step_info->entry_offset++, MDB_STEP_TABLE_OPCODE_END,
                         UTILEX_BITS_MASK(dnx_data_mdb.em.
                                          mdb_41_info_get(unit, dbal_physical_table_id)->mdb_item_2_field_size - 1, 0),
                         UTILEX_BITS_MASK(dnx_data_mdb.em.
                                          mdb_41_info_get(unit, dbal_physical_table_id)->mdb_item_3_field_size - 1, 0),
                         TRUE, TRUE, step_info));

        
        for (depth_itr = 0; depth_itr < step_table_depth; depth_itr++)
        {
            uint8 is_last_depth = (depth_itr == step_table_depth - 1) ? TRUE : FALSE;

            if (dnx_data_mdb.em.feature_get(unit, dnx_data_mdb_em_step_table_any_cmds_support))
            {
                SHR_IF_ERR_EXIT(mdb_step_table_generate_any(unit, step_info, depth_itr, is_last_depth));
            }
            else
            {
                SHR_IF_ERR_EXIT(mdb_step_table_generate
                                (unit, step_info, depth_itr, step_info->smallest_ar, is_last_depth, TRUE));
            }
        }

        
        if (step_info->entry_offset > step_info->step_table_size)
        {
            int reset_entries_num;

            
            if (previous_entry_offset == 0)
            {
                SHR_ERR_EXIT(_SHR_E_INTERNAL,
                             "Error. First aspect ratio with depth %d does not fit in %s step table , required size (%d), step table size (%d).\n",
                             step_table_depth, dbal_physical_table_to_string(unit, dbal_physical_table_id),
                             step_info->entry_offset, step_info->step_table_size);
            }

            
            reset_entries_num = UTILEX_MIN(step_info->entry_offset, step_info->step_table_size) - previous_entry_offset;

            if (reset_entries_num != 0)
            {
                sal_memset(&step_info->step_table[previous_entry_offset], 0x0,
                           sizeof(mdb_step_table_row_info_t) * reset_entries_num);
            }
            step_info->entry_offset = previous_entry_offset;
            continue;
        }

        
        for (aspect_ratio_iter_inner = step_info->smallest_ar; aspect_ratio_iter_inner >= aspect_ratio_iter;
             aspect_ratio_iter_inner--)
        {
            
            if (step_info->ar_list[aspect_ratio_iter_inner])
            {
                if (dnx_data_mdb.em.feature_get(unit, dnx_data_mdb_em_step_table_any_cmds_support))
                {
                    
                    step_info->start_pointers[aspect_ratio_iter_inner] = 1 + previous_entry_offset;
                }
                else
                {
                    step_info->start_pointers[aspect_ratio_iter_inner] =
                        step_info->smallest_ar - aspect_ratio_iter_inner + 1 + previous_entry_offset;
                }
            }
        }

        previous_entry_offset = step_info->entry_offset;
    }

    
    for (array_index = 0; array_index < step_info->entry_offset; array_index++)
    {
        dbal_entry_key_field32_set(unit, entry_handle_mdb_step_table, DBAL_FIELD_MDB_KEY_0, array_index);

        dbal_entry_value_field32_set(unit, entry_handle_mdb_step_table, DBAL_FIELD_MDB_ITEM_0, INST_SINGLE,
                                     step_info->step_table[array_index].command);

        dbal_entry_value_field32_set(unit, entry_handle_mdb_step_table, DBAL_FIELD_MDB_ITEM_1, INST_SINGLE,
                                     step_info->step_table[array_index].eot);

        dbal_entry_value_field32_set(unit, entry_handle_mdb_step_table, DBAL_FIELD_MDB_ITEM_2, INST_SINGLE,
                                     step_info->step_table[array_index].success_ptr);

        dbal_entry_value_field32_set(unit, entry_handle_mdb_step_table, DBAL_FIELD_MDB_ITEM_3, INST_SINGLE,
                                     step_info->step_table[array_index].fail_ptr);

        SHR_IF_ERR_EXIT(dbal_entry_commit(unit, entry_handle_mdb_step_table, DBAL_COMMIT));

        SHR_IF_ERR_EXIT(DBAL_HANDLE_CLEAR(unit, step_table, entry_handle_mdb_step_table));
    }

    
    for (start_ptr_index = 0; start_ptr_index < MDB_STEP_TABLE_NOF_ENTRY_SIZES; start_ptr_index++)
    {

        dbal_entry_value_field32_set(unit, entry_handle_mdb_32_table, DBAL_FIELD_MDB_ITEM_0, start_ptr_index,
                                     step_info->start_pointers[start_ptr_index]);

        SHR_IF_ERR_EXIT(dbal_entry_commit(unit, entry_handle_mdb_32_table, DBAL_COMMIT));

        SHR_IF_ERR_EXIT(DBAL_HANDLE_CLEAR(unit, dnx_data_mdb.em.mdb_32_info_get(unit,
                                                                                dbal_physical_table_id)->dbal_table,
                                          entry_handle_mdb_32_table));
    }

exit:
    SHR_FREE(step_info);
    DBAL_FUNC_FREE_VARS;
    SHR_FUNC_EXIT;
}



shr_error_e
mdb_step_table_init(
    int unit)
{
    dbal_physical_tables_e dbal_physical_table_id;
    SHR_FUNC_INIT_VARS(unit);
    for (dbal_physical_table_id = DBAL_PHYSICAL_TABLE_NONE; dbal_physical_table_id < DBAL_NOF_PHYSICAL_TABLES;
         dbal_physical_table_id++)
    {

        if (dnx_data_mdb.pdbs.dbal_pdb_info_get(unit, dbal_physical_table_id)->db_type == DBAL_ENUM_FVAL_MDB_DB_TYPE_EM)
        {
#if defined(BCM_DNX2_SUPPORT)
            if (dnx_data_mdb.feature.feature_get(unit, dnx_data_mdb_feature_step_table_supports_mix_ar_algo)
                && (dbal_physical_table_id != DBAL_PHYSICAL_TABLE_LEM))
            {
                SHR_IF_ERR_EXIT(mdb_step_table_init_single(unit, dbal_physical_table_id));
            }
            else
#endif
            {
                SHR_IF_ERR_EXIT(mdb_step_table_init_mix(unit, dbal_physical_table_id));
            }
        }
    }
exit:
    SHR_FUNC_EXIT;
}
