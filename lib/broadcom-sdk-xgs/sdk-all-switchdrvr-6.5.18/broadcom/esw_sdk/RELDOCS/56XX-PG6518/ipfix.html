<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDK API Guide: IP Flow Information Export Management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_brcm.css" rel="stylesheet" type="text/css"/>
<link href="tabs_brcm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SDK API Guide
   &#160;<span id="projectnumber">Version 6.5.18</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">IP Flow Information Export Management </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The IP Flow Information Export (IPFIX) APIs provide a way to collect packet and byte counts (received and transmitted) for traffic flows in the switch. A flow is identified by matching certain header fields from each packet. Every packet with the same set of header fields is considered part of a given flow.</p>
<p>The APIs can be used to specify the header fields which define a flow. Packet and byte counts for each flow are periodically passed back to the application through a registered callback function.</p>
<p>The following stage definitions are used to indicate whether the specified flow collection occurs on packets received or transmitted.</p>
<p><a class="anchor" id="bcm_ipfix_stage_t"></a></p><a class="anchor" id=""></a>
<table class="doxtable">
<caption>IPFIX Stage</caption>
<tr>
<th>Name </th><th>Purpose  </th></tr>
<tr>
<td>BCM_IPFIX_STAGE_INGRESS </td><td>The IPFIX parameters are for ingress  </td></tr>
<tr>
<td>BCM_IPFIX_STAGE_EGRESS </td><td>The IPFIX parameters are for egress  </td></tr>
</table>
<p>The following structure is used to specify the header fields which define a flow along with flow collection options.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__ipfix__config__s.html">bcm_ipfix_config_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>    <a class="code" href="structbcm__ipfix__config__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;               <span class="comment">/* BCM_IPFIX_CONFIG_* */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a>     <a class="code" href="structbcm__ipfix__config__s.html#ab8712c36775e07b2be19af22ae4c3649">dscp_mask</a>[BCM_IPFIX_DSCP_MASK_COUNT];</div><div class="line">                                   <span class="comment">/* dscp value translation mapping */</span></div><div class="line">    <a class="code" href="group__types.html#gafb45fd06727fa45d83ce6f5e4c328378">bcm_ip_t</a>  <a class="code" href="structbcm__ipfix__config__s.html#a4f1412663673879cc862fee4a768b730">src_ip4_mask</a>;        <span class="comment">/* mask to map ip4 address to key value */</span></div><div class="line">    <a class="code" href="group__types.html#gafb45fd06727fa45d83ce6f5e4c328378">bcm_ip_t</a>  <a class="code" href="structbcm__ipfix__config__s.html#a497b8f99b85e08076ea873ced035851c">dst_ip4_mask</a>;        <span class="comment">/* mask to map ip4 address to key value */</span></div><div class="line">    <a class="code" href="group__types.html#gafb45fd06727fa45d83ce6f5e4c328378">bcm_ip_t</a>  <a class="code" href="structbcm__ipfix__config__s.html#a35bb44faf5079059a7a3e8bd2dae631b">tunnel_src_ip4_mask</a>; <span class="comment">/* mask to map ip4 address to key value */</span></div><div class="line">    <a class="code" href="group__types.html#gafb45fd06727fa45d83ce6f5e4c328378">bcm_ip_t</a>  <a class="code" href="structbcm__ipfix__config__s.html#ad2503ca2bda01c13e93ba81469b83d1c">tunnel_dst_ip4_mask</a>; <span class="comment">/* mask to map ip4 address to key value */</span></div><div class="line">    <a class="code" href="group__types.html#ga40bc5eab76a137a39d5fff98d823094a">bcm_ip6_t</a> <a class="code" href="structbcm__ipfix__config__s.html#aa39b128e297b9966eb49f850e7ca75aa">src_ip6_mask</a>;        <span class="comment">/* mask to map ip6 address to key value */</span></div><div class="line">    <a class="code" href="group__types.html#ga40bc5eab76a137a39d5fff98d823094a">bcm_ip6_t</a> <a class="code" href="structbcm__ipfix__config__s.html#ab6ba65c3602e78565d268b89a412678b">dst_ip6_mask</a>;        <span class="comment">/* mask to map ip6 address to key value */</span></div><div class="line">    <a class="code" href="group__types.html#ga40bc5eab76a137a39d5fff98d823094a">bcm_ip6_t</a> <a class="code" href="structbcm__ipfix__config__s.html#aade8fc55d9725206a79a26c63339827a">tunnel_src_ip6_mask</a>; <span class="comment">/* mask to map ip6 address to key value */</span></div><div class="line">    <a class="code" href="group__types.html#ga40bc5eab76a137a39d5fff98d823094a">bcm_ip6_t</a> <a class="code" href="structbcm__ipfix__config__s.html#ac440846c1d37242e3d2b667ef9e4be59">tunnel_dst_ip6_mask</a>; <span class="comment">/* mask to map ip6 address to key value */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>    <a class="code" href="structbcm__ipfix__config__s.html#a85510bf78e96a9690fe1c567918bc3df">entry_limit</a>;         <span class="comment">/* max number of flow entry collected for</span></div><div class="line"><span class="comment">                                    * the port */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>    <a class="code" href="structbcm__ipfix__config__s.html#a8525917865ac6517f035e5edfd4a4e2d">min_time</a>;            <span class="comment">/* the flow will not be exported unless the</span></div><div class="line"><span class="comment">                                    * flow has been established for more than</span></div><div class="line"><span class="comment">                                    * min_time (unit is 10 ms) */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>    <a class="code" href="structbcm__ipfix__config__s.html#ae23953ff186aee10073d849e49b20810">max_time</a>;            <span class="comment">/* the flow will not be exported unless the</span></div><div class="line"><span class="comment">                                    * flow has been established for less than</span></div><div class="line"><span class="comment">                                    * max_time (unit is 10 ms) */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>    <a class="code" href="structbcm__ipfix__config__s.html#a0b954b02712db574dfe74d2526ca2029">max_idle_time</a>;       <span class="comment">/* the flow will be exported and terminated</span></div><div class="line"><span class="comment">                                    * if idle for more than max_idle_time</span></div><div class="line"><span class="comment">                                    * (unit is 10 ms) */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>    <a class="code" href="structbcm__ipfix__config__s.html#a7e284133f2ca181d5a208a1437ad2f25">sample_rate</a>;         <span class="comment">/* collect one packet info for every</span></div><div class="line"><span class="comment">                                    * sample_rate packets */</span></div><div class="line">} <a class="code" href="group__ipfix.html#ga667a95f74028574de7dcef3497264ff2">bcm_ipfix_config_t</a>;</div></div><!-- fragment --><a class="anchor" id=""></a>
<table class="doxtable">
<caption>IPFIX Configuration Flags</caption>
<tr>
<th>Name </th><th>Purpose  </th></tr>
<tr>
<td>BCM_IPFIX_CONFIG_ENABLE_NON_IP </td><td>Collect information for non-IP packets  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_ENABLE_IP4 </td><td>Collect information for IPv4 packets  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_ENABLE_IP6 </td><td>Collect information for IPv6 packets  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_TCP_END_DETECT </td><td>Export immediately when a TCP FIN or RST is detected  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_RECORD_NON_DISCARD_PKT </td><td>Collect information for non-discarded packets  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_RECORD_DISCARD_PKT </td><td>Collect information for discarded packets  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_IP4_USE_L2 </td><td>Instead of using L3 information, use L2 key information for IPv4 packets  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_IP6_USE_L2 </td><td>Instead of using L3 information, use L2 key information for IPv6 packets  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_SRC_IP </td><td>For IP packets, collect information based on source IP address  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_DST_IP </td><td>For IP packets, collect information based on destination IP address  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_IP_PROT </td><td>For IP packets, collect information based on layer 4 protocol identifier  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_IP_DSCP </td><td>For IP packets, collect information based on differentiated services codepoint (DSCP) value  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_IP_ECN </td><td>For IP packets, collect information based on explicit congestion notification (ECN) value  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_L4_SRC_PORT </td><td>For IP packets, collect information based on layer 4 source port number  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_L4_DST_PORT </td><td>For IP packets, collect information based on layer 4 destination port number  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_IP6_FLOW </td><td>For IPv6 packets, collect information based on flow label  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_ICMP_TYPE </td><td>For ICMP packets, collect information based on ICMP type  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_ICMP_CODE </td><td>For ICMP packets, collect information based on ICMP code  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_MACDA </td><td>For L2 packets, collect information based on destination MAC address  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_MACSA </td><td>For L2 packets, collect information based on source MAC address  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_VLAN_ID </td><td>For L2 packets, collect information based on VLAN identifier  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_VLAN_PRI </td><td>For L2 packets, collect information based on VLAN tag priority  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_ETHER_TYPE </td><td>For L2 packets, collect information based on L3 protocol type  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_VLAN_TAGGED </td><td>For L2 packets, collect information when the packet is VLAN tagged  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_TCP_FLAGS_LAST </td><td>For TCP packets, store the TCP flags of the most recent packet  </td></tr>
<tr>
<td>BCM_IPFIX_CONFIG_KEY_SOURCE_PORT_OR_INTERFACE </td><td>For IP packets, collect information based on source port or interface  </td></tr>
</table>
<p>The following structure is used in the callback function that is registered by the caller. Information about the flow along with the packet/byte counters are passed back in this structure. Only fields relevant for the packet type (L2, IPv4, or IPv6) are populated.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__ipfix__data__s.html">bcm_ipfix_data_s</a> {</div><div class="line">    <a class="code" href="group__ipfix.html#ga2b935d208952396b575b2fa05003df03">bcm_ipfix_stage_t</a> <a class="code" href="structbcm__ipfix__data__s.html#a81b0549e3378f18abdf9f1d0d839eb01">stage</a>;       <span class="comment">/* ingress or egress */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      <a class="code" href="structbcm__ipfix__data__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;             <span class="comment">/* BCM_IPFIX_DATA_* */</span></div><div class="line">    <a class="code" href="group__types.html#gad7e36a8d90f5765e8ca58770666c0860">bcm_port_t</a>  <a class="code" href="structbcm__ipfix__data__s.html#a1ce53999f0a069c5ce2e2716f19178ba">port</a>;</div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a>  <a class="code" href="structbcm__ipfix__data__s.html#ab90165cd927a9ab4ab1e613e95852ade">vlan</a>;              <span class="comment">/* L2: VLAN identifier */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>      <a class="code" href="structbcm__ipfix__data__s.html#a3d922903a7ea2d8fa6aa3e53ac8e9c02">vlan_prio</a>;         <span class="comment">/* L2: VLAN priority */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>      <a class="code" href="structbcm__ipfix__data__s.html#a7ca0d84baf6b360b732417e8b107834a">ether_type</a>;        <span class="comment">/* L2: type in Ethernet II frame or</span></div><div class="line"><span class="comment">                                    * 802.1Q tag */</span></div><div class="line">    <a class="code" href="group__types.html#ga4ccf23ca53e7e7e9a7be38b950aa7943">bcm_mac_t</a>   <a class="code" href="structbcm__ipfix__data__s.html#a55e9da0c9e024f9e7a37633df56a955b">src_mac_addr</a>;      <span class="comment">/* L2: source MAC address */</span></div><div class="line">    <a class="code" href="group__types.html#ga4ccf23ca53e7e7e9a7be38b950aa7943">bcm_mac_t</a>   <a class="code" href="structbcm__ipfix__data__s.html#a6a1d2590c7af1329f5d48f70b7b42ef7">dst_mac_addr</a>;      <span class="comment">/* L2: destination MAC address */</span></div><div class="line">    <a class="code" href="group__types.html#gafb45fd06727fa45d83ce6f5e4c328378">bcm_ip_t</a>    <a class="code" href="structbcm__ipfix__data__s.html#a9d25d888dbf3ac39c20b5c7850ddb8e4">src_ip4_addr</a>;      <span class="comment">/* IP4: source IP address */</span></div><div class="line">    <a class="code" href="group__types.html#gafb45fd06727fa45d83ce6f5e4c328378">bcm_ip_t</a>    <a class="code" href="structbcm__ipfix__data__s.html#addb89070c5bdb68a050fadcf265830af">dst_ip4_addr</a>;      <span class="comment">/* IP4: destination IP address */</span></div><div class="line">    <a class="code" href="group__types.html#ga40bc5eab76a137a39d5fff98d823094a">bcm_ip6_t</a>   <a class="code" href="structbcm__ipfix__data__s.html#ac73996fb15816e3d3375253e8f77135d">src_ip6_addr</a>;      <span class="comment">/* IP6: source IP address */</span></div><div class="line">    <a class="code" href="group__types.html#ga40bc5eab76a137a39d5fff98d823094a">bcm_ip6_t</a>   <a class="code" href="structbcm__ipfix__data__s.html#ab557a9b95599da7a4773ece7ec7e4881">dst_ip6_addr</a>;      <span class="comment">/* IP6: destination IP address */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>      <a class="code" href="structbcm__ipfix__data__s.html#a24ef903b2d6cde2bb227bfb1bf0040c3">ip_protocol</a>;       <span class="comment">/* IP4: protocol, IP6: next header */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>      <a class="code" href="structbcm__ipfix__data__s.html#a34a307d2ab647250a334d5dbb2308b28">tos</a>;               <span class="comment">/* IP4: type of service</span></div><div class="line"><span class="comment">                                    * IP6: traffic class */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      <a class="code" href="structbcm__ipfix__data__s.html#a4b03c9e94479ddb3f7a7d44d35759089">ip6_flow_label</a>;    <span class="comment">/* IP6: flow label */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>      <a class="code" href="structbcm__ipfix__data__s.html#a6d8a107a4717356d8f9db971c2146587">l4_src_port</a>;       <span class="comment">/* first 16 bits of L4 header */</span></div><div class="line">                                   <span class="comment">/* such as TCP source port */</span></div><div class="line">                                   <span class="comment">/* or ICMP type and code */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>      <a class="code" href="structbcm__ipfix__data__s.html#a7baf8f92ce8a6cafc42348cbc8da2cf7">l4_dst_port</a>;       <span class="comment">/* second 16 bits of L4 header */</span></div><div class="line">                                   <span class="comment">/* such as TCP destination port */</span></div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__ipfix__data__s.html#a3d997860c05b4c7b13f2f60296fed5f7">source_port</a>;       <span class="comment">/* source port */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      <a class="code" href="structbcm__ipfix__data__s.html#a900679f9ff2cdb9018c3fb00434e7819">start_timestamp</a>;</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      <a class="code" href="structbcm__ipfix__data__s.html#a0c7521dbeb3eacd616d573f29e4250ea">last_timestamp</a>;</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      <a class="code" href="structbcm__ipfix__data__s.html#a502ddba51496806ff604fd00cbc0b29a">byte_count</a>;</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      <a class="code" href="structbcm__ipfix__data__s.html#af66658e9cae003478d9215700fe8fbc1">pkt_count</a>;</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      <a class="code" href="structbcm__ipfix__data__s.html#a2ad65e1d1c5535cc374b09a5b12926cb">ttl</a>;               <span class="comment">/* TTL value of the first packet. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a>      <a class="code" href="structbcm__ipfix__data__s.html#aac8774125e2444fa475316550faddf97">tcp_flags</a>;         <span class="comment">/* TCP flags. */</span></div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__ipfix__data__s.html#a255c6c44ccef1eafd1b32dea322f6f88">dest_port</a>;         <span class="comment">/* Destination. */</span></div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a>  <a class="code" href="structbcm__ipfix__data__s.html#a0b6fb832e55202d1fc8d636cd82bd1a6">egress_vlan</a>;       <span class="comment">/* Egress VLAN. */</span></div><div class="line">    <a class="code" href="group__types.html#ga0f3f07b8f11cb4e625b0f42d6cc7f94c">bcm_multicast_t</a> <a class="code" href="structbcm__ipfix__data__s.html#a28114750f41b09ce6534c8e77a6c7865">dest_multicast</a>; <span class="comment">/* Destination multicast group. */</span></div><div class="line">} <a class="code" href="group__ipfix.html#gaf477a385d3819345205cbf77135a1c6e">bcm_ipfix_data_t</a>;</div></div><!-- fragment --><a class="anchor" id=""></a>
<table class="doxtable">
<caption>BCM IPFIX Export Data Flags</caption>
<tr>
<th>Name </th><th>Purpose  </th></tr>
<tr>
<td>BCM_IPFIX_DATA_VLAN_TAGGED </td><td>The export data has VLAN tag  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_TYPE_L2 </td><td>The export data is L2 type flow information  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_TYPE_IP4 </td><td>The export data is IPv4 type flow information  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_TYPE_IP6 </td><td>The export data is IPv6 type flow information  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_REASON_FLOW_TIMEOUT </td><td>Flow is exported due to the lifetime of the flow being longer than the specified timeout value  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_REASON_FLOW_END </td><td>Flow is exported because a TCP FIN/RST is detected  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_REASON_FLOW </td><td>Flow is exported to allocate resource for a new entry  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_REASON_COUNT </td><td>Flow is exported due to counter overflow  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_REASON_TIMESTAMP </td><td>Flow is exported due to timestamp overflow  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_RATE_VIOLATION </td><td>The export flow data has ever exceeded the configured flow rate  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_NON_FRAGMENT_PKT_DETECTED </td><td>Flow has one or more non fragment packet  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_FRAGMENT_PKT_DETECTED </td><td>Flow has one or more fragment packet  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_TTL_CHANGED_DETECTED </td><td>At least one packet has different TTL value than rest of the packets in the flow  </td></tr>
<tr>
<td>BCM_IPFIX_DATA_DROP_DETECTED </td><td>Flow has one or more dropped packet  </td></tr>
</table>
<p>The following structure is used to specify the configuration of a flow rate meter.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__ipfix__rate__s.html">bcm_ipfix_rate_s</a> {</div><div class="line">    <a class="code" href="group__types.html#ga3fbf692928d104cf3a3fff01a7dcd6bf">bcm_ipfix_rate_id_t</a> <a class="code" href="structbcm__ipfix__rate__s.html#a7eee386fef4173b9fec67b8bf4eb4b76">rate_id</a>;    <span class="comment">/* Flow rate meter ID. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__ipfix__rate__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;                   <span class="comment">/* Configuration flags. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__ipfix__rate__s.html#ae19373f8138c83a1f557f935099b3063">count</a>;                   <span class="comment">/* Flow count (for get only). */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__ipfix__rate__s.html#a287feaf0bd5dfee5966dad6ad66e69d6">limit</a>;                   <span class="comment">/* Max number of good flows to allow. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__ipfix__rate__s.html#ae79ebefe045af3d6787d3496dc4ab726">rate</a>;                    <span class="comment">/* Number of good flows per second. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__ipfix__rate__s.html#a520aa2d12f714b08b5bc9a17fcfeac1c">dscp</a>;                     <span class="comment">/* New DSCP value. */</span></div><div class="line">    <a class="code" href="group__types.html#ga24111d898bb4ee4a12793dfa40c3a79d">bcm_color_t</a> <a class="code" href="structbcm__ipfix__rate__s.html#aa6237919183657a4dff521eb0076d310">color</a>;              <span class="comment">/* New color value. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__ipfix__rate__s.html#ab57c9d12395f2351f038fd990b92185a">pkt_pri</a>;                    <span class="comment">/* New packet priority. */</span></div><div class="line">    <span class="keywordtype">int</span> <a class="code" href="structbcm__ipfix__rate__s.html#a802cbbe822a00332f210c777da8a0e9a">int_pri</a>;                    <span class="comment">/* New internal priority. */</span></div><div class="line">} <a class="code" href="group__ipfix.html#ga52d57449c1e4d0f3de2c7b8507509549">bcm_ipfix_rate_t</a>;</div></div><!-- fragment --><a class="anchor" id=""></a>
<table class="doxtable">
<caption>IPFIX Flow Rate Meter Flags</caption>
<tr>
<th>Name </th><th>Purpose  </th></tr>
<tr>
<td>BCM_IPFIX_RATE_VIOLATION_WITH_ID </td><td>Used the specified rate_id value  </td></tr>
<tr>
<td>BCM_IPFIX_RATE_VIOLATION_REPLACE </td><td>Replace an existing flow rate meter  </td></tr>
<tr>
<td>BCM_IPFIX_RATE_VIOLATION_DROP </td><td>Drop the packet if it exceeds the specified flow rate  </td></tr>
<tr>
<td>BCM_IPFIX_RATE_VIOLATION_COPY_TO_CPU </td><td>Send the packet to CPU if it exceeds the specified flow rate  </td></tr>
<tr>
<td>BCM_IPFIX_RATE_VIOLATION_DSCP_SET </td><td>Change DSCP value if the packet exceeds the specified flow rate  </td></tr>
<tr>
<td>BCM_IPFIX_RATE_VIOLATION_COLOR_SET </td><td>Change color value if the packet exceeds the specified flow rate  </td></tr>
<tr>
<td>BCM_IPFIX_RATE_VIOLATION_PKT_PRI_SET </td><td>Change packet priority value if the packet exceeds the specified flow rate  </td></tr>
<tr>
<td>BCM_IPFIX_RATE_VIOLATION_INT_PRI_SET </td><td>Change internal priority if the packet exceeds the specified flow rate  </td></tr>
</table>
<p>The following structure is used to specify the configuration whether a packet will be mirrored or not.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__ipfix__mirror__config__s.html">bcm_ipfix_mirror_config_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__ipfix__mirror__config__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;           <span class="comment">/* Configuration flags. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__ipfix__mirror__config__s.html#af66658e9cae003478d9215700fe8fbc1">pkt_count</a>;       <span class="comment">/* Number of packets to be mirrored. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__ipfix__mirror__config__s.html#a46f49363b1a38b60c07159555ff63519">tcp_flags_mask</a>;   <span class="comment">/* TCP flags mask to determine if the packet will be</span></div><div class="line"><span class="comment">                               mirrored. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__ipfix__mirror__config__s.html#af6612603f340bcb87e8f34427e61f325">ttl_offset_max</a>;   <span class="comment">/* Max TTL offset allowance to be mirrored. */</span></div><div class="line">} <a class="code" href="group__ipfix.html#ga8fb6149ad7c65158d9b2b880c4eaaf69">bcm_ipfix_mirror_config_t</a>;</div></div><!-- fragment --><a class="anchor" id=""></a>
<table class="doxtable">
<caption>IPFIX Flow Mirror Flags</caption>
<tr>
<th>Name </th><th>Purpose  </th></tr>
<tr>
<td>BCM_IPFIX_MIRROR_CONFIG_TTL_OFFSET_MAX </td><td>Mirror the packet if the ttl value difference between the packet and the first packet of the flow is larger than the specified value  </td></tr>
<tr>
<td>BCM_IPFIX_MIRROR_CONFIG_FRAGMENT </td><td>Mirror the packet if the IP packet is fragmented  </td></tr>
<tr>
<td>BCM_IPFIX_MIRROR_CONFIG_NON_FRAGMENT </td><td>Mirror the packet if the IP packet is not fragmented  </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__ipfix.html#gae6eee9a52a9f38f603dd5b6cab5fb18e" title="Initialize an IPFIX configuration structure.">bcm_ipfix_config_t_init(bcm_ipfix_config_t* config)</a>  </td><td>Initialize an IPFIX configuration structure.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#gaf03d21a4df50e2a26f94e28d77e42e95" title="Initialize an IPFIX rate configuration structure.">bcm_ipfix_rate_t_init(bcm_ipfix_rate_t* rate)</a>  </td><td>Initialize an IPFIX rate configuration structure.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga12c12bd391355dbb3c8a878789dff7ff" title="Initialize an IPFIX mirror configuration structure.">bcm_ipfix_mirror_config_t_init(bcm_ipfix_mirror_config_t* config)</a>  </td><td>Initialize an IPFIX mirror configuration structure.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga1ff64a15c422ddb79657e2bf85584376" title="Register/Unregister a callback routine for BCM IPFIX export information.">bcm_ipfix_register(int unit, bcm_ipfix_callback_t callback, void* userdata)</a>  </td><td>Register/Unregister a callback routine for BCM IPFIX export information.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga1b65727a738fc78505d887b8f3d02b75" title="Register/Unregister a callback routine for BCM IPFIX export information.">bcm_ipfix_unregister(int unit, bcm_ipfix_callback_t callback, void* userdata)</a>  </td><td>Register/Unregister a callback routine for BCM IPFIX export information.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga8448e9e9f35c33bebfcc2b625ff03d7e" title="Set/Get the IPFIX configuration of the specified port.">bcm_ipfix_config_set(int unit, bcm_ipfix_stage_t stage, bcm_port_t port, bcm_ipfix_config_t* config)</a>  </td><td>Set/Get the IPFIX configuration of the specified port.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga72809f62ac336f7fb50d30421efdc85b" title="Set/Get the IPFIX configuration of the specified port.">bcm_ipfix_config_get(int unit, bcm_ipfix_stage_t stage, bcm_port_t port, bcm_ipfix_config_t* config)</a>  </td><td>Set/Get the IPFIX configuration of the specified port.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#gaa99fef0e1e62c333442a99633269f505" title="Create an IPFIX flow rate meter entry.">bcm_ipfix_rate_create(int unit, bcm_ipfix_rate_t* rate_info)</a>  </td><td>Create an IPFIX flow rate meter entry.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga9ad8470bc2b41423bf4b5b61f6ad4c5a" title="Destroy an IPFIX flow rate meter entry.">bcm_ipfix_rate_destroy(int unit, bcm_ipfix_rate_id_t rate_id)</a>  </td><td>Destroy an IPFIX flow rate meter entry.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga5eacd7465bb00be36e53fad110e3291a" title="Get IPFIX flow rate meter entry for the specified ID.">bcm_ipfix_rate_get(int unit, bcm_ipfix_rate_t* rate_info)</a>  </td><td>Get IPFIX flow rate meter entry for the specified ID.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga02ff145bd40d446baae75f590d4a015d" title="Traverse through IPFIX flow rate meter entries.">bcm_ipfix_rate_traverse(int unit, bcm_ipfix_rate_traverse_cb cb, void* userdata)</a>  </td><td>Traverse through IPFIX flow rate meter entries.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga3b332b301b756dd80979784db1f39f9b" title="Destroy all IPFIX flow rate meter entries.">bcm_ipfix_rate_destroy_all(int unit)</a>  </td><td>Destroy all IPFIX flow rate meter entries.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga83557ed61f7e669f5003f19eeba47612" title="Add a mirror destination to the IPFIX flow rate meter entry.">bcm_ipfix_rate_mirror_add(int unit, bcm_ipfix_rate_id_t rate_id, bcm_gport_t mirror_dest_id)</a>  </td><td>Add a mirror destination to the IPFIX flow rate meter entry.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga0a210696ca4e0e32e0a7bcef061969ff" title="Delete a mirror destination from the IPFIX flow rate meter entry.">bcm_ipfix_rate_mirror_delete(int unit, bcm_ipfix_rate_id_t rate_id, bcm_gport_t mirror_dest_id)</a>  </td><td>Delete a mirror destination from the IPFIX flow rate meter entry.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga4f1a2eef93350247d46166e5277596cd" title="Delete all mirror destination associated with the IPFIX flow rate meter entry.">bcm_ipfix_rate_mirror_delete_all(int unit, bcm_ipfix_rate_id_t rate_id)</a>  </td><td>Delete all mirror destination associated with the IPFIX flow rate meter entry.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga3e370ef3cb85f3fce7d95bb16569201f" title="Get all mirror destination from the IPFIX flow rate meter entry.">bcm_ipfix_rate_mirror_get(int unit, bcm_ipfix_rate_id_t rate_id, int mirror_dest_size, bcm_gport_t* mirror_dest_id, int* mirror_dest_count)</a>  </td><td>Get all mirror destination from the IPFIX flow rate meter entry.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#gae54b561ad968f98ed784dbbe0e416947" title="Set IPFIX mirror control configuration of the specified port.">bcm_ipfix_mirror_config_set(int unit, bcm_ipfix_stage_t stage, bcm_gport_t port, bcm_ipfix_mirror_config_t* config)</a>  </td><td>Set IPFIX mirror control configuration of the specified port.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga9954c78e33084dbeda5ee41d732a1eb8" title="Get IPFIX mirror control configuration of the specified port.">bcm_ipfix_mirror_config_get(int unit, bcm_ipfix_stage_t stage, bcm_gport_t port, bcm_ipfix_mirror_config_t* config)</a>  </td><td>Get IPFIX mirror control configuration of the specified port.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga04df384e0bce954690b64ee031f34e0e" title="Add an IPFIX mirror destination to the specified port.">bcm_ipfix_mirror_port_dest_add(int unit, bcm_ipfix_stage_t stage, bcm_gport_t port, bcm_gport_t mirror_dest_id)</a>  </td><td>Add an IPFIX mirror destination to the specified port.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#gac01ca4055a61c292b658b8e1c64eaba4" title="Delete an IPFIX mirror destination from the specified port.">bcm_ipfix_mirror_port_dest_delete(int unit, bcm_ipfix_stage_t stage, bcm_gport_t port, bcm_gport_t mirror_dest_id)</a>  </td><td>Delete an IPFIX mirror destination from the specified port.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga5292a7e007be06394e5b855f74678ca4" title="Delete all IPFIX mirror destination from the specified port.">bcm_ipfix_mirror_port_dest_delete_all(int unit, bcm_ipfix_stage_t stage, bcm_gport_t port)</a>  </td><td>Delete all IPFIX mirror destination from the specified port.   </td></tr>
<tr>
<td><a class="el" href="group__ipfix.html#ga4acf30898168ade229b60593c1c937c9" title="Get all IPFIX mirror destination of the specified port.">bcm_ipfix_mirror_port_dest_get(int unit, bcm_ipfix_stage_t stage, bcm_gport_t port, int mirror_dest_size, bcm_gport_t* mirror_dest_id, int* mirror_dest_count)</a>  </td><td>Get all IPFIX mirror destination of the specified port   </td></tr>
</table>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="footer-brcm-wrapper">
<table class="footer-brcm">
	<tbody><tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align="left"></td>
		<td class="footer-brcm"><small><b>Proprietary and Confidential &copy; 2019 Broadcom</b></small>
			<div class="footer-brcm">Broadcom Incorporated reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design.
Information furnished by Broadcom Incorporated is believed to be accurate and reliable. However, Broadcom Incorporated does not assume any liability arising
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license
under its patent rights nor the rights of others.
			</div>
		</td>
	</tr>
</tbody></table>
</div>
</body>
</html>
