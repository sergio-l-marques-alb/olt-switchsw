<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDK API Guide: XFLOW MACSEC</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_brcm.css" rel="stylesheet" type="text/css"/>
<link href="tabs_brcm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SDK API Guide
   &#160;<span id="projectnumber">Version 6.5.18</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">XFLOW MACSEC </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="xflow_macsec"></a>
overview Xflow MACsec Overview</h1>
<p>MACsec is an L2 security protocol that is used to authenticate and encrypt Ethernet packets. MACSEC is defined as a link-based protocol in IEEE 802.1AE, meaning that it only runs between two adjacent bridges and can't be switched further, and it encrypts all data packets on that link.</p>
<p>Xflow MACsec is a flow based encryption and decryption design. Unlike the port based MACsec, only a select set of packets (a flow) is redirected to the MACsec engine. The MACsec engine resides outside the IP/EP pipeline. Packets received by the MACsec engine is encrypted or decrypted and re-injected back to the pipeline. This design characteristic resembles a cross point connection between flows in the first pass and second pass. Thus the name Xflow.</p>
<p>All Xflow MACsec API identifiers have prefix bcm_xflow_macsec_.</p>
<p>Xflow MACsec APIs can be classified into the following categories.</p>
<ul>
<li>Secure Channel APIs <a class="el" href="xflow_macsec_top.html#secure_channel">Xflow MACsec Secure Channel</a></li>
<li>Secure Association APIs <a class="el" href="xflow_macsec_top.html#secure_association">Xflow MACsec Secure Association</a></li>
<li>Decrypt Policy APIs <a class="el" href="xflow_macsec_top.html#decrypt_policy">Xflow MACsec Decrypt Policy</a></li>
<li>Decrypt Flow APIs <a class="el" href="xflow_macsec_top.html#decrypt_flow">Xflow MACsec Decrypt Flow</a></li>
<li>Subport APIs <a class="el" href="xflow_macsec_top.html#subport_number">Xflow MACsec Subport number</a></li>
<li>Statistics APIs <a class="el" href="xflow_macsec_top.html#xflow_macsec_stats">Xflow MACsec Statistics</a></li>
<li>Miscellaneous APIs <a class="el" href="xflow_macsec_top.html#miscellaneous">Xflow MACsec Miscellaneous APIs</a></li>
</ul>
<h2>Xflow MACSec basic types</h2>
<p>The Xflow MACSec API layer defines some fundamental data types. The data types used by MACSec software module are defined in <a class="el" href="xflow_macsec_top.html#XREF_XFLOW_MACSEC_DATA_TYPES_v">XREF_XFLOW_MACSEC_DATA_TYPES_v</a></p>
<p><a class="anchor" id="XREF_XFLOW_MACSEC_DATA_TYPES_v"></a></p><a class="anchor" id=""></a>
<table class="doxtable">
<caption>Common Xflow MACSec data types</caption>
<tr>
<th>BCM MACSec data type </th><th>Description  </th></tr>
<tr>
<td>BCM_XFLOW_MACSEC_SECURE_CHAN_ID_CREATE(flag, chan_id) </td><td>Create a secure channel identifier.  </td></tr>
<tr>
<td>BCM_XFLOW_MACSEC_SECURE_ASSOC_ID_CREATE(flag, assoc_id) </td><td>Create a secure association identifier.  </td></tr>
<tr>
<td>BCM_XFLOW_MACSEC_DECRYPT_POLICY_ID_CREATE(id) </td><td>Create a decrypt policy identifier.  </td></tr>
<tr>
<td>BCM_XFLOW_MACSEC_DECRYPT_FLOW_ID_CREATE(id) </td><td>Create a decrypt flow identifier.  </td></tr>
<tr>
<td>bcm_xflow_macsec_crypto_t </td><td>Enums listing the crypto algorithms.  </td></tr>
<tr>
<td>bcm_xflow_macsec_mtu_t </td><td>Enum for MTU selection.  </td></tr>
<tr>
<td>bcm_xflow_macsec_sectag_ethertype_t </td><td>Enum for selecting sectag EtherType.  </td></tr>
<tr>
<td>bcm_xflow_macsec_secure_chan_info_t </td><td>Structure to configure security channel parameters.  </td></tr>
<tr>
<td>bcm_xflow_macsec_secure_chan_id_t </td><td>Identifier representing a security channel.  </td></tr>
<tr>
<td>bcm_xflow_macsec_instance_id_t </td><td>Instance identifier. Ignored for devices with single MACsec instance.  </td></tr>
<tr>
<td>bcm_xflow_macsec_secure_assoc_info_t </td><td>Structure to configure security association parameters.  </td></tr>
<tr>
<td>bcm_xflow_macsec_crypto_aes128_gcm_t </td><td>AES 128 parameters.  </td></tr>
<tr>
<td>bcm_xflow_macsec_crypto_aes256_gcm_t </td><td>AES 256 parameters.  </td></tr>
<tr>
<td>bcm_xflow_macsec_secure_assoc_id_t </td><td>Identifier representing a security association.  </td></tr>
<tr>
<td>bcm_xflow_macsec_secure_assoc_an_control_t </td><td>Enum representing the security association control parameters.  </td></tr>
<tr>
<td>bcm_xflow_macsec_policy_id_t </td><td>Identifier representing a decrypt policy.  </td></tr>
<tr>
<td>bcm_xflow_macsec_decrypt_policy_info_t </td><td>Structure to configure decrypt policy parameters.  </td></tr>
<tr>
<td>bcm_xflow_macsec_flow_id_t </td><td>Identifier representing a decrypt flow.  </td></tr>
<tr>
<td>bcm_xflow_macsec_decrypt_flow_info_t </td><td>Structure to configure decrypt flow parameters.  </td></tr>
<tr>
<td>bcm_xflow_macsec_decrypt_flow_pkt_type_t </td><td>Enum defining the different flow packet types.  </td></tr>
<tr>
<td>bcm_xflow_macsec_decrypt_flow_etype_t </td><td>Enum defining the different flow EtherTypes.  </td></tr>
<tr>
<td>bcm_xflow_macsec_vlan_mpls_tag_status_t </td><td>Enum defining the different vlan and mpls tag types.  </td></tr>
<tr>
<td>bcm_xflow_macsec_id_t </td><td>Generic macsec identifier.  </td></tr>
<tr>
<td>bcm_xflow_macsec_subport_num_t </td><td>Identifier representing a subport number.  </td></tr>
<tr>
<td>bcm_xflow_macsec_control_t </td><td>Control types for MACsec control API.  </td></tr>
<tr>
<td>bcm_xflow_macsec_stat_type_t </td><td>MACsec statistic types.  </td></tr>
<tr>
<td>bcm_xflow_macsec_vlan_tpid_t </td><td>MACsec VLAN TPID.  </td></tr>
<tr>
<td>bcm_xflow_macsec_mac_addr_info_t </td><td>Structure to configure Mac Adress related control parameters.  </td></tr>
</table>
<h1><a class="anchor" id="secure_channel"></a>
Xflow MACsec Secure Channel</h1>
<p>Secure channels are responsible for transmitting and receiving data on MACsec enabled link. The secure channel APIs help create and operate on secure channels.</p>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gacc53d8c92746fcdc0ad9b5f4fb65c1f7" title="bcm_xflow_macsec_secure_chan_create installs a new security channel entry. It returns the secure chan...">bcm_xflow_macsec_secure_chan_create(int unit, uint32 flags, bcm_xflow_macsec_instance_id_t instance_id, bcm_xflow_macsec_secure_chan_info_t* chan_info, int priority, bcm_xflow_macsec_secure_chan_id_t* chan_id)</a>  </td><td>bcm_xflow_macsec_secure_chan_create installs a new security channel entry. It returns the secure channel ID.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gaaef37f3d1c5f4f4ceffed955a430bc26" title="Set MACSec configuration for the specified port.">bcm_xflow_macsec_secure_chan_set(int unit, uint32 flags, bcm_xflow_macsec_secure_chan_id_t chan_id, bcm_xflow_macsec_secure_chan_info_t* chan_info, int priority)</a>  </td><td>Set MACSec configuration for the specified port.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gad9a3954f48a006500df11f8d5df013e5" title="Get the security channel configuration for a given SC index.">bcm_xflow_macsec_secure_chan_get(int unit, bcm_xflow_macsec_secure_chan_id_t chan_id, bcm_xflow_macsec_secure_chan_info_t* chan_info, int* priority)</a>  </td><td>Get the security channel configuration for a given SC index.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga630b9f76940bc1f88be320371cf21083" title="Delete the given security channel. The corresponding SA must be destroyed first.">bcm_xflow_macsec_secure_chan_destroy(int unit, bcm_xflow_macsec_secure_chan_id_t chan_id)</a>  </td><td>Delete the given security channel. The corresponding SA must be destroyed first.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga7fdf87202445ad269b36aa6f055802b0" title="Initialize the secure channel data structure.">bcm_xflow_macsec_secure_chan_info_t_init(bcm_xflow_macsec_secure_chan_info_t* chan_info)</a>  </td><td>Initialize the secure channel data structure.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gac0a12fd2070faba924bd26ebb50739d4" title="Enable the Security Channel.">bcm_xflow_macsec_secure_chan_enable_set(int unit, bcm_xflow_macsec_secure_chan_id_t chan_id, int enable)</a>  </td><td>Enable the Security Channel.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gacd71cb22269cb8de2b468880e35248e8" title="Check if the Security Channel is enabled.">bcm_xflow_macsec_secure_chan_enable_get(int unit, bcm_xflow_macsec_secure_chan_id_t chan_id, int* enable)</a>  </td><td>Check if the Security Channel is enabled.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga28b1cacc2b7e00ceded61ffbee5e9a75" title="Traverse all secure channels.">bcm_xflow_macsec_secure_chan_info_traverse(int unit, uint32 flags, bcm_xflow_macsec_instance_id_t instance_id, bcm_xflow_macsec_chan_traverse_cb callback, void* user_data)</a>  </td><td>Traverse all secure channels.   </td></tr>
</table>
<h1><a class="anchor" id="secure_association"></a>
Xflow MACsec Secure Association</h1>
<p>Secure Associations are identifiers having a different security key negotiated via a key exchange protocol. Each secure channel can have either one or four Secure Association.</p>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gae624d6e45130d3ad4495be6568e4a996" title="bcm_xflow_macsec_secure_assoc_create creates a new Security Association for the given Security Channe...">bcm_xflow_macsec_secure_assoc_create(int unit, uint32 flags, bcm_xflow_macsec_secure_chan_id_t chan_id, bcm_xflow_macsec_secure_assoc_info_t* assoc_info, bcm_xflow_macsec_secure_assoc_id_t* assoc_id)</a>  </td><td>bcm_xflow_macsec_secure_assoc_create creates a new Security Association for the given Security Channel.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga470553f9928e33b8300e57ea68e8c29b" title="Sets/resets the value of any of the parameters of a given Security Association.">bcm_xflow_macsec_secure_assoc_set(int unit, bcm_xflow_macsec_secure_assoc_id_t assoc_id, bcm_xflow_macsec_secure_assoc_info_t* assoc_info)</a>  </td><td>Sets/resets the value of any of the parameters of a given Security Association.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga4014a178310cee0eac1aa15160397440" title="Retrieve the Security Association configuration and the SC index from the SA index.">bcm_xflow_macsec_secure_assoc_get(int unit, bcm_xflow_macsec_secure_assoc_id_t assoc_id, bcm_xflow_macsec_secure_assoc_info_t* assoc_info, bcm_xflow_macsec_secure_chan_id_t* chan_id)</a>  </td><td>Retrieve the Security Association configuration and the SC index from the SA index.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga7ede17a2de3dc5668439e74f011e32a3" title="Deletes the SA entry corresponding to the Security Association.">bcm_xflow_macsec_secure_assoc_destroy(int unit, bcm_xflow_macsec_secure_assoc_id_t assoc_id)</a>  </td><td>Deletes the SA entry corresponding to the Security Association.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gac9e9bd5e3eea2bb6a3f8439f7849f6e7" title="Initialize the Security Association data structure.">bcm_xflow_macsec_secure_assoc_info_t_init(bcm_xflow_macsec_secure_assoc_info_t* assoc_info)</a>  </td><td>Initialize the Security Association data structure.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga617cdf2592f33660efc3a2fa0ccff841" title="Traverse all the secure association belonging to a Secure channel.">bcm_xflow_macsec_secure_assoc_traverse(int unit, bcm_xflow_macsec_secure_chan_id_t chan_id, bcm_xflow_macsec_secure_assoc_traverse_cb callback, void* user_data)</a>  </td><td>Traverse all the secure association belonging to a Secure channel.   </td></tr>
</table>
<h1><a class="anchor" id="decrypt_policy"></a>
Xflow MACsec Decrypt Policy</h1>
<p>Decrypt Policy APIs enable users to take action on packets qualified by a TCAM match. A decrypt policy identifier corresponds to a subport number.</p>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga66dd120c60c34ba459942b380c2df1f9" title="bcm_xflow_macsec_decrypt_policy_create creates a new decrypt policy based on the configured actions....">bcm_xflow_macsec_decrypt_policy_create(int unit, uint32 flags, bcm_xflow_macsec_instance_id_t instance_id, bcm_xflow_macsec_decrypt_policy_info_t* policy_info, bcm_xflow_macsec_policy_id_t* policy_id)</a>  </td><td>bcm_xflow_macsec_decrypt_policy_create creates a new decrypt policy based on the configured actions. A policy identifier is returned.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gaa07acd35c05636d8d9bf590f8cae00cb" title="Set/Replace one of the parameters of an existing decrypt policy configuration.">bcm_xflow_macsec_decrypt_policy_set(int unit, bcm_xflow_macsec_policy_id_t policy_id, bcm_xflow_macsec_decrypt_policy_info_t* policy_info)</a>  </td><td>Set/Replace one of the parameters of an existing decrypt policy configuration.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga2cfadb0d8673c8cc28f0f65e24670c84" title="Get the decrypt policy configuration given the policy_id.">bcm_xflow_macsec_decrypt_policy_get(int unit, bcm_xflow_macsec_policy_id_t policy_id, bcm_xflow_macsec_decrypt_policy_info_t* policy_info)</a>  </td><td>Get the decrypt policy configuration given the policy_id.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga112d20df980c0820f9e5475912776e3f" title="Destroy the decrypt policy configuration given the policy_id.">bcm_xflow_macsec_decrypt_policy_destroy(int unit, bcm_xflow_macsec_policy_id_t policy_id)</a>  </td><td>Destroy the decrypt policy configuration given the policy_id.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga23534bc42613826cf47f207488c779ce" title="Initialize the decrypt policy data structure.">bcm_xflow_macsec_decrypt_policy_info_t_init(bcm_xflow_macsec_decrypt_policy_info_t* policy_info)</a>  </td><td>Initialize the decrypt policy data structure.   </td></tr>
</table>
<h1><a class="anchor" id="decrypt_flow"></a>
Xflow MACsec Decrypt Flow</h1>
<p>Decrypt Flow APIs help create TCAM entries to qualify on various packet parameters. It also helps to associate a policy id with the flow so that appropriate actions are taken when a match occurs.</p>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga135aa8e4c71efbd046901130a9c7aa4d" title="The API bcm_xflow_macsec_decrypt_flow_create creates a flow entry in the decrypt TCAM.">bcm_xflow_macsec_decrypt_flow_create(int unit, uint32 flags, bcm_xflow_macsec_instance_id_t instance_id, bcm_xflow_macsec_decrypt_flow_info_t* flow_info, int priority, bcm_xflow_macsec_flow_id_t* flow_id)</a>  </td><td>The API bcm_xflow_macsec_decrypt_flow_create creates a flow entry in the decrypt TCAM.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga89e356bd7372450216b061e2c318357a" title="Set/Replace one of the parameters in the flow criteria.">bcm_xflow_macsec_decrypt_flow_set(int unit, bcm_xflow_macsec_flow_id_t flow_id, bcm_xflow_macsec_decrypt_flow_info_t* flow_info, int priority)</a>  </td><td>Set/Replace one of the parameters in the flow criteria.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gac3b026b1221d0acfb0ef2f85a7601593" title="Get the flow configuration given a flow index.">bcm_xflow_macsec_decrypt_flow_get(int unit, bcm_xflow_macsec_flow_id_t flow_id, bcm_xflow_macsec_decrypt_flow_info_t* flow_info, int* priority)</a>  </td><td>Get the flow configuration given a flow index.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga801e0aa5659d6b10f5d38dea2b216ce1" title="Delete a flow configuration given a flow index.">bcm_xflow_macsec_decrypt_flow_destroy(int unit, bcm_xflow_macsec_flow_id_t flow_id)</a>  </td><td>Delete a flow configuration given a flow index.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga6df7e4cb04a48ab0fa2d70c86e5aec41" title="Initialize the data structure.">bcm_xflow_macsec_decrypt_flow_info_t_init(bcm_xflow_macsec_decrypt_flow_info_t* flow_info)</a>  </td><td>Initialize the data structure.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gac368d5dae9b82211cd39bd5e450899db" title="Enable a flow given the flow index.">bcm_xflow_macsec_decrypt_flow_enable_set(int unit, bcm_xflow_macsec_flow_id_t flow_id, int enable)</a>  </td><td>Enable a flow given the flow index.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga5b4ce0bcd130840acca9faef81376e68" title="Get the enable status of a decrypt flow.">bcm_xflow_macsec_decrypt_flow_enable_get(int unit, bcm_xflow_macsec_flow_id_t flow_id, int* enable)</a>  </td><td>Get the enable status of a decrypt flow.   </td></tr>
</table>
<h1><a class="anchor" id="subport_number"></a>
Xflow MACsec Subport number</h1>
<p>IFP requires a subport number as input while redirecting packets to MACsec. In encrypt scenario, the secure channel index represents a subport number. In decrypt scenario, the policy index represents a subport number. To simplify the process of deriving subport number, the following API is provided.</p>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gaf41dfba01d186e3e0ea870a7d57ca250" title="The API bcm_xflow_macsec_subport_id_get returns a subport identifier when passed a generic id type.">bcm_xflow_macsec_subport_id_get(int unit, bcm_xflow_macsec_id_t id, bcm_xflow_macsec_subport_id_t* macsec_subport_id)</a>  </td><td>The API bcm_xflow_macsec_subport_id_get returns a subport identifier when passed a generic id type.   </td></tr>
</table>
<h1><a class="anchor" id="xflow_macsec_stats"></a>
Xflow MACsec Statistics</h1>
<p>Xflow MACsec supports a variety of statistics based on MIB definitions. APIs are provided to retrieve and set the statistics. Since different statistics require different input (example some require subport number, some secure channel), the stats APIs take the MACsec generic identifier as an input.</p>
<h2>Xflow MACSec statistics</h2>
<p>The table <a class="el" href="xflow_macsec_top.html#XREF_XFLOW_MACSEC_MIB_TYPES_v">XREF_XFLOW_MACSEC_MIB_TYPES_v</a> lists the various statistics supported along with the input type required. <a class="anchor" id="XREF_XFLOW_MACSEC_MIB_TYPES_v"></a></p><a class="anchor" id=""></a>
<table class="doxtable">
<caption>Common Xflow MACSec Statistics types</caption>
<tr>
<th>BCM MACSec stats type </th><th>Description  </th></tr>
<tr>
<td>bcmXflowMacsecUnctrlPortInOctets </td><td>The number of bytes received. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecUnctrlPortInUcastPkts </td><td>The number of Unicast packets received. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecUnctrlPortInMulticastPkts </td><td>The number of Multicast packets received. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecUnctrlPortInBroadcastPkts </td><td>The number of Broadcast packets received. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecUnctrlPortInDiscards </td><td>The number of dropped packets. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecUnctrlPortOutOctets </td><td>The number of bytes transmitted. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecUnctrlPortOutUcastPkts </td><td>The number of transmitted Unicast packets. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecUnctrlPortOutMulticastPkts </td><td>The number of transmitted Multicast packets. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecUnctrlPortOutBroadcastPkts </td><td>The number of transmitted Broadcast packets. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecUnctrlPortOutErrors </td><td>The number of transmitted packets with errors. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecCtrlPortInOctets </td><td>The sum of all octets of the MSDUs delivered to the user of the Controlled Port by the Secure Frame Verification process, plus the octets of the destination and source MAC addresses. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecCtrlPortInUcastPkts </td><td>Number of Unicast packets delivered to the Controlled Port. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecCtrlPortInMulticastPkts </td><td>Number of Multicast packets delivered to the Controlled Port. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecCtrlPortInBroadcastPkts </td><td>Number of Broadcast packets delivered to the Controlled Port. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecCtrlPortInDiscards </td><td>Sum of all secyStatsRxNoTagPkts, secyStatsRxOverrunPkts, secyRxSCStatsLatePkts. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecCtrlPortInErrors </td><td>Sum of all secyStatsRxBadTagPkts, secyStatsRxNoSCIPkts, secyRxSCStatsNotUsingSAPkts, secyRxSCStatsNotValidPkts. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecCtrlPortOutOctets </td><td>Sum of all octets of the MSDUs delivered by the user of the Controlled Port to the Secure Frame Generation process, plus the octets of the destination and source MAC addresses. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecCtrlPortOutUcastPkts </td><td>Number of Unicast packets sent to the Secure Frame Generation process. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecCtrlPortOutMulticastPkts </td><td>Number of Multicast packets sent to the Secure Frame Generation process. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecCtrlPortOutBroadcastPkts </td><td>Number of Broadcast packets sent to the Secure Frame Generation process. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecCtrlPortOutErrors </td><td>Equal to the secyStatsTxTooLongPkts count. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyStatsTxUntaggedPkts </td><td>The number of transmitted packets without the MAC security tag because secy ProtectFrames is configured as false. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyStatsTxTooLongPkts </td><td>The number of transmitted packets discarded because the packet length is greater than the interface MTU of the Common Port. This is a per subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyStatsRxUntaggedPkts </td><td>Per macsec subport. The number of received packets without the MAC security tag with secyValidateFrames which is not in the strict mode.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyStatsRxNoTagPkts </td><td>Per macsec subport. The number of received packets discarded without the MAC security tag with secyValidateFrames which is in the strict mode.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyStatsRxBadTagPkts </td><td>Per macsec subport. The number of received packets discarded with an invalid SecTAG or zero value PN or an invalid ICV.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyStatsRxUnknownSCIPkts </td><td>Per macsec subport. The number of received packets with unknown SCI with the condition : secyValidateFrames is not in the strict mode and the C bit in the SecTAG is not set.   </td></tr>
<tr>
<td>bcmXflowMacsecSecyStatsRxNoSCIPkts </td><td>Per macsec subport. The number of received packets discarded with unknown SCI information with the condition : secyValidateFrames is in the strict mode or the C bit in the SecTAG is set.   </td></tr>
<tr>
<td>bcmXflowMacsecSecyStatsRxOverrunPkts </td><td>Per subport. The number of packets discarded because the number of received packets exceeded the cryptographic performance capabilities.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyTxSCStatsProtectedPkts </td><td>Per Secure Channel. The number of integrity protected but not encrypted packets for a transmitting Secure Channel.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyTxSCStatsEncryptedPkts </td><td>Per Secure Channel. The number of integrity protected and encrypted packets for a transmitting Secure Channel.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyTxSCStatsOctetsProtected </td><td>Per Secure Channel. The number of plain text octets that are integrity protected but not encrypted on the transmitting Secure Channel.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyTxSCStatsOctetsEncrypted </td><td>Per Secure Channel. The number of plain text octets that are integrity protected and encrypted on the transmitting Secure Channel.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSCStatsUnusedSAPkts </td><td>Per Secure Channel. The summation of counter secyRxSAStatsUnusedSAPkts for all the Security Associations belonging to a Secure Channel.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSCStatsNotUsingSAPkts </td><td>Per Secure Channel. The summation of counter secyRxSAStatsNotUsingSAPkts for all Security Associations belonging to a Secure Channel.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSCStatsLatePkts </td><td>Per Secure Channel. The number of packets discarded due to a PN that is lower than the lower bound replay check PN when replay protection is enabled.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSCStatsNotValidPkts </td><td>Per Secure Channel. The summation of counter secyRxSAStatsNotValidPkts for all the SAs belonging to an Secure Channel.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSCStatsInvalidPkts </td><td>Per Secure Channel. The summation of secyRxSAStatsInvalidPkts for all Security Associations belonging to a Secure Channel.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSCStatsDelayedPkts </td><td>Per Secure Channel. The number of packets received with a Packet Number that is lower than the lower bound replay protection Packet Number.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSCStatsUncheckedPkts </td><td>Per Secure Channel. The number of packets received with the following condition : 1) ValidateFrames is disabled 2) ValidateFrames not disabled and packet not encrypted and failed integrity check. 3) ValidateFrames not disabled and packet is encrypted and failed integrity check.   </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSCStatsOKPkts </td><td>Per Secure Channel. The summation of secyRxSAStatsOKPkts for all Security Associations belonging to a Secure Channel.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSCStatsOctetsValidated </td><td>Per Secure Channel. The number of octets of plaintext recovered from received packets that were integrity protected but not encrypted.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSCStatsOctetsDecrypted </td><td>Per Secure Channel. The number of octets of plaintext recovered from the received packets that were integrity protected and encrypted.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyTxSAStatsProtectedPkts </td><td>Per Security Association. The number of integrity protected but not encrypted packets for a transmitting Security Association.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyTxSAStatsEncryptedPkts </td><td>Per Security Association. The number of integrity protected and encrypted packets for a transmitting Security Association.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSAStatsUnusedSAPkts </td><td>For the Security Association that is not currently in use, counts the number of received, unencrypted packets with ValidateFrames not in strict mode.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSAStatsNotUsingSAPkts </td><td>For the Security Association that is not currently used, counts the number of received packets that have been discarded, and have either the packet encrypted or the ValidateFrames set to strict mode.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSAStatsNotValidPkts </td><td>The number of discarded packets with the condition that the packets are not valid and one of the following conditions are true: 1) ValidateFrames in strict mode 2) packets are encrypted   </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSAStatsInvalidPkts </td><td>The number of packets with the condition that the packets are not valid and ValidateFrames is in check mode.  </td></tr>
<tr>
<td>bcmXflowMacsecSecyRxSAStatsOKPkts </td><td>The number of validated packets.  </td></tr>
<tr>
<td>bcmXflowMacsecInMgmtPkts </td><td>The number of Management Packets received by the Sub-port. It?s a per macsec subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecFlowTcamHitCntr </td><td>The Ingress Flow TCAM hit counter per entry. It will increment when a TCAM rule is hit.  </td></tr>
<tr>
<td>bcmXflowMacsecFlowTcamMissCntr </td><td>The Ingress Flow TCAM miss counter. It will increment when no TCAM rule is hit. There is only one counter per TCAM.  </td></tr>
<tr>
<td>bcmXflowMacsecScTcamHitCntr </td><td>The Ingress Secure Channel TCAM hit counter per entry. It will increment when a TCAM rule is hit.  </td></tr>
<tr>
<td>bcmXflowMacsecScTcamMissCntr </td><td>The Ingress Secure Channel TCAM hit counter. It will increment when no TCAM rule is hit. There is only one counter per TCAM.  </td></tr>
<tr>
<td>bcmXflowMacsecOutMgmtPkts </td><td>The number of Management Packets transmitted by the macsec sub-port. It?s a per macsec subport counter.  </td></tr>
<tr>
<td>bcmXflowMacsecInPacketDropCntr </td><td>The total number of packets dropped by ISEC for any reasons. It will increment when a drop event occurs.  </td></tr>
<tr>
<td>bcmXflowMacsecOutPacketDropCntr </td><td>The total number of packets dropped by ESEC for any reasons. It will increment when a drop event occurs.  </td></tr>
<tr>
<td>bcmXflowMacsecBadOlpHdrCntr </td><td>The total number of packets dropped due to the invalid OLP signature.  </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga5c367a74850b6111fe07feda144ad953" title="The API bcm_xflow_macsec_stat_get gets the counter value corresponding to the generic id and stat_typ...">bcm_xflow_macsec_stat_get(int unit, uint32 flags, bcm_xflow_macsec_id_t id, bcm_xflow_macsec_stat_type_t  stat_type, uint64* value)</a>  </td><td>The API bcm_xflow_macsec_stat_get gets the counter value corresponding to the generic id and stat_type provided.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga8895914896997f872a077597fe0caf19" title="The API bcm_xflow_macsec_stat_set sets the counter value corresponding to the generic id and stat_typ...">bcm_xflow_macsec_stat_set(int unit, uint32 flags, bcm_xflow_macsec_id_t id, bcm_xflow_macsec_stat_type_t  stat_type, uint64 value)</a>  </td><td>The API bcm_xflow_macsec_stat_set sets the counter value corresponding to the generic id and stat_type provided.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga9a1af3a574da8be8090d3c85944151b4" title="The API bcm_xflow_macsec_stat_multi_get gets an array of counter values.">bcm_xflow_macsec_stat_multi_get(int unit, uint32 flags, bcm_xflow_macsec_id_t id, uint32 num_stats, bcm_xflow_macsec_stat_type_t * stat_type_array, uint64* value_array)</a>  </td><td>The API bcm_xflow_macsec_stat_multi_get gets an array of counter values.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gad7baf168589d62ab42c164c76fe86ee8" title="The API bcm_xflow_macsec_stat_multi_set gets an array of counter values.">bcm_xflow_macsec_stat_multi_set(int unit, uint32 flags, bcm_xflow_macsec_id_t id, uint32 num_stats, bcm_xflow_macsec_stat_type_t * stat_type_array, uint64* value_array)</a>  </td><td>The API bcm_xflow_macsec_stat_multi_set gets an array of counter values.   </td></tr>
</table>
<h1><a class="anchor" id="miscellaneous"></a>
Xflow MACsec Miscellaneous APIs</h1>
<p>Xflow MACsec provides APIs to program various other parameters such as MACsec TPID and VLAN, EtherType, MTU etc. These APIs are defined as follows</p>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga2920a6e048b99dcb10091b9c6013d330" title="The API bcm_xflow_macsec_vlan_tpid_array_set sets the four VLAN TPID for decrypt flow.">bcm_xflow_macsec_vlan_tpid_array_set(int unit, bcm_xflow_macsec_instance_id_t instance_id, bcm_xflow_macsec_vlan_tpid_t* vlan_tpid)</a>  </td><td>The API bcm_xflow_macsec_vlan_tpid_array_set sets the four VLAN TPID for decrypt flow.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gaea2bd29803ee54bff3a144213056f108" title="The API bcm_xflow_macsec_vlan_tpid_array_get gets the four VLAN TPID for decrypt flow.">bcm_xflow_macsec_vlan_tpid_array_get(int unit, bcm_xflow_macsec_instance_id_t instance_id, bcm_xflow_macsec_vlan_tpid_t* vlan_tpid)</a>  </td><td>The API bcm_xflow_macsec_vlan_tpid_array_get gets the four VLAN TPID for decrypt flow.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga0a147130a56aa469a79e78b07f8a0ec3" title="The API bcm_xflow_macsec_vlan_tpid_array_index_get retrieves the index corresponding to a TPID value.">bcm_xflow_macsec_vlan_tpid_array_index_get(int unit, bcm_xflow_macsec_instance_id_t instance_id, uint32 vlan_tpid, uint8* tpid_index_sel)</a>  </td><td>The API bcm_xflow_macsec_vlan_tpid_array_index_get retrieves the index corresponding to a TPID value.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga7f92da1e26820bb76689af7bf099f1f2" title="The API bcm_xflow_macsec_mtu_set sets the MTU for encrypt or decrypt flow.">bcm_xflow_macsec_mtu_set(int unit, int flags, bcm_xflow_macsec_instance_id_t instance_id, uint32 mtu, bcm_xflow_macsec_mtu_t* mtu_sel)</a>  </td><td>The API bcm_xflow_macsec_mtu_set sets the MTU for encrypt or decrypt flow.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gad740b6b2e3695ccbdac443dec3770d6c" title="The API bcm_xflow_macsec_mtu_get gets the MTU for encrypt or decrypt flow.">bcm_xflow_macsec_mtu_get(int unit, int flags, bcm_xflow_macsec_instance_id_t instance_id, bcm_xflow_macsec_mtu_t mtu_sel, uint32* mtu)</a>  </td><td>The API bcm_xflow_macsec_mtu_get gets the MTU for encrypt or decrypt flow.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gab12e8cc8840427cf5d15dee6d70a347b" title="The API bcm_xflow_macsec_sectag_etype_set sets the sectag EtherType for encrypt and decrypt flow.">bcm_xflow_macsec_sectag_etype_set(int unit, int flags, bcm_xflow_macsec_instance_id_t instance_id, uint32 sectag_etype, bcm_xflow_macsec_sectag_ethertype_t* sectag_etype_sel)</a>  </td><td>The API bcm_xflow_macsec_sectag_etype_set sets the sectag EtherType for encrypt and decrypt flow.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga6cdc67d21b2057bbdc0f99c24c5643f2" title="The API bcm_xflow_macsec_sectag_etype_get gets the sectag EtherType for encrypt and decrypt flow.">bcm_xflow_macsec_sectag_etype_get(int unit, bcm_xflow_macsec_instance_id_t instance_id, bcm_xflow_macsec_sectag_ethertype_t sectag_etype_sel, uint32* sectag_etype)</a>  </td><td>The API bcm_xflow_macsec_sectag_etype_get gets the sectag EtherType for encrypt and decrypt flow.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga65b2b99d2dedcbecaa1800bf4821b437" title="bcm_xflow_macsec_control_set sets the value in HW for the macsec control type provided.">bcm_xflow_macsec_control_set(int unit, uint32 flags, bcm_xflow_macsec_instance_id_t instance_id, bcm_xflow_macsec_control_t type, uint64 value)</a>  </td><td>bcm_xflow_macsec_control_set sets the value in HW for the macsec control type provided.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#ga835b8e822a93508b285d4f50c9e9f9b4" title="bcm_xflow_macsec_control_get sets the value in HW for the macsec control type provided.">bcm_xflow_macsec_control_get(int unit, uint32 flags, bcm_xflow_macsec_instance_id_t instance_id, bcm_xflow_macsec_control_t type, uint64* value)</a>  </td><td>bcm_xflow_macsec_control_get sets the value in HW for the macsec control type provided.   </td></tr>
<tr>
<td>bcm_common_xflow_macsec_port_info_set()  </td><td>The API bcm_common_xflow_macsec_port_info_set sets the MACSEC info on a given port   </td></tr>
<tr>
<td>bcm_common_xflow_macsec_port_info_get()  </td><td>The API bcm_common_xflow_macsec_port_info_get gets the MACSEC info on a given port   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gac95b66cffaf64b8b37de575c09e5541e" title="bcm_xflow_macsec_mac_addr_control_set sets the value in HW for the macsec control type provided.">bcm_xflow_macsec_mac_addr_control_set(int unit, uint32 flags, bcm_xflow_macsec_instance_id_t instance_id, bcm_xflow_macsec_mac_addr_control_t control_type, bcm_xflow_macsec_mac_addr_info_t* control_info)</a>  </td><td>bcm_xflow_macsec_mac_addr_control_set sets the value in HW for the macsec control type provided.   </td></tr>
<tr>
<td><a class="el" href="group__xflow__macsec.html#gac33dedb9b2266dbec2702ef583e8284e" title="bcm_xflow_macsec_mac_addr_control_get gets the value from HW for the macsec control type provided.">bcm_xflow_macsec_mac_addr_control_get(int unit, uint32 flags, bcm_xflow_macsec_instance_id_t instance_id, bcm_xflow_macsec_mac_addr_control_t control_type, bcm_xflow_macsec_mac_addr_info_t* control_info)</a>  </td><td>bcm_xflow_macsec_mac_addr_control_get gets the value from HW for the macsec control type provided.   </td></tr>
</table>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="footer-brcm-wrapper">
<table class="footer-brcm">
	<tbody><tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align="left"></td>
		<td class="footer-brcm"><small><b>Proprietary and Confidential &copy; 2019 Broadcom</b></small>
			<div class="footer-brcm">Broadcom Incorporated reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design.
Information furnished by Broadcom Incorporated is believed to be accurate and reliable. However, Broadcom Incorporated does not assume any liability arising
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license
under its patent rights nor the rights of others.
			</div>
		</td>
	</tr>
</tbody></table>
</div>
</body>
</html>
