<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDK API Guide: Subport Configuration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_brcm.css" rel="stylesheet" type="text/css"/>
<link href="tabs_brcm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SDK API Guide
   &#160;<span id="projectnumber">Version 6.5.18</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Subport Configuration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The following section describes the subport APIs.</p>
<h1><a class="anchor" id="subport_overview"></a>
Subport Overview</h1>
<p>The subport feature allows the 16-bit 802.1Q "Tag Control Information" field of an Ethernet frame to be used as a "virtual-port" (or subport) identifier. Ethernet frames that arrive with a specific 16-bit VLAN tag value are associated with a subport. Similarly, frames that are sent to a subport are sent with the specific 16-bit VLAN tag value in the header. Within the switch, traffic from each subport is assigned to a fixed internal priority (discussed in more detail below).</p>
<p>Subports are grouped together in a subport group, which specifies the physical port and VLAN. Up to eight subports can be added to a group (one for each of the available internal priorities).</p>
<p>The L2 table lookup for packets arriving on a subport is based on the packet's DMAC along with the VLAN of the subport group. If hardware L2 learning is enabled, L2 entries are learned with the packet's SMAC and VLAN of the subport group. The unicast L2 entries point to the subport group.</p>
<p>For traffic arriving on a regular (non-subport) port getting switched out a subport, the L2 lookup result gives the subport group. A subport within the group is chosen based on the internal priority of the packet.</p>
<p>If an L2 destination lookup fails, the packet is flooded on the physical ports on the VLAN, but not on the subports. If flooding to subports is required, the field processor can be used to identify such packets and direct them to a multicast group that contains one or more subports. L2 multicast addresses can be added to the L2 table which direct traffic to a multicast group, which may contain one or more subports.</p>
<h2><a class="anchor" id="linkphy_subport_overview"></a>
LinkPHY Subport Overview</h2>
<p>Subport feature is also used to configure LinkPHY subports on ESW chips that support LinkPHY (ex: BCM5645x). LinkPHY is an interconnect standard that enables support for channelization over Ethernet. A channelized interface refers to supporting multiple channels over a single physical port. The LinkPHY interface fragments the Ethernet frames. The fragments do not exceed a configured maximum length. Each fragment is encapsulated with a header and FCS. The header identifies the stream and carries tag control information (which supports a 10-bit stream ID).</p>
<p>More than one logical LinkPHY subport group can be configured on a physical Ethernet port. However, they share the same LinkPHY properties of the physical port. Each LinkPHY configured port need to program a base stream ID which is a multiple of 8 and in the range 0 to 896. The valid stream ID range for a LinkPHY port is {N, N+127} where N is the base stream ID for the port. LinkPHY subports are added under a LinkPHY subport group.</p>
<p>A LinkPHY subport is represented by an array of "10-bit stream IDs". Depending on the application, a single stream ID can be mapped to a LinkPHY subport or more than one stream IDs can be mapped to a LinkPHY subport. BCM5645x supports maximum 2 stream IDs per LinkPHY subport.</p>
<h2><a class="anchor" id="third_vlan_tag_subport_overview"></a>
SubTag Subport Overview</h2>
<p>Subport feature is also used to configure SubTag subports on ESW chips (on supported devices like BCM5645x). A third VLAN tag (16-bit) or SubTag is added to the Ethernet frame header which is used as a "virtual-port" (or subport) identifier.</p>
<p>More than one logical SubTag subport group can be configured on a physical Ethernet port. SubTag subports are added under a SubTag subport group.</p>
<h1><a class="anchor" id="subport_apis"></a>
Subport APIs</h1>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="group__subport.html#ga16028f0ca388cbf240fff1f64d4237b4" title="Initialize a subport group config structure.">bcm_subport_group_config_t_init(bcm_subport_group_config_t* config)</a>  </td><td>Initialize a subport group config structure.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga9e90be54664d638043c8a6f9b1019cc5" title="Initialize a subport config structure.">bcm_subport_config_t_init(bcm_subport_config_t* config)</a>  </td><td>Initialize a subport config structure.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga86332851ed70c136e42d114f40ebb65d" title="Initialize/Cleanup the subport subsystem.">bcm_subport_init(int unit)</a>  </td><td>Initialize/Cleanup the subport subsystem.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga5611824c297e113844bf2ea9e2611fbd" title="Initialize/Cleanup the subport subsystem.">bcm_subport_cleanup(int unit)</a>  </td><td>Initialize/Cleanup the subport subsystem.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#gaa7a88d553aca5b02a3020decf47111fc" title="Create a subport group.">bcm_subport_group_create(int unit, bcm_subport_group_config_t* config, bcm_gport_t* group)</a>  </td><td>Create a subport group.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga80ab5a452b7f0bae4cb58ea9c89523eb" title="Destroy a subport group and all the subports that are part of the group.">bcm_subport_group_destroy(int unit, bcm_gport_t group)</a>  </td><td>Destroy a subport group and all the subports that are part of the group.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga0ef8c6f2ba600f7ae43e444be24162f3" title="Get a subport group.">bcm_subport_group_get(int unit, bcm_gport_t group, bcm_subport_group_config_t* config)</a>  </td><td>Get a subport group.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga76f461bdfb02468f1be74f15369ad60e" title="Add a subport to a subport group.">bcm_subport_port_add(int unit, bcm_subport_config_t* config, bcm_gport_t* port)</a>  </td><td>Add a subport to a subport group.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga3d3c28850a36bb6f37e4fac37bdceb3c" title="Delete a subport.">bcm_subport_port_delete(int unit, bcm_gport_t port)</a>  </td><td>Delete a subport.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga49437a6e439d18f074bad31441fcb839" title="Get the subport configuration for the given gport identifier.">bcm_subport_port_get(int unit, bcm_gport_t port, bcm_subport_config_t* config)</a>  </td><td>Get the subport configuration for the given gport identifier.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga51197aaa0578dfe2dc4820a3ad2a1f99" title="Traverse the existing subports and call the user-supplied callback function for each one.">bcm_subport_port_traverse(int unit, bcm_subport_port_traverse_cb cb, void* user_data)</a>  </td><td>Traverse the existing subports and call the user-supplied callback function for each one.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga47463bc4b9cfd856ff6e2b7c6c0d2861" title="Traverse the existing subports under a given subport group and call the user-supplied callback functi...">bcm_subport_group_traverse(int unit, bcm_gport_t subport_group, bcm_subport_port_traverse_cb cb, void* user_data)</a>  </td><td>Traverse the existing subports under a given subport group and call the user-supplied callback function for each one.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#gabd9c9ec8fc0b9103f9d31742b975f777" title="Initialize a LinkPHY port config structure.">bcm_subport_group_linkphy_config_t_init(bcm_subport_group_linkphy_config_t* linkphy_config)</a>  </td><td>Initialize a LinkPHY port config structure.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga1ec552e35e153eda168b67d98d669599" title="Set LinkPHY configuration parameters for a given port.">bcm_subport_group_linkphy_config_set(int unit, bcm_gport_t port, bcm_subport_group_linkphy_config_t* linkphy_config)</a>  </td><td>Set LinkPHY configuration parameters for a given port.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#gabb6f3870daa781e9bfde069c64b011f6" title="Get LinkPHY configuration parameters for a given port.">bcm_subport_group_linkphy_config_get(int unit, bcm_gport_t port, bcm_subport_group_linkphy_config_t* linkphy_config)</a>  </td><td>Get LinkPHY configuration parameters for a given port.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga594a2bbf8282477dd2ad464bf0c16507" title="Set the statistics value for a given subport and statistics type.">bcm_subport_port_stat_set(int unit, bcm_gport_t port, int stream_id, bcm_subport_stat_t stat_type, uint64 val)</a>  </td><td>Set the statistics value for a given subport and statistics type.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga637bef31aff4c373734508a6b02cc941" title="Get the statistics value for a given subport and statistics type.">bcm_subport_port_stat_get(int unit, bcm_gport_t port, int stream_id, bcm_subport_stat_t stat_type, uint64* val)</a>  </td><td>Get the statistics value for a given subport and statistics type.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga1ee6abcf146563ebd42e56eb0f61d6c2" title="Register a callback function for a Linkphy RX error.">bcm_subport_linkphy_rx_error_register(int unit, bcm_subport_linkphy_rx_errors_t errors, bcm_subport_linkphy_rx_error_reg_info_t* reg_info, void* user_data)</a>  </td><td>Register a callback function for a Linkphy RX error.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#ga028315c9e10076e4b7119b8a34b91977" title="De-Register a callback function for a Linkphy RX error.">bcm_subport_linkphy_rx_error_unregister(int unit, bcm_subport_linkphy_rx_errors_t errors)</a>  </td><td>De-Register a callback function for a Linkphy RX error.   </td></tr>
<tr>
<td><a class="el" href="group__subport.html#gaaac2a28d8d1c8a20c408163f1b35ebae" title="Given a subport gport, returns the corresponding module and port associated with that subport....">bcm_subport_gport_modport_get(int unit, bcm_gport_t subport_gport, bcm_module_t* module, bcm_port_t* port)</a>  </td><td>Given a subport gport, returns the corresponding module and port associated with that subport. This is only applicable on devices BCM5645x, BCM5626x, BCM5646x, BCM5686x, BCM5656x and BCM5676x that support CoE applications like Subtag and LinkPhy.   </td></tr>
</table>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="footer-brcm-wrapper">
<table class="footer-brcm">
	<tbody><tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align="left"></td>
		<td class="footer-brcm"><small><b>Proprietary and Confidential &copy; 2019 Broadcom</b></small>
			<div class="footer-brcm">Broadcom Incorporated reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design.
Information furnished by Broadcom Incorporated is believed to be accurate and reliable. However, Broadcom Incorporated does not assume any liability arising
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license
under its patent rights nor the rights of others.
			</div>
		</td>
	</tr>
</tbody></table>
</div>
</body>
</html>
