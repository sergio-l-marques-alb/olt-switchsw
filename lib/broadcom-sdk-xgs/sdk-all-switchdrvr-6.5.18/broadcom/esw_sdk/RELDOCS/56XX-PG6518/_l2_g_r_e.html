<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SDK API Guide: L2GRE Management</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_brcm.css" rel="stylesheet" type="text/css"/>
<link href="tabs_brcm.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SDK API Guide
   &#160;<span id="projectnumber">Version 6.5.18</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">L2GRE Management </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>BCM56640 provides L2GRE functionality. BCM L2GRE APIs allow application developers to manage BROADCOM L2GRE features.</p>
<h1><a class="anchor" id="l2gre_overview"></a>
L2GRE Overview</h1>
<p>L2GRE is a L2 VPN technology targeted for Data-Center communication between Virtual Machines (VM) assigned to the same customer(Tenant) that are distributed in various racks in the Data-Center. L2VPN over IP/GRE tunnels can provide E-LAN (similar to VPLS) service. With L2GRE the Ethernet packets are encapsulated in GRE tunnels over an IP network. L2GRE uses GRE.KEY as multiplexing field for multiplexing multiple VPNs into the same GRE Tunnel.</p>
<p>In E-LAN, Ethernet frames of interest are also identified by incoming port plus packet header information. Ethernet frames are switched into one or more L2GRE Tunnels based on the MAC DA lookup. At the end of Tunnel, forwarding of Ethernet frames after Tunnel decapsulation is based on the GRE-VPNID and Tunnel lookup and frames are again forwarded based on MAC-DA lookup.</p>
<p>L2GRE VPN can be of type ELAN.</p>
<p>For ELAN, a VPN is similar to a VLAN, which identifies a group of physical ports to be included in a broadcast domain. However, instead of physical ports, a ELAN VPN identifies a group of "virtual-ports" to be included in a broadcast domain. In the L2GRE APIs, a "virtual-port" is called an L2GRE port (see description below). The VPN ID is used to qualify MAC DA lookups within the VPN.</p>
<p>E-LINE service is not supported by L2GRE. E-LINE service API for L2GRE is deprecated.</p>
<h1><a class="anchor" id="l2gre_data_types"></a>
L2GRE Data Types</h1>
<ul>
<li>bcm_vpn_t is the ID that uniquely identifies Layer-2 VPN instance. bcm_vpn_t is defined as bcm_vlan_t so it can be used in APIs with bcm_vlan_t parameters (for example, bcm_l2_addr_add can be used to add ELAN L2 entries using a ELAN bcm_vpn_t value). BCM_L2GRE_VPN_INVALID specifies an Invalid VPN Instance. The VPN type can be ELAN (point-to-multipoint L2 VPN). A VPN is assigned a unique ID which is returned in the vpn field. For ELAN VPNs, the multicast group(s) for broadcast and unknown unicast/multicast must first be created using the bcm_multicast_* APIs. VXLAN VPN can be associated with a Service vpnid field during VPN creation(with flag=BCM_VXLAN_VPN_WITH_VPNID).</li>
</ul>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>L2GRE VPN flags</caption>
<tr>
<td>BCM_L2GRE_VPN_ELINE </td><td>Deprecated, not supported  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_ELAN </td><td>Create ELAN VPN  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_WITH_ID </td><td>Create VPN with specified ID  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_WITH_VPNID </td><td>Create VPN with specified ServiceID  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_SERVICE_TAGGED </td><td>Create VPN with Service Tag mode  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_SERVICE_VLAN_ADD </td><td>Create VPN to Add SD-TAG Vlan  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_SERVICE_VLAN_REPLACE </td><td>Create VPN to Replace SD-TAG Vlan not TPID  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_SERVICE_VLAN_DELETE </td><td>Create VPN to Delete SD-TAG Vlan  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_SERVICE_VLAN_TPID_REPLACE </td><td>Create VPN to Replace Vlan and TPID  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_SERVICE_VLAN_PRI_TPID_REPLACE </td><td>Create VPN to replace Vlan, Vlan-Pri and TPID  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_SERVICE_VLAN_PRI_REPLACE </td><td>Create VPN to replace Vlan and Vlan-Pri  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_SERVICE_PRI_REPLACE </td><td>Create VPN to replave Vlan-Pri  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_SERVICE_TPID_REPLACE </td><td>Create VPN to replace TPID  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_REPLACE </td><td>Replace attributes of an existed VPN  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_UNKNOWN_UCAST_REPLACE </td><td>Replace unknown unicast mc-group of an existed VPN  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_UNKNOWN_MCAST_REPLACE </td><td>Replace unknown multicast mc-group of an existed VPN  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_BCAST_REPLACE </td><td>Replace broadcast mc-group of an existed VPN  </td></tr>
<tr>
<td>BCM_L2GRE_VPN_INVALID </td><td>Invalid L2GRE VPN  </td></tr>
</table>
<ul>
<li>bcm_l2gre_vpn_config_t structure can be used for configuring L2GRE vpn.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__l2gre__vpn__config__s.html">bcm_l2gre_vpn_config_s</a> {</div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__l2gre__vpn__config__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;                       <span class="comment">/* BCM_L2GRE_VPN_xxx. */</span></div><div class="line">    <a class="code" href="group__types.html#gad0476041b742ee817043d5d0c99fc2ac">bcm_vpn_t</a> <a class="code" href="structbcm__l2gre__vpn__config__s.html#ab4aa203386fefc77212e8a50b58d7ca5">vpn</a>;                      <span class="comment">/* L2GRE VPN */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__l2gre__vpn__config__s.html#ac961999cad6e09f3812ae66dc898a37c">vpnid</a>;                       <span class="comment">/* VPNID */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__l2gre__vpn__config__s.html#a43f20e42eb08f7e9aef95f2d53831e36">pkt_pri</a>;                      <span class="comment">/* Packet Priority */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__l2gre__vpn__config__s.html#a9d02907c7f4901f53eea486052421b70">pkt_cfi</a>;                      <span class="comment">/* Packet CFI */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__l2gre__vpn__config__s.html#a1fff9352b8c83e37662b5abfa0bda831">egress_service_tpid</a>;         <span class="comment">/* Service TPID */</span></div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a> <a class="code" href="structbcm__l2gre__vpn__config__s.html#a1932bbe3be97a39a126950ed7442974a">egress_service_vlan</a>;     <span class="comment">/* Service VLAN */</span></div><div class="line">    <a class="code" href="group__types.html#ga0f3f07b8f11cb4e625b0f42d6cc7f94c">bcm_multicast_t</a> <a class="code" href="structbcm__l2gre__vpn__config__s.html#a114da9007e9014c9b8cb11206e0e0163">broadcast_group</a>;</div><div class="line">    <a class="code" href="group__types.html#ga0f3f07b8f11cb4e625b0f42d6cc7f94c">bcm_multicast_t</a> <a class="code" href="structbcm__l2gre__vpn__config__s.html#a23da875b7522ca342116c784be3cdcc1">unknown_unicast_group</a>;</div><div class="line">    <a class="code" href="group__types.html#ga0f3f07b8f11cb4e625b0f42d6cc7f94c">bcm_multicast_t</a> <a class="code" href="structbcm__l2gre__vpn__config__s.html#aea986011b6e84795ff6689a580e315ae">unknown_multicast_group</a>;</div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__l2gre__vpn__config__s.html#ad96aba428436fa396c40bc69caf2352e">match_port_class</a>;       <span class="comment">/* local port vlan domain */</span></div><div class="line">} <a class="code" href="l2gre_8h.html#a789f86bbc24956135f78779676df4cf3">bcm_l2gre_vpn_config_t</a>;</div></div><!-- fragment --><ul>
<li>The bcm_l2gre_port_t structure describes a L2GRE virtual port used for creating L2GRE Network endpoints.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structbcm__l2gre__port__s.html">bcm_l2gre_port_s</a> {</div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__l2gre__port__s.html#a4039e1d4fc63810086145d4846031d96">l2gre_port_id</a>;          <span class="comment">/* GPORT identifier. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__l2gre__port__s.html#a81a27ce50e78368b0d0de1e8767fd32d">flags</a>;                       <span class="comment">/* BCM_L2GRE_PORT_xxx. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a1134b580f8da4de94ca6b1de4d37975e">uint32</a> <a class="code" href="structbcm__l2gre__port__s.html#a93ec8bd3b1e35ff73e12191664f035d8">if_class</a>;                    <span class="comment">/* Interface class ID. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__l2gre__port__s.html#a15df83dbc2cffdaeb851d30a1966ee46">int_pri</a>;                     <span class="comment">/* Internal Priority */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__l2gre__port__s.html#a43f20e42eb08f7e9aef95f2d53831e36">pkt_pri</a>;                      <span class="comment">/* Packet Priority */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#adde6aaee8457bee49c2a92621fe22b79">uint8</a> <a class="code" href="structbcm__l2gre__port__s.html#a9d02907c7f4901f53eea486052421b70">pkt_cfi</a>;                      <span class="comment">/* Packet CFI */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__l2gre__port__s.html#a1fff9352b8c83e37662b5abfa0bda831">egress_service_tpid</a>;         <span class="comment">/* Service Vlan TPID Value */</span></div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a> <a class="code" href="structbcm__l2gre__port__s.html#a1932bbe3be97a39a126950ed7442974a">egress_service_vlan</a>;     <span class="comment">/* SD-TAG Vlan ID. */</span></div><div class="line">    <a class="code" href="sal_2types_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> <a class="code" href="structbcm__l2gre__port__s.html#a2f2ea211666cb634a9f37c3222bc3bf1">mtu</a>;                         <span class="comment">/* MTU */</span></div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__l2gre__port__s.html#a8f0cfc3ce404244cbad3da9c68645a02">match_port</a>;             <span class="comment">/* Match port / trunk */</span></div><div class="line">    <a class="code" href="l2gre_8h.html#a8e5f59d19b8ac525b93823fcb3c2d3cd">bcm_l2gre_port_match_t</a> <a class="code" href="structbcm__l2gre__port__s.html#a53c8a7bd6bf7e6981d6a7035c58865f4">criteria</a>;    <span class="comment">/* Match criteria */</span></div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a> <a class="code" href="structbcm__l2gre__port__s.html#ad22679e36d7259c4d88d606c80d6d4c5">match_vlan</a>;              <span class="comment">/* Outer VLAN ID to match. */</span></div><div class="line">    <a class="code" href="group__types.html#ga206cad73150c7e799b9a1cd4ebe13465">bcm_vlan_t</a> <a class="code" href="structbcm__l2gre__port__s.html#ad4878e6cfd724f3e83cb9fab60ae73d9">match_inner_vlan</a>;        <span class="comment">/* Inner VLAN ID to match. */</span></div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__l2gre__port__s.html#a65d19308b7cfba4f48673118203c96ec">egress_tunnel_id</a>;       <span class="comment">/* Tunnel Initiator ID */</span></div><div class="line">    <a class="code" href="group__types.html#gac5f933aaac05c65b2a78ad8a04316994">bcm_gport_t</a> <a class="code" href="structbcm__l2gre__port__s.html#aaa055f6854e2e724f5690475c8ae6dc0">match_tunnel_id</a>;        <span class="comment">/* Tunnel Terminator ID */</span></div><div class="line">    <a class="code" href="group__types.html#ga30e6e81bfad0b18e55d3a1c8148fd75d">bcm_if_t</a> <a class="code" href="structbcm__l2gre__port__s.html#abb332a7a074df33554ed9da8218f56b4">egress_if</a>;                 <span class="comment">/* L2GRE egress object. */</span></div><div class="line">    <a class="code" href="group__types.html#ga356b17d1510b1781318bb0f840405e28">bcm_switch_network_group_t</a> <a class="code" href="structbcm__l2gre__port__s.html#af6d0ee687a1817417e66796f5af67a99">network_group_id</a>; <span class="comment">/* Switch split horizon network group ID this L2GRE port belongs to*/</span></div><div class="line">} <a class="code" href="l2gre_8h.html#aec8d9018ffd93cb121eec71d09473993">bcm_l2gre_port_t</a>;</div></div><!-- fragment --><a class="anchor" id=""></a>
<table class="doxtable">
<caption>L2GRE port flags</caption>
<tr>
<th>Name </th><th>Purpose  </th></tr>
<tr>
<td>BCM_L2GRE_PORT_WITH_ID </td><td>Create L2GRE port with specified ID  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_DROP </td><td>Drop matching packets on L2GRE port  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_NETWORK </td><td>Network facing L2GRE interface  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_COUNTED </td><td>Maintain packet/Byte counts  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_REPLACE </td><td>Replace existing L2GRE entry  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_INT_PRI_SET </td><td>Use Specified pri for internal priority  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_INT_PRI_MAP </td><td>Use specified exp_map for internal priority  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_EGRESS_TUNNEL </td><td>Specified Egress tunnel is valid  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_SERVICE_TAGGED </td><td>Service tag mode  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_SERVICE_VLAN_ADD </td><td>Add SD-tag  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_SERVICE_VLAN_REPLACE </td><td>Replace VLAN not TPID  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_SERVICE_VLAN_DELETE </td><td>Delete VLAN Tag  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_SERVICE_VLAN_TPID_REPLACE </td><td>Replace VLAN and TPID  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_SERVICE_VLAN_PRI_TPID_REPLACE </td><td>Replace VLAN, VLAN-PRI and TPID  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_SERVICE_VLAN_PRI_REPLACE </td><td>Replace VLAN and VLAN-PRI  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_SERVICE_PRI_REPLACE </td><td>Replace VLAN-PRI only  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_SERVICE_TPID_REPLACE </td><td>Replace TPID only  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_MULTICAST </td><td>Create Multicast-only L2GRE Tunnel  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_DEFAULT </td><td>L2GRE Default Network Port  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_ENABLE_VLAN_CHECKS </td><td>Enable vlan check, only for access VP derived from VLAN_XLATE  </td></tr>
</table>
<p>L2GRE port is a "virtual-port" that can be added to an L2 VPN. L2GRE port can be:</p><ul>
<li>L2GRE Tunnel endpoint (identified by Tunnel-SIP and L2GRE VPNID)</li>
<li>A physical port (identified by any combination of physical port, outer VLAN, inner VLAN)</li>
</ul>
<p>With ELAN, L2GRE ports that are added to the L2 VPN are part of the L2 flooding domain (similar to physical ports added to a VLAN). Each L2GRE port has a unique GPORT identifier, l2gre_port_id, that is allocated by the SDK when l2gre port is added to a VPN. L2GRE port consists of ingress and egress parameters. The ingress parameters are the "match criteria", which are used to associate incoming packets with L2GRE port based on incoming physical port and/or packet header information. The bcm_mpls_port_match_t types define which information is used as match criteria. The match_tunnel_id is used to specify the L2GRE Tunnel terminator. A match_tunnel is constructed using L2GRE Tunnel terminator API.</p>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>L2GRE Port Match Criteria</caption>
<tr>
<th>Name </th><th>Purpose  </th></tr>
<tr>
<td>BCM_L2GRE_PORT_MATCH_INVALID </td><td>Invalid value  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_MATCH_NONE </td><td>No source match criteria  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_MATCH_PORT </td><td>{Module, Port} or Trunk  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_MATCH_PORT_VLAN </td><td>Mod/port/trunk + outer VLAN  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_MATCH_PORT_INNER_VLAN </td><td>Mod/port/trunk + inner VLAN  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_MATCH_PORT_VLAN_STACKED </td><td>Mod/port/trunk + outer/inner VLAN  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_MATCH_VLAN_PRI </td><td>Mod/port/trunk + VLAN-PRI + VLAN-CFI  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_MATCH_VPNID </td><td>L2GRE VPNID  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_MATCH_SHARE </td><td>Shared logic port  </td></tr>
<tr>
<td>BCM_L2GRE_PORT_MATCH_PORT_ITAG </td><td>Mod/port/trunk + inner VLAN tag  </td></tr>
</table>
<p>The egress parameters specify the destination and outgoing packet information for the L2GRE port. The destination can be a mod/port/trunk or L2GRE tunnel. The egress_if parameter is used to specify L2GRE Egress Object. If the destination is L2GRE tunnel, egress_if must be a valid egress object. An egress object for an MPLS tunnel is constructed by calling L3 Egress APIs. The egress_tunnel_id is used to specify the L2GRE Tunnel. An egress tunnel is constructed using L2GRE Tunnel Initiator API.</p>
<ul>
<li>bcm_l2gre_stat_t is an enumerated type that defines the types of statistics that can be extracted per l2gre vp/vpn index.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="l2gre_8h.html#a3e27b3affd6b3d734663567a5648b080">bcm_l2gre_stat_e</a> {</div><div class="line">    <a class="code" href="l2gre_8h.html#a3e27b3affd6b3d734663567a5648b080ab66e4adbb344318de259d2821512a8be">bcmL2greInPackets</a>,</div><div class="line">    <a class="code" href="l2gre_8h.html#a3e27b3affd6b3d734663567a5648b080af711925a946951df0efa040e11a16048">bcmL2greOutPackets</a>,</div><div class="line">    <a class="code" href="l2gre_8h.html#a3e27b3affd6b3d734663567a5648b080aee8941d353baba38f6b0cebb85dbaeef">bcmL2greInBytes</a>,</div><div class="line">    <a class="code" href="l2gre_8h.html#a3e27b3affd6b3d734663567a5648b080a2c4eeaad2d8ea0df9489bd483dcd60ac">bcmL2greOutBytes</a></div><div class="line">} bcm_L2gre_stat_t;</div></div><!-- fragment --><ul>
<li>bcm_l2gre_tunnel_terminator_update API provides a trigger mechanism to update multicast BUD state per L2GRE Tunnel terminator.</li>
</ul>
<a class="anchor" id=""></a>
<table class="doxtable">
<caption>L2GRE Tunnel terminator Multicast flags</caption>
<tr>
<th>name </th><td>heading Purpose  </td></tr>
<tr>
<td>BCM_L2GRE_MULTICAST_TUNNEL_STATE_BUD_ENABLE </td><td>Enable BUD Multicast state  </td></tr>
<tr>
<td>BCM_L2GRE_MULTICAST_TUNNEL_STATE_BUD_DISABLE </td><td>Disable BUD Multicast state  </td></tr>
</table>
<h1><a class="anchor" id="l2gre_apis"></a>
L2GRE APIs</h1>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a5446ab4236152e6ad63142cf0b0cbdc1" title="Initialize L2GRE VPN config structure.">bcm_l2gre_vpn_config_t_init(bcm_l2gre_vpn_config_t* info)</a>  </td><td>Initialize L2GRE VPN config structure.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a13dde8ece4ce2280ec2cc5266d925f07" title="Create or update L2GRE VPN. When create a L2GRE VPN: If use BCM_L2GRE_VPN_WITH_VPNID,...">bcm_l2gre_vpn_create(int unit, bcm_l2gre_vpn_config_t* info)</a>  </td><td><p class="starttd">Create or update L2GRE VPN.</p>
<p class="intertd">When create a L2GRE VPN: If use BCM_L2GRE_VPN_WITH_VPNID, both VFI and VNID will be created. If not use flag BCM_L2GRE_VPN_WITH_VPNID, only VFI will be created.</p>
<p class="endtd">When update an exist L2GRE VPN(BCM_L2GRE_VPN_REPLACE should be used): If use both BCM_L2GRE_VPN_REPLACE and BCM_L2GRE_VPN_WITH_VPNID, both VFI and VNID will be created. If only use BCM_L2GRE_VPN_REPLACE, the VNID will be removed.   </p>
</td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#ac484d5f8126ef880a465ad9e17c2b9dc" title="Destroy L2GRE VPN.">bcm_l2gre_vpn_destroy(int unit, bcm_vpn_t l2vpn)</a>  </td><td>Destroy L2GRE VPN.   </td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#aa1a70358d244e8b7f7cad8d86562c302" title="Destroy L2GRE VPN.">bcm_l2gre_vpn_destroy_all(int unit)</a>  </td><td>Destroy L2GRE VPN.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a88b3ea6f5b5136d38feacb86dcabc52d" title="Get L2GRE VPN.">bcm_l2gre_vpn_get(int unit, bcm_vpn_t l2vpn, bcm_l2gre_vpn_config_t* info)</a>  </td><td>Get L2GRE VPN.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a4f5202d1337414d191d3ba25d02bc1a5" title="Traverse all valid L2GRE VPN entries and call the supplied callback routine.">bcm_l2gre_vpn_traverse(int unit, bcm_l2gre_vpn_traverse_cb cb, void* user_data)</a>  </td><td>Traverse all valid L2GRE VPN entries and call the supplied callback routine.   </td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a29ad7c7369955310a095516428bc771c" title="Initialize the BCM L2GRE subsystem.">bcm_l2gre_init(int unit)</a>  </td><td>Initialize the BCM L2GRE subsystem.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a9a7e7df6306c1f6f73bf15d1a2299d23" title="Detach the BCM L2GRE subsystem.">bcm_l2gre_cleanup(int unit)</a>  </td><td>Detach the BCM L2GRE subsystem.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a8f1cfd948a07c90c2ef715c6f1812a27" title="Create L2GRE Tunnel Initiator.">bcm_l2gre_tunnel_initiator_create(int unit, bcm_tunnel_initiator_t* info)</a>  </td><td>Create L2GRE Tunnel Initiator.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a6d36e48159a5fc86fdb287d2733a5e28" title="Delete L2GRE Tunnel Initiator.">bcm_l2gre_tunnel_initiator_destroy(int unit, bcm_gport_t l2gre_tunnel_id)</a>  </td><td>Delete L2GRE Tunnel Initiator.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#ad748eb1a39428248cd12d164a254f4d6" title="Get L2GRE Tunnel Initiator.">bcm_l2gre_tunnel_initiator_get(int unit, bcm_tunnel_initiator_t* info)</a>  </td><td>Get L2GRE Tunnel Initiator.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a9a6c7212b47b7103272f1e4f1a75c305" title="Traverse L2GRE Tunnel initiator.">bcm_l2gre_tunnel_initiator_traverse(int unit, bcm_tunnel_initiator_traverse_cb cb, void* user_data)</a>  </td><td>Traverse L2GRE Tunnel initiator.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#af5ac845499cda6abcc6b7c821223805e" title="Create L2GRE Tunnel terminator.">bcm_l2gre_tunnel_terminator_create(int unit, bcm_tunnel_terminator_t* info)</a>  </td><td>Create L2GRE Tunnel terminator.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a5ab977633a3e520520f1bfb5f048199e" title="Delete L2GRE Tunnel terminator.">bcm_l2gre_tunnel_terminator_destroy(int unit, bcm_gport_t l2gre_tunnel_id)</a>  </td><td>Delete L2GRE Tunnel terminator.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a54f2e0c82097dcc20c3bcc39376b2407" title="Update L2GRE Tunnel terminator.">bcm_l2gre_tunnel_terminator_update(int unit, bcm_tunnel_terminator_t* info)</a>  </td><td>Update L2GRE Tunnel terminator.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#afeebc5ae3b7b127a84cf95bbf2d4e5af" title="Get L2GRE Tunnel terminator.">bcm_l2gre_tunnel_terminator_get(int unit, bcm_tunnel_terminator_t* info)</a>  </td><td>Get L2GRE Tunnel terminator.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#afcd9c5312f92acb94892f68e0f5418b1" title="Traverse L2GRE Tunnel terminator.">bcm_l2gre_tunnel_terminator_traverse(int unit, bcm_tunnel_terminator_traverse_cb cb, void* user_data)</a>  </td><td>Traverse L2GRE Tunnel terminator.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a7e9dbce4fd21c772d9bf0305abe15bf5" title="Initialize L2GRE port structure.">bcm_l2gre_port_t_init(bcm_l2gre_port_t* l2gre_port)</a>  </td><td>Initialize L2GRE port structure.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#aeedeae02233427db7d3eccedefc84483" title="bcm_l2gre_port_add adds a Access or Network L2GRE port">bcm_l2gre_port_add(int unit, bcm_vpn_t l2vpn, bcm_l2gre_port_t* l2gre_port)</a>  </td><td>bcm_l2gre_port_add adds a Access or Network L2GRE port   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a17cb555fd19479956b12771e427f1922" title="bcm_l2gre_port_delete L2GRE port from L2GRE network.">bcm_l2gre_port_delete(int unit, bcm_vpn_t l2vpn, bcm_gport_t l2gre_port_id)</a>  </td><td>bcm_l2gre_port_delete L2GRE port from L2GRE network.   </td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a4d9516963d23fa5eb4cb6e66827e2989" title="bcm_l2gre_port_delete L2GRE port from L2GRE network.">bcm_l2gre_port_delete_all(int unit, bcm_vpn_t l2vpn)</a>  </td><td>bcm_l2gre_port_delete L2GRE port from L2GRE network.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a665079723f262ddbe321aa4614ce2cb5" title="Get L2GRE port information.">bcm_l2gre_port_get(int unit, bcm_vpn_t l2vpn, bcm_l2gre_port_t* l2gre_port)</a>  </td><td>Get L2GRE port information.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#aead2ea847a328f69af432ad20b52585c" title="Get all L2GRE port information.">bcm_l2gre_port_get_all(int unit, bcm_vpn_t l2vpn, int port_max, bcm_l2gre_port_t* port_array, int* port_count)</a>  </td><td>Get all L2GRE port information.   </td></tr>
</table>
<table class="doxtable">
<tr>
<th>API </th><th>Brief  </th></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a13dc999c6e9c60730f0330bd3ce2daa5" title="Attach counters entries to the given l2gre vp/vpn index.">bcm_l2gre_stat_attach(int unit, bcm_gport_t port, bcm_vpn_t vpn, uint32 stat_counter_id)</a>  </td><td>Attach counters entries to the given l2gre vp/vpn index   </td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a3bc2b3b8c3074784589e2128048f1e3e" title="Detach counters entries to the given l2gre vp/vpn index.">bcm_l2gre_stat_detach(int unit, bcm_gport_t port, bcm_vpn_t vpn)</a>  </td><td>Detach counters entries to the given l2gre vp/vpn index.   </td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a0f8fb331fe39bee687c2955a73ad1906" title="Get counter statistic values for a l2gre vp/vpn index.">bcm_l2gre_stat_counter_get(int unit, bcm_gport_t port, bcm_vpn_t vpn, bcm_l2gre_stat_t stat, uint32 num_entries, uint32* counter_indexes, bcm_stat_value_t* counter_values)</a>  </td><td>Get counter statistic values for a l2gre vp/vpn index.   </td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a2637793b088c25ba485ae9b832555b17" title="Force an immediate counter update and retrieve counter statistic values for a l2gre vp/vpn index.">bcm_l2gre_stat_counter_sync_get(int unit, bcm_gport_t port, bcm_vpn_t vpn, bcm_l2gre_stat_t stat, uint32 num_entries, uint32* counter_indexes, bcm_stat_value_t* counter_values)</a>  </td><td>Force an immediate counter update and retrieve counter statistic values for a l2gre vp/vpn index.   </td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a8b26da1e62cc85ef13301ffc6ecd4c9b" title="Set counter statistic values for a l2gre vp/vpn index.">bcm_l2gre_stat_counter_set(int unit, bcm_gport_t port, bcm_vpn_t vpn, bcm_l2gre_stat_t stat, uint32 num_entries, uint32* counter_indexes, bcm_stat_value_t* counter_values)</a>  </td><td>Set counter statistic values for a l2gre vp/vpn index   </td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a035c373311d44bbf4c61512c87cd4bbf" title="Get multiple counter statistic values for multiple l2gre vp/vpn index.">bcm_l2gre_stat_multi_get(int unit, bcm_gport_t port, bcm_vpn_t vpn, int nstat, bcm_l2gre_stat_t* stat_arr, uint64* value_arr)</a>  </td><td>Get multiple counter statistic values for multiple l2gre vp/vpn index.   </td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a85ea7762c3568150aecea6fb7ae59338" title="Get 32bit multiple counter statistic values for multiple l2gre vp/vpn index.">bcm_l2gre_stat_multi_get32(int unit, bcm_gport_t port, bcm_vpn_t vpn, int nstat, bcm_l2gre_stat_t* stat_arr, uint32* value_arr)</a>  </td><td>Get 32bit multiple counter statistic values for multiple l2gre vp/vpn index.   </td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a1efe309c8e98a79e1c629a89dd96d148" title="Set multiple counter statistic values for multiple l2gre vp/vpn index.">bcm_l2gre_stat_multi_set(int unit, bcm_gport_t port, bcm_vpn_t vpn, int nstat, bcm_l2gre_stat_t* stat_arr, uint64* value_arr)</a>  </td><td>Set multiple counter statistic values for multiple l2gre vp/vpn index.   </td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#a7bfd0dd1bc4ce27c01358550a6032207" title="Set 32bit multiple counter statistic values for multiple l2gre vp/vpn index.">bcm_l2gre_stat_multi_set32(int unit, bcm_gport_t port, bcm_vpn_t vpn, int nstat, bcm_l2gre_stat_t* stat_arr, uint32* value_arr)</a>  </td><td>Set 32bit multiple counter statistic values for multiple l2gre vp/vpn index.   </td></tr>
<tr>
<td><a class="el" href="l2gre_8h.html#abd6892aba12a25df7c781411c62ac513" title="Get stat counter ID associated with given l2gre vp/vpn index.">bcm_l2gre_stat_id_get(int unit, bcm_gport_t port, bcm_vpn_t vpn, bcm_l2gre_stat_t stat, uint32* stat_counter_id)</a>  </td><td>Get stat counter ID associated with given l2gre vp/vpn index.   </td></tr>
</table>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="footer-brcm-wrapper">
<table class="footer-brcm">
	<tbody><tr>
		<td class="footer-brcm"><img src="BRCM_Red+Black_noTag_RGB.png" align="left"></td>
		<td class="footer-brcm"><small><b>Proprietary and Confidential &copy; 2019 Broadcom</b></small>
			<div class="footer-brcm">Broadcom Incorporated reserves the right to make changes without further notice to any products or data herein to improve reliability, function, or design.
Information furnished by Broadcom Incorporated is believed to be accurate and reliable. However, Broadcom Incorporated does not assume any liability arising
out of the application or use of this information, nor the application or use of any product or circuit described herein, neither does it convey any license
under its patent rights nor the rights of others.
			</div>
		</td>
	</tr>
</tbody></table>
</div>
</body>
</html>
