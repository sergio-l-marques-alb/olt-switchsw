/* $Id: arad_egr_prog_editor.c,v 1.142.2.17 Broadcom SDK $
 * $Copyright: Copyright 2012 Broadcom Corporation.
 * This program is the proprietary software of Broadcom Corporation
 * and/or its licensors, and may only be used, duplicated, modified
 * or distributed pursuant to the terms and conditions of a separate,
 * written license agreement executed between you and Broadcom
 * (an "Authorized License").  Except as set forth in an Authorized
 * License, Broadcom grants no license (express or implied), right
 * to use, or waiver of any kind with respect to the Software, and
 * Broadcom expressly reserves all rights in and to the Software
 * and all intellectual property rights therein.  IF YOU HAVE
 * NO AUTHORIZED LICENSE, THEN YOU HAVE NO RIGHT TO USE THIS SOFTWARE
 * IN ANY WAY, AND SHOULD IMMEDIATELY NOTIFY BROADCOM AND DISCONTINUE
 * ALL USE OF THE SOFTWARE.  
 *  
 * Except as expressly set forth in the Authorized License,
 *  
 * 1.     This program, including its structure, sequence and organization,
 * constitutes the valuable trade secrets of Broadcom, and you shall use
 * all reasonable efforts to protect the confidentiality thereof,
 * and to use this information only in connection with your use of
 * Broadcom integrated circuit products.
 *  
 * 2.     TO THE MAXIMUM EXTENT PERMITTED BY LAW, THE SOFTWARE IS
 * PROVIDED "AS IS" AND WITH ALL FAULTS AND BROADCOM MAKES NO PROMISES,
 * REPRESENTATIONS OR WARRANTIES, EITHER EXPRESS, IMPLIED, STATUTORY,
 * OR OTHERWISE, WITH RESPECT TO THE SOFTWARE.  BROADCOM SPECIFICALLY
 * DISCLAIMS ANY AND ALL IMPLIED WARRANTIES OF TITLE, MERCHANTABILITY,
 * NONINFRINGEMENT, FITNESS FOR A PARTICULAR PURPOSE, LACK OF VIRUSES,
 * ACCURACY OR COMPLETENESS, QUIET ENJOYMENT, QUIET POSSESSION OR
 * CORRESPONDENCE TO DESCRIPTION. YOU ASSUME THE ENTIRE RISK ARISING
 * OUT OF USE OR PERFORMANCE OF THE SOFTWARE.
 * 
 * 3.     TO THE MAXIMUM EXTENT PERMITTED BY LAW, IN NO EVENT SHALL
 * BROADCOM OR ITS LICENSORS BE LIABLE FOR (i) CONSEQUENTIAL,
 * INCIDENTAL, SPECIAL, INDIRECT, OR EXEMPLARY DAMAGES WHATSOEVER
 * ARISING OUT OF OR IN ANY WAY RELATING TO YOUR USE OF OR INABILITY
 * TO USE THE SOFTWARE EVEN IF BROADCOM HAS BEEN ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGES; OR (ii) ANY AMOUNT IN EXCESS OF
 * THE AMOUNT ACTUALLY PAID FOR THE SOFTWARE ITSELF OR USD 1.00,
 * WHICHEVER IS GREATER. THESE LIMITATIONS SHALL APPLY NOTWITHSTANDING
 * ANY FAILURE OF ESSENTIAL PURPOSE OF ANY LIMITED REMEDY.$
 * $
*/


#include <soc/mcm/memregs.h>
#if defined(BCM_88650_A0)

#ifdef _ERR_MSG_MODULE_NAME
  #error "_ERR_MSG_MODULE_NAME redefined"
#endif

#define _ERR_MSG_MODULE_NAME BSL_SOC_EGRESS



/*************
 * INCLUDES  *
 *************/
/* { */
#include <shared/bsl.h>

#include <soc/dcmn/error.h>
#include <soc/dpp/drv.h>

#include <soc/dpp/SAND/Utils/sand_header.h>
#include <soc/dpp/SAND/Utils/sand_os_interface.h>

#include <soc/dpp/SAND/Management/sand_general_macros.h>
#include <soc/dpp/SAND/Management/sand_error_code.h>

#include <soc/dpp/TMC/tmc_api_stack.h>

#include <soc/dpp/ARAD/arad_egr_prog_editor.h>
#include <soc/dpp/ARAD/arad_api_framework.h>
#include <soc/dpp/ARAD/arad_api_mgmt.h>
#include <soc/dpp/ARAD/arad_tbl_access.h>
#include <soc/dpp/ARAD/arad_ports.h>
#include <soc/dpp/ARAD/arad_sw_db.h>
#include <soc/dpp/ARAD/arad_reg_access.h>
#include <soc/dpp/dpp_wb_engine.h>
#include <soc/dpp/ARAD/ARAD_PP/arad_pp_oam.h>




/* } */
/*************
 * DEFINES   *
 *************/
/* { */



#define IPV4_UC    (1)
#define IPV4_MC    (2)
#define IPV6_UC    (3)
#define IPV6_MC    (4)
#define CPU_TRAP    (15)



#define ARAD_PP_EG_PROG_NO_COMPARE (0x7)
#define ARAD_PP_EG_PROG_ALU_SUB  (0x0)
#define ARAD_PP_EG_PROG_ALU_ADD  (0x1)
#define ARAD_PP_EG_PROG_NOF_FEM(_unit)   (SOC_DPP_DEFS_GET((_unit),egr_prge_nof_lfems))
#define ARAD_PP_EG_PROG_NOF_LFEM_TABLES(_unit) (SOC_DPP_DEFS_GET((_unit),egr_prge_nof_lfem_tables))
#define ARAD_PP_EG_PROG_NOF_INSTR(_unit) (SOC_DPP_DEFS_GET((_unit),egr_prge_nof_program_instructions))
#define ARAD_PP_EG_PROG_NOF_INSTR_MEMS(_unit) (SOC_DPP_DEFS_GET((_unit),egr_prge_nof_instruction_mems))

#define ARAD_PP_EG_PROG_NULL_LFEM(_unit)    (ARAD_PP_EG_PROG_NOF_FEM(_unit))

typedef enum {
    ifc_10G = 0, 
    ifc_40G = 1,
    ifc_100G = 2,
    Ilaken = 3
} Ifc_mode ;

typedef enum {
    ofp_1p = 0, 
    ofp_2p = 1,
    ofp_8p = 2
}  Ofp_mode ;

/* -----------------------------------------------------------------------------k----------------------- */
/*                          PRGE - Programable Editor */
/* ---------------------------------------------------------------------------------------------------- */

#define ARAD_PP_PRGE_ENG_SIZE_REG_R0        (0)
#define ARAD_PP_PRGE_ENG_SIZE_REG_R1        (1)
#define ARAD_PP_PRGE_ENG_SIZE_REG_R2        (2)
#define ARAD_PP_PRGE_ENG_SIZE_REG_R3        (3)
#define ARAD_PP_PRGE_ENG_SIZE_REG_SZ        (4)
#define ARAD_PP_PRGE_ENG_SIZE_CONST         (5)

#define ARAD_PP_PRGE_ENG_OFFSET_REG_R0         (0)
#define ARAD_PP_PRGE_ENG_OFFSET_REG_R1         (1)
#define ARAD_PP_PRGE_ENG_OFFSET_REG_R2         (2)
#define ARAD_PP_PRGE_ENG_OFFSET_REG_R3         (3)
#define ARAD_PP_PRGE_ENG_OFFSET_REG_SZ         (4)
#define ARAD_PP_PRGE_ENG_OFFSET_CONST_0        (5)
#define ARAD_PP_PRGE_ENG_OFFSET_CONST_64       (6)
#define ARAD_PP_PRGE_ENG_OFFSET_CONST_96       (7)

#define ARAD_PP_PRGE_ENG_OP1_REG_R0       (0)
#define ARAD_PP_PRGE_ENG_OP1_REG_R1       (1)
#define ARAD_PP_PRGE_ENG_OP1_REG_R2       (2)
#define ARAD_PP_PRGE_ENG_OP1_REG_R3       (3)
#define ARAD_PP_PRGE_ENG_OP1_REG_SZ       (4)
#define ARAD_PP_PRGE_ENG_OP1_SIZE         (5)
#define ARAD_PP_PRGE_ENG_OP1_FEM_FIELD    (6)
#define ARAD_PP_PRGE_ENG_OP1_OP_VALUE     (7)

#define ARAD_PP_PRGE_ENG_OP2_SIZE         ARAD_PP_PRGE_ENG_OP1_SIZE
#define ARAD_PP_PRGE_ENG_OP2_FEM_FIELD    ARAD_PP_PRGE_ENG_OP1_FEM_FIELD
#define ARAD_PP_PRGE_ENG_OP2_REG_SZ       ARAD_PP_PRGE_ENG_OP1_REG_SZ
#define ARAD_PP_PRGE_ENG_OP2_REG_R0       ARAD_PP_PRGE_ENG_OP1_REG_R0
#define ARAD_PP_PRGE_ENG_OP2_REG_R1       ARAD_PP_PRGE_ENG_OP1_REG_R1
#define ARAD_PP_PRGE_ENG_OP2_REG_R2       ARAD_PP_PRGE_ENG_OP1_REG_R2
#define ARAD_PP_PRGE_ENG_OP2_REG_R3       ARAD_PP_PRGE_ENG_OP1_REG_R3
#define ARAD_PP_PRGE_ENG_OP2_OP_VALUE     ARAD_PP_PRGE_ENG_OP1_OP_VALUE

#define ARAD_PP_PRGE_ENG_OP3_REG_R0       (0)
#define ARAD_PP_PRGE_ENG_OP3_REG_R1       (1)
#define ARAD_PP_PRGE_ENG_OP3_REG_R2       (2)
#define ARAD_PP_PRGE_ENG_OP3_REG_R3       (3)
#define ARAD_PP_PRGE_ENG_OP3_REG_SZ       (4)
#define ARAD_PP_PRGE_ENG_OP3_SIZE         (5)
#define ARAD_PP_PRGE_ENG_OP3_OP_VALUE     (7)
#define ARAD_PP_PRGE_ENG_OP3_ALU          (8)

#define ARAD_PP_PRGE_ENG_DST_REG_R0       (0)
#define ARAD_PP_PRGE_ENG_DST_REG_R1       (1)
#define ARAD_PP_PRGE_ENG_DST_REG_R2       (2)
#define ARAD_PP_PRGE_ENG_DST_REG_R3       (3)
#define ARAD_PP_PRGE_ENG_DST_REG_SZ       (4)
#define ARAD_PP_PRGE_ENG_DST_INST_ADDR    (5)
#define ARAD_PP_PRGE_ENG_DST_DATA_ADDR    (6)

#define ARAD_PP_PRGE_SRC_ORIGINAL (0)
#define ARAD_PP_PRGE_SRC_GENERATED (1)
#define ARAD_PP_PRGE_SRC_RESOLVED (2)

#define ARAD_PP_PRGE_ACE_VARIABLE (59)
#define ARAD_PP_PRGE_EES_DATA1 (31)
#define ARAD_PP_PRGE_EES_DATA2 (17)
#define ARAD_PP_PRGE_SYS_HEADERS_SIZE (33)

#define ARAD_PP_PRGE_CMP_PASS_ALL (7)
/* offset source is 0B const   this value is pointing the LSB  (sic) */
#define ARAD_PP_PRGE_DST_SYSTEM_PORT 39  
#define ARAD_PP_PRGE_OUT_LIF 57
#define ARAD_PP_PRGE_OUT_PP_PORT             113 

#define ARAD_PP_PRGE_PROGRAM_VAR    3 /*   offset source is 64B const ** this value is pointing the LSB  */

#define ARAD_PP_PRGE_TOD_NTP 81 /*offset source is 0B const. This value is pointing the LSB */
#define ARAD_PP_PRGE_TOD_1588 97 /*offset source is 0B const. This value is pointing the LSB */


#define ARAD_PP_PRGE_PP_PORT_VARIABLE        45  /*   offset source is 0B const . This value is pointing the LSB  */

/* FTHM & PPH sizes*/

/* --------------------------- */
/* type values */
/* --------------------------- */

/* forwarding code types */
#define PP_FWD_CODE_ETHERNET                   (0x0)
#define PP_FWD_CODE_IPV4_UC                    (0x1)
#define PP_FWD_CODE_IPV4_MC                    (0x2)
#define PP_FWD_CODE_IPV6_UC                    (0x3)
#define PP_FWD_CODE_IPV6_MC                    (0x4)
#define PP_FWD_CODE_MPLS                       (0x5)
#define PP_FWD_CODE_TRILL                      (0x6)
#define PP_FWD_CODE_ETHERNET_AFTER_TERMINATION (0x8)
#define PP_FWD_CODE_SNOOP                      (0xb)
#define PP_FWD_CODE_TM                         (0xe)

#define ETH_TYPE_IPV6     (0x86dd)

/* Fields Value */

/* max instruction entries */
/* There are 42 entries, only 0-31 are used for program pointers. The rest are for jumps and are not dynamic */

#define ARAD_EGR_PROG_EDITOR_MAX_INSTRUCTION_ENTRIES  (32) 

/* max program number */
#define SOC_DPP_EGR_PROG_EDITOR_MAX_PROGRAM(unit)     (SOC_DPP_DEFS_GET(unit, nof_prge_programs)-1)

/* max program selection entry */
#define ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE  (23)

/* General defines*/

#define ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE 9 /* 9 bytes */
#define ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE 7 /* 7 bytes */

#define ARAD_EGR_PROG_EDITOR_FTMH_STACKING_EXTENSION_SIZE 2 /* 16 bits */

#define ARAD_EGR_PROG_EDITOR_FTMH_LB_EXTENSION_SIZE 1 /* 8 bits */

#define ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE 2 /*16 bits*/


#define ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_NO_FHEI  (ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE)
#define ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_FHEI_3_BYTE  (ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 3)
#define ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_FHEI_5_BYTE  (ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + ARAD_EGR_PROG_EDITOR_PPH_BASE_SIZE + 5)

/**
 * calculate the total FTMH size.
 */
#define ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE  ARAD_EGR_PROG_EDITOR_FTMH_BASE_SIZE + \
         SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_stacking_ext_mode * ARAD_EGR_PROG_EDITOR_FTMH_STACKING_EXTENSION_SIZE +\
         SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode * ARAD_EGR_PROG_EDITOR_FTMH_LB_EXTENSION_SIZE


/* Following values reperesnt the first byte of the OAM-TS. OAM-TS.TYPE==0, OAM-TS.OAM-SUBTYPE==2/3 , OAM-TS.MEP-TYPE==0 (down)*/
#define ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_NTP_DOWN  0x18
#define ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_1588_DOWN  0x10

/* Observe only the first 6 bits.*/
#define ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_MASK  3



/* } */
/*************
 * MACROS    *
 *************/
/* { */

#define _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(program_id) \
  (programs[unit][program_id].program_pointer*2)

#define _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(program_id) \
  (programs[unit][program_id].program_pointer*2+1)


/* } */
/*************
 * TYPE DEFS *
 *************/
/* { */

typedef struct
{
  uint32 val1;
  uint32 val2;
} lfem_map;

 


/* } */
/*************
 * GLOBALS   *
 *************/
/* { */


STATIC uint8
    lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS][33] = {

        /* 
         * THESE HAVE TO BE IN THE SAME ORDER AS THE "ARAD_EGR_PROG_EDITOR_LFEMS" enum! 
         * The enumeration value at the start of the line is used to validate this. 
         */

        /* LSB masks */
        {ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_6_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_12_LSBS, 1,0, 1,0, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_13_LSBS, 1,0, 1,0, 1,0, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS, 1,0, 1,0, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        /* Bit extraction */
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_2, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2},
        {ARAD_EGR_PROG_EDITOR_LFEM_BIT_3, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3},

        /* General masking */
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT0_TO_BIT1,  0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 1,0, 1,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8_TO_BIT10, 0,15, 0,14, 0,13, 0,12, 0,11, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ZERO_4_MSB,         1,0 ,1,0 ,1,0 ,1,0 ,0,11 ,0,10 ,0,9 ,0,8 ,0,7 ,0,6 ,0,5 ,0,4 ,0,3 ,0,2 ,0,1 ,0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_ONE_BIT9_TO_BIT10,  0,15, 0,14, 0,13, 0,12, 0,11, 1,1, 1,1, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        /* Shifts */
        {ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_1, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0},


        /* Petra-B */
        {ARAD_EGR_PROG_EDITOR_LFEM_TDM_PMM_PB, 1,1, 1,1, 1,1,  1,1, 1,1, 1,1, 0,6, 0,5, 0,3, 0,2 ,0,11, 0,10, 0,9 ,0,8 ,0,7, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB, 1,0 ,1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,3, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,9, 0,8, 0,11, 0,10, 0,4, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_EXTRACT_FTMH_PB, 0,15, 0,14, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_EXTRACT_FTMH_PB, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,4},


        /* Arad */
        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,8, 0,7, 0,10, 0,9, 0,3, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_MC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,23, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0, 1,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,29, 0,28, 0,27, 0,2, 0,1, 1,1, 1,1, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_EXTRACT_PPH_OFFSET, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_FHEI, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 1,0, 1,1, 1,0, 1,1, 1,1, 1,1},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_STAMP_PPH, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 1,1, 1,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_PPH_FWD_CODE, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,7, 0,6, 0,5, 0,4, 1,1, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8,  0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,1, 1,0, 1,1, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID, 1,0, 1,0, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_TC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,8, 0,7, 0,6},

        {ARAD_EGR_PROG_EDITOR_LFEM_PP_MIM_32K_IVEC_CMD, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 0,21, 0,20, 0,19, 0,18, 0,17, 0,16},

        {ARAD_EGR_PROG_EDITOR_LFEM_BUILD_PTCH_2B, 1,1 ,1,1 ,1,1 ,1,1 ,1,0 ,1,0 ,1,0 ,1,0 ,0,7 ,0,6 ,0,5 ,0,4 ,0,3 ,0,2 ,0,1 ,0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OLP_PETRA_A, 0,15, 0,14, 0,13, 0,12, 1,0, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_SIZE, 1,0, 1,0, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_LSBYTES,  1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES,   0,15, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,6, 0,5, 0,4, 0,3, 1,0, 1,0, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_2, 1,0, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_TM_ACTION_IS_MC, 1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,1,0 ,0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_OUT_PP_PORT, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,1, 1,1, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_DP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 1,0, 1,0, 0,2, 0,1, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OTMH_MC_CUD_EXTRACT_MC_CUD, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,18, 0,17, 0,16},

        {ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,5, 0,4, 0,3},

        {ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2, 0,1, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_IPV6_EXTRACT_FTMH, 1,0, 1,0, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 0,3, 0,2},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD,       1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,1, 0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_APLUS, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 1,0, 1,1, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_NTP, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,1, 1,1, 1,1, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY, 0,15, 0,14, 0,13, 0,12, 0,11, 0,10, 0,9, 0,8, 0,7, 0,6, 0,5, 0,4, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC, 1,0, 0,5, 0,4, 0,3, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_SP_5_0, 1,0, 1,0, 1,1, 1,0, 1,0, 1,1, 1,0, 1,0, 1,1, 1,0, 0,5, 0,4, 0,3, 0,2, 0,1, 0,0},

        {ARAD_EGR_PROG_EDITOR_LFEM_LSB_MPLS,    1,0 ,1,0 ,1,0 ,1,0 ,0,11 ,0,10 ,0,9 ,1,0 ,0,7 ,0,6 ,0,5 ,0,4 ,0,3 ,0,2 ,0,1 ,0,0},
        {ARAD_EGR_PROG_EDITOR_LFEM_MSB_MPLS,    0,3, 0,2, 0,1, 0,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0},
        
		{ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_2, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 1,0, 0,2, 0,1}

    }; /* lfem_actions[][] */


/* 
 * Shadow of the FEM actions loaded to the HW.
 * ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS means this slot is empty, other values represent the FEM action.
 */
ARAD_EGR_PROG_EDITOR_LFEM lfem_maps_shadow[SOC_MAX_NUM_DEVICES][ARAD_EGR_PRGE_MAX_NOF_LFEM_TABLES][ARAD_EGR_PRGE_MAX_NOF_LFEMS];

/* 
 * tm profiles 
 * -1 means this profile is not loaded
 */
int tm_profiles[SOC_MAX_NUM_DEVICES][ARAD_PRGE_TM_SELECT_NOF_PROFILES];

/* 
 * all the programs info:
 */
ARAD_EGR_PROG_EDITOR_PROGRAM_INFO programs[SOC_MAX_NUM_DEVICES][ARAD_EGR_PROG_EDITOR_PROG_NOF_PROGS];

/* 
 * used to show which programs needs to be set:
 */
ARAD_EGR_PROG_EDITOR_PROGRAMS_USAGE_INFO programs_usage[SOC_MAX_NUM_DEVICES];

/* 
 * last program ID used for allocation: 
 * if -1: no programs has been allocated yet 
 * max is 15 
 */
int last_program_id[SOC_MAX_NUM_DEVICES];

/* 
 * last tm profile used for allocation: 
 * if -1: no tm profile has been allocated yet 
 * max is 16 
 */
int last_tm_profile[SOC_MAX_NUM_DEVICES];

/* 
 * last instruction entry used for allocation: 
 * if -1: no instruction entry has been allocated yet 
 * max is 41
 */
int last_program_pointer[SOC_MAX_NUM_DEVICES];

/* 
 * Number of tm profiles that can be used 
 * max is 16
 */
int tm_profiles_available[SOC_MAX_NUM_DEVICES];

/* 
 * Index of the STACKING_8 LFEM if it was allocated and loaded.
 * -1 if not.
 */
int lfem_stacking_8_index[SOC_MAX_NUM_DEVICES];

/* 
 * LFEM map table of the STACKING_8 LFEM if it was allocated and loaded.
 */
int lfem_stacking_8_map[SOC_MAX_NUM_DEVICES];

/* 
 * Index of the STACKING_8 LFEM if it was allocated and loaded.
 * -1 if not.
 */
int lfem_stacking_10_index[SOC_MAX_NUM_DEVICES];

/* 
 * LFEM map table of the STACKING_10 LFEM if it was allocated and loaded.
 */
int lfem_stacking_10_map[SOC_MAX_NUM_DEVICES];

/* } */
/*************
 * FUNCTIONS *
 *************/


/* { */

/* Convert lfem_map array to 96 bit table data */
void
  lfem_map_arr_to_lfem_field_select_map(
    SOC_SAND_IN  lfem_map lfem_arr[],
    SOC_SAND_OUT  ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  *tbl_data
  );

/* Loads lfem action from the actions static array to 96 bit table data */
void
  lfem_map_action_to_lfem_field_select_map(
    SOC_SAND_IN  ARAD_EGR_PROG_EDITOR_LFEM lfem_action,
    SOC_SAND_OUT  ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  *tbl_data
  );

/* 
 * arad_egr_prog_editor_supply_lfem_idx
 * Used for LFEM management during instruction loading to the HW.
 * If the needed LFEM is already allocated an entry in the LFEM map table
 * used from the instruction's memory table, the index is returned and no new
 * allocation is made.
 * If the LFEM is not available in the LFEM map table available from the
 * instruction's memory table, the function tries to allocate an entry for
 * the LFEM. 
 * PARAMS: 
 *   SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_PROGRAMS   prog - the program in which
 *                                      the LFEM is used (for diagnostics only)
 *   SOC_SAND_IN    int                             mem  - Instruction's memory table
 *   SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_LFEM       lfem - the needed LFEM action
 *   SOC_SAND_OUT   uint32                         *index- returned index.
 *  
 * if unable to allocate the entry needed, Prints hints for
 * instructions reordering in the form of duplicate LFEM loads.
 */
STATIC uint32
  arad_egr_prog_editor_supply_lfem_idx(
     SOC_SAND_IN    int                             unit,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_LFEM       lfem,
     SOC_SAND_IN    int                             mem,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_PROGRAMS   prog,
     SOC_SAND_OUT   uint32                         *index
  );

uint32 
  arad_egr_prog_editor_basic_epni_tm_config(
    SOC_SAND_IN  int unit
  ); 

void 
  header_editing_size_to_reg_val(
    SOC_SAND_IN  soc_reg_above_64_val_t val, 
    SOC_SAND_OUT soc_reg_above_64_val_t dest
  );

#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_PPH_LEARN_EXT_EXISTS_BIT 0x1
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_PPH_EEI_EXT_EXISTS_BIT 0x2
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS 0xc
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_PPH_EXISTS_BIT 0x10
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_OAM_TS_EXISTS_BIT 0x20
#define ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_DSP_EXITS_BIT 0x40


/**
 * Set the VALUE_1_OFFSET register and related registers. 
 * the VALUE_1_OFFSET register is accesed by one of 8 profiles, 
 * a profile is attained from the SYSTEM_HEADERS_FORMAT_CODE 
 * register. SYSTEM_HEADERS_FORMAT_CODE is accessed with the 
 * mapping 
 * {ftmh_dsp_ext_exists,ftmh_oam_ts_ext_exists,sys_hdr_record[`EPP_SYS_RCRD_PPH_VALID],fhei_size 
 * (0--> not present, 1--> 3 Byte, 2-->5 Byte),
 * pph_eei_ext_exists,pph_learn_ext_exists} 
 *  
 * Note that program selection cam should be configured 
 * accordingly to account for system header stack. 
 *  
 * All programs using the value_1_offset in the program 
 * selection cam should  
 *  
 * The  VALUE_1_OFFSET[profile] is a 5 bit field.
 *  
 * @author sinai (03/04/2014)
 * 
 * @param unit 
 * 
 * @return STATIC uint32 
 */
STATIC uint32 arad_egr_prg_editor_set_value_1_offset(int unit) {
	uint8 sys_header_format_code_key;
	soc_reg_above_64_val_t reg_above64_val; 
	uint32 value_1_key;
	uint32 value_1_offset[8] = {0};
	int i;
    uint64 reg64_val;
	uint32 reg_64_arr[2]={0};
	uint32 res;
	int profile_used=0;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

	SOC_REG_ABOVE_64_CLEAR(reg_above64_val);

	SOC_SAND_SOC_IF_ERROR_RETURN(res ,12, exit , READ_EPNI_SYSTEM_HEADERS_FORMAT_CODEr(unit, REG_PORT_ANY, reg_above64_val));

	/* First, determine the profiles*/
	if (programs_usage[unit].oam_dm_down) {
		programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP].value_1_offset_first_profile = profile_used;
		profile_used += programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP].num_value_1_offset_profiles;
	}

    if (programs_usage[unit].vmac_enable) {
        /* VMAC uses 3 profiles, depending on the FHEI size*/
        programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].value_1_offset_first_profile = profile_used;
        profile_used += programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].num_value_1_offset_profiles;
    }

	/* Next, set the profiles according to the system headers configurations..*/
	for (sys_header_format_code_key = 0; sys_header_format_code_key < 0x80 /* all combinations of 7 bits. */; ++sys_header_format_code_key) {
        value_1_key=0;
		if (sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_OAM_TS_EXISTS_BIT) {
			/* Set the value 1 offset.*/
			if (programs_usage[unit].oam_dm_down) {
				/* first profile: OAM-TS without DSP,  second profile: OAM-TS withou DSP*/
				value_1_key =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP].value_1_offset_first_profile +
					 ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_DSP_EXITS_BIT) > 0);
			}
		} else if (programs_usage[unit].vmac_enable) {
            if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS) ==0) {
                /* NO FHEI., use first profile*/
                value_1_key = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].value_1_offset_first_profile;
            } else if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS)==0x4 ) {
                /* 3 byte FHEI, use second profile*/
                value_1_key = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].value_1_offset_first_profile + 1;
            } else if ((sys_header_format_code_key & ARAD_EGR_EDITOR_SYSTEM_HEADERS_FORMAT_CODE_FHEI_SIZE_BITS)==0x8 ) {
                /* 5 byte FHEI, use third profile*/
                value_1_key = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].value_1_offset_first_profile + 2;
            }
        }
        SHR_BITCOPY_RANGE(reg_above64_val, (3 * sys_header_format_code_key), &value_1_key, 0, 3);
	}

	SOC_SAND_SOC_IF_ERROR_RETURN(res ,12, exit ,  WRITE_EPNI_SYSTEM_HEADERS_FORMAT_CODEr(unit, REG_PORT_ANY, reg_above64_val));


	/* Now set the actual offsets given the profiles.*/
	if (programs_usage[unit].oam_dm_down) {
		/* point to the start of the OAM-TS.*/
		value_1_offset[programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP].value_1_offset_first_profile] 
			= ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE;
		value_1_offset[programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP].value_1_offset_first_profile+1]
			 = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE + ARAD_EGR_PROG_EDITOR_FTMH_DSP_EXTENSION_SIZE; 
	}

    if (programs_usage[unit].vmac_enable) {
        /* 3 profiles used: with FHEI, 3 byte FHEI, 5 byte FHEI*/
        value_1_offset[programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].value_1_offset_first_profile] 
           = ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_NO_FHEI; 

        value_1_offset[programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].value_1_offset_first_profile + 1]
           = ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_FHEI_3_BYTE;

        value_1_offset[programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].value_1_offset_first_profile + 2]
           = ARAD_PRGE_PP_SELECT_VALUE_1_OFFSET_FHEI_5_BYTE;
    }

	SOC_SAND_SOC_IF_ERROR_RETURN(res ,12, exit , READ_EPNI_SYSTEM_HEADERS_VALUE_1_OFFSETr(unit, SOC_CORE_ALL, &reg64_val));

	COMPILER_64_TO_32_LO(reg_64_arr[0], reg64_val);
	COMPILER_64_TO_32_HI(reg_64_arr[1], reg64_val); 
	/* Now write the offsets into the register, per profile.*/
	for (i=0 ; i <8 /* 8 profiles */ ; ++i) {
		if (value_1_offset[i]) {
			SHR_BITCOPY_RANGE(reg_64_arr, (5 * i), &value_1_offset[i], 0, 5);
		}
	}

	COMPILER_64_SET(reg64_val, reg_64_arr[1], reg_64_arr[0]);
	SOC_SAND_SOC_IF_ERROR_RETURN(res ,12, exit , WRITE_EPNI_SYSTEM_HEADERS_VALUE_1_OFFSETr(unit, SOC_CORE_ALL,  reg64_val));

exit: 
    SOC_SAND_EXIT_AND_SEND_ERROR_SOCDNX((_BSL_SOCDNX_SAND_MSG("Something went wrong")));
}

/* regular task, usage - both ALU and FEM parts */
STATIC void arad_egr_prog_editor_next_mem_and_entry_find(SOC_SAND_INOUT int * prge_entry, SOC_SAND_INOUT int * prge_mem)
{
    if(*prge_entry % 2 != 0) {
        /* odd */
        *prge_mem = *prge_mem+1;
        *prge_entry = *prge_entry-1;
    }
    else {
        *prge_entry = *prge_entry+1;
    }
}


/* 
 * arad_egr_prog_editor_supply_lfem_idx
 * Used for LFEM management during instruction loading to the HW.
 * If the needed LFEM is already allocated an entry in the LFEM map table
 * used from the instruction's memory table, the index is returned and no new
 * allocation is made.
 * If the LFEM is not available in the LFEM map table available from the
 * instruction's memory table, the function tries to allocate an entry for
 * the LFEM. 
 * PARAMS: 
 *   SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_PROGRAMS   prog - the program in which
 *                                      the LFEM is used (for diagnostics only)
 *   SOC_SAND_IN    int                             mem  - Instruction's memory table
 *   SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_LFEM       lfem - the needed LFEM action
 *   SOC_SAND_OUT   uint32                         *index- returned index.
 *  
 * if unable to allocate the entry needed, Prints hints for
 * instructions reordering in the form of duplicate LFEM loads.
 */
STATIC uint32
  arad_egr_prog_editor_supply_lfem_idx(
     SOC_SAND_IN    int                             unit,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_LFEM       lfem,
     SOC_SAND_IN    int                             mem,
     SOC_SAND_IN    ARAD_EGR_PROG_EDITOR_PROGRAMS   prog,
     SOC_SAND_OUT   uint32                         *index
  ) {

    int i;
    int lfem_arr_idx = (mem - EPNI_PRGE_INSTRUCTION_0m) % ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit);

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);
    
    if (NULL == index) {
        SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("NULL supplied for out parameter\n\r")));
    }

    if (lfem == ARAD_EGR_PROG_EDITOR_LFEM_NULL) {
        /* NULL LFEM is a constant LFEM which doesn't need allocation */
        *index = ARAD_PP_EG_PROG_NULL_LFEM(unit);
        /* We don't log the usage of NULL LFEM */
    }
    else
    {
        *index = -1; 

        for (i = 0; i < ARAD_PP_EG_PROG_NOF_FEM(unit); i++) {
            if (lfem_maps_shadow[unit][lfem_arr_idx][i] == ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS) {
                /* end of allocated LFEMs in this array. Allocate one for this action and return the index */
                lfem_maps_shadow[unit][lfem_arr_idx][i] = lfem;
                *index = i;
                break;
            }
            else if (lfem_maps_shadow[unit][lfem_arr_idx][i] == lfem) {
                /* lfem is already allocated. return the index. */
                *index = i;
                break;
            }
        }

        if (*index == -1) 
        {
            /* Could not allocate LFEM slot for the required action. Print duplicates and fail */
            arad_egr_prog_editor_print_lfem_duplicates(unit);
            SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("Error - Not enough LFEMs to load all programs needed.\n\r")));
        }
        else
        {
            /* Update programs for diagnostics purposes */
            programs[unit][prog].lfem_bk[lfem_arr_idx][*index] = lfem;
        }
    }

exit: 
    SOC_SAND_EXIT_AND_SEND_ERROR_SOCDNX((_BSL_SOCDNX_SAND_MSG("Error while loading LFEMs")));
}

STATIC uint32
    arad_egr_prog_editor_validate_lfem_action_array(
       SOC_SAND_IN  int     unit
    )
{
    int i;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    for (i = 0; i < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS; i++) {
        if (i != lfem_actions[i][0]) {
            SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("Static error - LFEM actions array is out of order. First occurance in entry %d\n\r"),i));
        }
    }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_validate_lfem_action_array()",0,0);   
}

/* 
 * init all programs info:
 */
STATIC void
  arad_egr_prog_editor_programs_init(
     SOC_SAND_IN  int                                 soc_petrab_cfg,
     SOC_SAND_IN  int                              unit
  )
{
    int i, j;
    
    last_program_id[unit] = 0;
    last_tm_profile[unit] = -1;
    last_program_pointer[unit] = 0; /* pointer 0 is for NULL program */

    lfem_stacking_8_index[unit] = -1;
    lfem_stacking_10_index[unit] = -1;

    for (i = 0; i < ARAD_EGR_PROG_EDITOR_PROG_NOF_PROGS; i++) {
        programs[unit][i].prog_used = -1;
        programs[unit][i].program_pointer = -1;
        programs[unit][i].tm_profile = -1;
    }
    for (i = 0; i < ARAD_EGR_PRGE_MAX_NOF_LFEM_TABLES; i++) {
        /* The macro SOC_DPP_DEFS_MAX can cause same_on_both_sides defects in case that there is a same value 
         * in both of the chips. Ignore such defects */
        /* coverity[same_on_both_sides] */
        for (j = 0; j < ARAD_EGR_PRGE_MAX_NOF_LFEMS; j++) {
            lfem_maps_shadow[unit][i][j] = ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS;
        }
    }
    for (i = 0; i < ARAD_PRGE_TM_SELECT_NOF_PROFILES; i++) {
        tm_profiles[unit][i] = -1;
    }
            
    /* 
     * Init special cases of programs data
     */
     
    /* ETH_WITH_LLID_TAG (EPON) */
    if (!SOC_IS_ARAD_B1_AND_BELOW(unit)) {
        programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG].tm_profile = ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG;
    }

    /* 10.	OAM DM Down Trap (arad+)*/
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP].num_value_1_offset_profiles = 2 /*one profile with the DSP and another without. */;
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP].num_value_1_offset_profiles = 2 /*one profile with the DSP and another without. */;

    /* OTMH */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH].tm_profile = ARAD_PRGE_TM_SELECT_OTMH_BASE;
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH].tm_profile = ARAD_PRGE_TM_SELECT_OTMH_BASE;

    /* OTMH program with 24bit CUD extention */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD].tm_profile = ARAD_PRGE_TM_SELECT_OTMH_WITH_CUD_EXT;

    /* Removing system headers */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER].tm_profile = ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER;

    /* Remove TDM FTMH */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH].tm_profile = ARAD_PRGE_TM_SELECT_REMOVE_TDM_OPT_FTMH;

    /* TDM PMM */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM].tm_profile = ARAD_PRGE_TM_SELECT_TDM_PMM_HEADER;

    /* TDM_STAMP_CUD */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD].tm_profile = ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD;

    /* STACKING */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING].tm_profile = ARAD_PRGE_TM_SELECT_STACKING;

    /* STACKING UC */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC].tm_profile = ARAD_PRGE_TM_SELECT_STACKING;

        
    /* ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING].tm_profile = ARAD_PRGE_TM_SELECT_PP_RCY_PORT;

    /* ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU].tm_profile = ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU;

    /* ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM].num_value_1_offset_profiles = 3 /*Three profiles: each depend on the FHEI size*/;

    /* ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].num_value_1_offset_profiles = 3 /*Three profiles: each depend on the FHEI size*/;

    /* ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER].tm_profile = ARAD_PRGE_TM_SELECT_ADD_PACKET_SIZE_HEADER;

    /* ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH */
	programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH].tm_profile = ARAD_PRGE_TM_SELECT_REFLECTOR_IP_AND_ETH; /* TM profile allocated dynamically.*/ 

    /* ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH].tm_profile = ARAD_PRGE_TM_SELECT_REFLECTOR_ETH; /* TM profile allocated dynamically.*/ 

    /* ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING].tm_profile = ARAD_PRGE_TM_SELECT_TM_MODE_HW_PROCESSING; /* TM profile allocated dynamically.*/ 

    /* ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING */
    programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING].tm_profile = ARAD_PRGE_TM_SELECT_PP_MODE_HW_PROCESSING; /* TM profile allocated dynamically.*/ 

}

/* 
 * init all programs usage info:
 */
STATIC uint32
  arad_egr_prog_editor_programs_usage_init(
      SOC_SAND_IN  int                                 unit
  )
{
  uint8 is_petrab_in_system;
  uint32 port_idx, res;
  soc_pbmp_t pbmp;
  SOC_TMC_PORTS_FTMH_EXT_OUTLIF outlif_ext_en;

  SOC_SAND_INIT_ERROR_DEFINITIONS(ARAD_EGR_PROG_EDITOR_PROGRAMS_USAGE_INIT);

  sal_memset(&programs_usage[unit], 0, sizeof(ARAD_EGR_PROG_EDITOR_PROGRAMS_USAGE_INFO));

  /* XGS is always set, but its type depends on whether the device is in TM or PP mode */
  if (SOC_DPP_CONFIG(unit)->arad->init.pp_enable == TRUE) { /* PP mode */

      if (SOC_DPP_CONFIG(unit)->pp.xgs_port_exists) {
          programs_usage[unit].xgs_pp = 1;
      }
      programs_usage[unit].ipv6_tunnel = SOC_DPP_CONFIG(unit)->pp.ipv6_tunnel_enable;

      if (SOC_INFO(unit).oamp_port[0] == /*SOC_DPP_PORT_INTERNAL_OAMP*/ ARAD_OAMP_PORT_ID) {
          programs_usage[unit].oam_ts_ccm = 1;
          if(soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_ccm_two_fhei", 0) == 1) {
              programs_usage[unit].oam_ts_ccm_fhei_2 = 1;
          }
		  if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_dm_tod_msb_add_enable", 1)) {
			  programs_usage[unit].oam_dm_down =1;
		  }
      }
      
      programs_usage[unit].erspan = soc_property_get(unit, spn_BCM886XX_ERSPAN_TUNNEL_ENABLE, 1) ? 1 : 0;
      programs_usage[unit].rspan = soc_property_get(unit, spn_BCM886XX_RSPAN_TUNNEL_ENABLE, 1) ? 1 : 0;
      
      programs_usage[unit].mpls_swap = SOC_DPP_CONFIG(unit)->arad->pp_op_mode.mpls_info.mpls_coupling_enable ? 1 : 0;
      programs_usage[unit].vxlan = (SOC_DPP_CONFIG(unit)->pp.ipv4_tunnel_term_bitmap_enable & SOC_DPP_IP_TUNNEL_TERM_DB_VXLAN) ? 1 : 0; /* for B0 */
      if ((programs_usage[unit].vxlan) && (SOC_IS_ARAD_A0(unit))) {
          SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  VXLAN supported only on ARAD_B0 device and above. \n\r")));
      }
        
      programs_usage[unit].epon = SOC_DPP_CONFIG(unit)->pp.pon_application_enable;
  }
  else { /* TM mode */
      programs_usage[unit].xgs_tm = 1; 
  }

  if (SOC_INFO(unit).oamp_port[0] == ARAD_OAMP_PORT_ID) {
      programs_usage[unit].oam_loopback = 1; 
  }

  programs_usage[unit].tdm = 1;

  /* check if there's Petra-B in system */
  is_petrab_in_system = arad_sw_db_is_petrab_in_system_get(unit);
  if (is_petrab_in_system) {
     programs_usage[unit].tdm_pmm = 1;
  }

  programs_usage[unit].tdm_stamp_cud = SOC_DPP_CONFIG(unit)->tdm.is_bypass ? 1 : 0;

  programs_usage[unit].stacking = SOC_DPP_CONFIG(unit)->arad->init.ports.is_stacking_system ? 1 : 0; 

  programs_usage[unit].two_hop_scheduling = 0;

  SOC_SAND_SOC_IF_ERROR_RETURN(res, 10, exit, soc_port_sw_db_valid_ports_get(unit, 0, &pbmp));

  SOC_PBMP_ITER(pbmp,port_idx) {
      SOC_SAND_SOC_IF_ERROR_RETURN(res, 15, exit, soc_port_sw_db_olif_ext_en_get(unit, port_idx, &outlif_ext_en));
      if (outlif_ext_en == SOC_TMC_PORTS_FTMH_EXT_OUTLIF_DOUBLE_TAG) {
          programs_usage[unit].two_hop_scheduling = 1;
          break;
      }
  }

  if ((SOC_DPP_CONFIG(unit)->arad->init.pp_enable == TRUE)&&(soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "88650L23C", 0))) /* PP mode and feature enabled*/
  {
      /* Remote CPU program and XGS programs share the same instructions - if remote CPU enabled, need to disable all XGS programs */
      programs_usage[unit].xgs_tm = 0;
      programs_usage[unit].xgs_pp=0;
      programs_usage[unit].l2_remote_cpu=1;
  }
  else
  {
      programs_usage[unit].l2_remote_cpu=0;
  }

  if ((SOC_DPP_CONFIG(unit)->arad->init.pp_enable == FALSE) && (SOC_DPP_CONFIG(unit)->tm.ftmh_outlif_enlarge == TRUE))
  {
      programs_usage[unit].otmh_cud = 1;
  }
  else
  {
      programs_usage[unit].otmh_cud = 0;
  }

  programs_usage[unit].trill = SOC_DPP_CONFIG(unit)->trill.mode; 

  programs_usage[unit].vmac_enable = soc_property_get(unit, spn_VMAC_ENABLE, 0) ? 1 : 0;

  programs_usage[unit].bfd_echo = soc_property_get(unit, spn_BFD_ECHO_ENABLED, 0) ? 1 : 0;

  programs_usage[unit].olp_petra = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "olp_petra", 0) ? 1 : 0;

  /* In systems with user defined header we need to remove the header before the packet is sent to the network.
  * With Ethernet packets we do not need a special program because we have the PPH witch points to the end of user defined header, so this is considered part of the system headers. In TM packets there is no PPH so UDH has to be removed with a special program.
  * The solution:
  *     - New program to remove the UDH 
  *     - Program selection is TM PROFILE (we would like to use PP profile, but do not have enough profiles)
  *     - Because different ports can have different TM profiles, we use the MSB of the profile in the program selection.
  *     - To make management easier we reduced by 2 the amount of available TM profiles (in case of lack of profiles we can think of a batter solution), this is done if soc property custom_feature_user_header_always_remove is enabled. 
  */ 
  programs_usage[unit].user_header_always_remove = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "user_header_always_remove", 0) ? 1 : 0;

  programs_usage[unit].size_header = 0;
  for (port_idx = 0; port_idx < ARAD_NOF_FAP_PORTS; port_idx++) 
  {
      if(soc_property_port_suffix_num_get(unit, port_idx, -1, spn_CUSTOM_FEATURE, "add_size_header", 0)) {
          programs_usage[unit].size_header = 1;
          break;
      }
  }


exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_programs_usage_init()",0,0);   
}

void
  arad_egr_prog_editor_prog_name_get_by_id(uint32 program_id, char** prog_name)
{
        switch(program_id)                                                
        {                                                                 
        case ARAD_EGR_PROG_EDITOR_PROG_VXLAN:                             
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_VXLAN";                  
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA:                  
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA";       
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA:                         
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA";              
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_ERSPAN:                            
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ERSPAN";                 
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH:           
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH";
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_RSPAN:                             
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_RSPAN";                  
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS:                         
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS";              
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_MPLS_SWAP_COUPLING:                
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MPLS_SWAP_COUPLING";     
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE:                 
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE";      
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH";          
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD:                           
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD";                
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG:                 
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG";      
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL:                       
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL";            
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK:                      
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK";           
        break;                                                                                                                     
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP:                       
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP";            
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP:                       
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP";            
        break;       
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP";
        break;
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP:
            *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP";
        break;                         
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP:                       
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP";            
        break;                                                              
        case ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP:                 
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP";      
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM:                           
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM";                
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM_UP_MEP_TRAP_2_FHEI:        
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM_UP_MEP_TRAP_2_FHEI";
        break;                                                                                                                  
        case ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO:        
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO";
        break;                                                                                                                  
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER:                    
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER";         
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER:                    
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER";         
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_OTMH:                              
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OTMH";                   
        break;   
        case ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH:                              
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH";                   
        break;                                                         
        case ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD:                          
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD";               
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER:              
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER";   
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH:                   
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH";        
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM:                           
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM";                
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD";          
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_STACKING:                          
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_STACKING";               
        break;               
        case ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC:                          
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC";               
        break;                                                                
        case ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING:                  
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING";       
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU";          
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT:                   
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT";        
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2:                         
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2";              
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM:                   
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM";        
        break;                                                            
        case ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM";          
        break;   
        case ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT";          
        break;   
		case ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER";          
        break;   
		case ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN";          
        break;
		case ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH";          
        break;	
		case ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH";          
          break;
		case ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING";    
          break;
		case ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING";    
			break;
		case ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH";    
        break;
		case ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO:                     
          *prog_name = "ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO";    
        break;
        default:                                                          
          *prog_name = "Unknown program";                                  
        } 
}

void
  arad_egr_prog_editor_lfem_name_get_by_id(uint32 lfem_id, char** lfem_name)
{
    switch(lfem_id)                                                
    {                                                                 
    case ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_6_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_6_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_12_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_12_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_13_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_13_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_0:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_0";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BIT_3:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BIT_3";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT0_TO_BIT1:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT0_TO_BIT1";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8_TO_BIT10:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8_TO_BIT10";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ONE_BIT9_TO_BIT10:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ONE_BIT9_TO_BIT10";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_1:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSHIFT_1";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_TDM_PMM_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TDM_PMM_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_EXTRACT_FTMH_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_EXTRACT_FTMH_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_EXTRACT_FTMH_PB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_EXTRACT_FTMH_PB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_MC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_EXTRACT_PPH_OFFSET:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_EXTRACT_PPH_OFFSET";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_FHEI:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_FHEI";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_STAMP_PPH:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_STAMP_PPH";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_PPH_FWD_CODE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_PPH_FWD_CODE";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_PP_MIM_32K_IVEC_CMD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_PP_MIM_32K_IVEC_CMD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_BUILD_PTCH_2B:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BUILD_PTCH_2B";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OLP_PETRA_A:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OLP_PETRA_A";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_SIZE:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_SIZE";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_LSBYTES:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_LSBYTES";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_2";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_TM_ACTION_IS_MC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_TM_ACTION_IS_MC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OUT_PP_PORT:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OUT_PP_PORT";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_DP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_DP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OTMH_MC_CUD_EXTRACT_MC_CUD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OTMH_MC_CUD_EXTRACT_MC_CUD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_IPV6_EXTRACT_FTMH:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_IPV6_EXTRACT_FTMH";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_APLUS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_APLUS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_NTP:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_NTP";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_SP_5_0:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_SP_5_0";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_ZERO_4_MSB:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_ZERO_4_MSB";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_LSB_MPLS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_LSB_MPLS";
        break;
    case ARAD_EGR_PROG_EDITOR_LFEM_MSB_MPLS:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_MSB_MPLS";
        break;
	case ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_2:
        *lfem_name = "ARAD_EGR_PROG_EDITOR_LFEM_BITS_1_2";
        break;
    default:
        *lfem_name = "Unknown LFEM";
        break;
    }
}


void
  arad_egr_prog_editor_print_all_programs_data(int unit)
{
    int program_id, lfem_map, lfem_idx, lfem;
    char* prog_name;
    char* lfem_name;

    for (program_id = 0; program_id < ARAD_EGR_PROG_EDITOR_PROG_NOF_PROGS; program_id++) {
        arad_egr_prog_editor_prog_name_get_by_id(program_id, &prog_name);
        if (programs[unit][program_id].prog_used != -1) {
            LOG_CLI((BSL_META_U(unit,
                                "========================================================================\n")));
            LOG_CLI((BSL_META_U(unit,
                                "program %d: %s\n"), program_id, prog_name));
            LOG_CLI((BSL_META_U(unit,
                                "selected program: %d\n"), programs[unit][program_id].prog_used));
            LOG_CLI((BSL_META_U(unit,
                                "entries used: %d, %d\n"), _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(program_id), _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(program_id)));
            LOG_CLI((BSL_META_U(unit,
                                "LFEMS used:\n")));
            for (lfem_map = 0; lfem_map < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); lfem_map++) {
                for (lfem_idx = 0; lfem_idx < ARAD_PP_EG_PROG_NOF_FEM(unit); lfem_idx++) {
                    lfem = programs[unit][program_id].lfem_bk[lfem_map][lfem_idx];
                    if (lfem < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS) {
                        /* Get LFEM name */
                        arad_egr_prog_editor_lfem_name_get_by_id(lfem, &lfem_name);

                        LOG_CLI((BSL_META_U(unit,
                                            "    Map: %d, Entry: %d, LFEM: %s\n"), lfem_map, lfem_idx, lfem_name));
                    }
                }
            }
        }
    }
}

void
  arad_egr_prog_editor_print_lfem_duplicates(
     int unit
  ) {

    uint8 
        lfems[ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS][2];
    int
        i,j,k;
    char
        *lfem_name,
        array_num_buf[8];

    /* Init lfems array */
    for (i = 0; i < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS; i++) {
        lfems[i][0] = 0; /* Appearances in lfem shadow arrays counter */
        lfems[i][1] = 0; /* In which arrays they appear bitmap */
    }

    /* Count loads of LFEMs and mark where are they loaded to */
    for (i = 0; i < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); i++) {
        for (j = 0; j < ARAD_PP_EG_PROG_NOF_FEM(unit); j++) {
            if (lfem_maps_shadow[unit][i][j] == ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS) {
                /* no more entries in this shadow array */
                break;
            }
            else {
                lfems[lfem_maps_shadow[unit][i][j]][0]++;
                lfems[lfem_maps_shadow[unit][i][j]][1] |= (0x01 << i);
            }
        }
    }

    LOG_CLI((BSL_META_U(unit,
                        "\n\r\n\r")));

    /* Print duplicates */
    for (i = 0; i < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS; i++) {
        if (lfems[i][0] > 1) {
            /* LFEM is loaded to more than 1 array */

            /* Get LFEM name */
            arad_egr_prog_editor_lfem_name_get_by_id(i, &lfem_name);

            /* Get LFEM used arrays string */
            k = 0;
            for (j = 0; j < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); j++) {
                if (lfems[i][1] & (0x01 << j)) {
                    array_num_buf[k++] = ' ';
                    array_num_buf[k++] = '0' + j;
                }
            }
            array_num_buf[k] = '\0';

            LOG_CLI((BSL_META_U(unit,
                                "FIX HINT: Duplicate load of %s to:%s\n\r"), lfem_name, array_num_buf));
        }
    }

    LOG_CLI((BSL_META_U(unit,
                        "\n\r\n\r")));

}

void
  arad_egr_prog_editor_print_chosen_program(int unit, uint32 first_instruction)
{
    int program_id;
    char* prog_name=NULL;

    for (program_id = 0; program_id < ARAD_EGR_PROG_EDITOR_PROG_NOF_PROGS; program_id++) {
        if (_ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(program_id) == first_instruction) {
            if (prog_name!=NULL) {
                LOG_CLI((BSL_META_U(unit,
                                    "OR\n")));
            }
            arad_egr_prog_editor_prog_name_get_by_id(program_id, &prog_name);
            LOG_CLI((BSL_META_U(unit,
                                "Program %s was selected\n"), prog_name));
        }
    }

    if (prog_name==NULL) {
        LOG_CLI((BSL_META_U(unit,
                            "Defalt NULL program was selected\n")));
    }
}

STATIC uint32
  arad_egr_prog_editor_allocate_program(
    SOC_SAND_IN int unit ,
    SOC_SAND_IN  ARAD_EGR_PROG_EDITOR_PROGRAMS                                 prog
  )
{
  int i,j;
  int tm_profile_already_allocated = 0;

  SOC_SAND_INIT_ERROR_DEFINITIONS(ARAD_EGR_PROG_EDITOR_ALLOCATE_PROGRAM_AND_ITS_LFEMS);

  /* Init program's bookkeeping */
  for (i = 0; i < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); i++) {
      for (j = 0; j < ARAD_PP_EG_PROG_NOF_FEM(unit); j++) {
          programs[unit][prog].lfem_bk[i][j] = ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS;
      }
  }

  /* alloc program number */
  programs[unit][prog].prog_used = ++last_program_id[unit];
  if (last_program_id[unit] > SOC_DPP_EGR_PROG_EDITOR_MAX_PROGRAM(unit)) {
     SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_PROGRAMS_ERR, 10, exit);
  }

  if (prog == ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH) {
      goto exit; /* OTMH lfems and instructions were already allocated */
  }

  /* alloc instruction entries */
  programs[unit][prog].program_pointer = ++last_program_pointer[unit];
  if (last_program_pointer[unit] >= ARAD_EGR_PROG_EDITOR_MAX_INSTRUCTION_ENTRIES/2) {
      SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_INSTRUCTION_ENTRIES_ERR, 40, exit);
  }

  /* alloc tm profile */
  if(programs_usage[unit].user_header_always_remove) {
      /* Add here any other programs in which non-Ethernet packet can be sent to an Ethernet port and require using remove-system-headers program */
      if (programs[unit][prog].tm_profile == ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG) {
          tm_profile_already_allocated = 1;
      }
  }

  if ((programs[unit][prog].tm_profile != -1) && (!tm_profile_already_allocated)) {
      if (tm_profiles[unit][(programs[unit][prog].tm_profile)] == -1) {
          /* this tm_profile has not been allocated yet - alloc */
          tm_profiles[unit][(programs[unit][prog].tm_profile)] = ++last_tm_profile[unit];

          if (last_tm_profile[unit] > tm_profiles_available[unit]) {
              SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_TM_PROFILES_ERR, 60, exit);
          }
      }
  }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_allocate_program()",0,0);
}

/* 
 * init all programs[unit] usage info:
 */
STATIC uint32
  arad_egr_prog_editor_programs_alloc(
     SOC_SAND_IN  int                                 soc_petrab_cfg,
     SOC_SAND_IN  int                                 unit
  )
{
  uint32 res;
  int arad_prog_editor_otmh_keep_pph_port_present;
  int pp_port;

  SOC_SAND_INIT_ERROR_DEFINITIONS(ARAD_EGR_PROG_EDITOR_ALLOCATE_PROGRAMS_AND_LFEMS_ALLOC);


  if(programs_usage[unit].user_header_always_remove) {
      tm_profiles[unit][ARAD_PRGE_TM_SELECT_ETH_REMOVE_SYSTEM_HEADERS] = ARAD_PRGE_TM_SELECT_NOF_PROFILES/2 + 1;

      /* Add here any other programs in which non-Ethernet packet can be sent to an Ethernet port and require using remove-system-headers program */
      tm_profiles[unit][ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG] = ARAD_PRGE_TM_SELECT_NOF_PROFILES/2;

      tm_profiles_available[unit] = ARAD_PRGE_TM_SELECT_NOF_PROFILES/2;
  }
  else {
      tm_profiles_available[unit] = ARAD_PRGE_TM_SELECT_NOF_PROFILES;
  }

  /* start with default programs that should always exist */
  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OTMH);
  SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);

  arad_prog_editor_otmh_keep_pph_port_present=0;
  for (pp_port = 0; pp_port < ARAD_PORT_NOF_PP_PORTS; pp_port++) {
      if (soc_property_suffix_num_get(unit, pp_port, spn_CUSTOM_FEATURE, "otmh_keep_pph_", 0) == 1) {
          arad_prog_editor_otmh_keep_pph_port_present = 1;
      }
      if (soc_property_port_suffix_num_get(unit, pp_port, -1, spn_CUSTOM_FEATURE, "vendor_custom_tm_port", FALSE) == 1) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING);
          SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
      }
      if (soc_property_port_suffix_num_get(unit, pp_port, -1, spn_CUSTOM_FEATURE, "vendor_custom_pp_port", FALSE) == 1) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING);
          SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
      }

  }

    /* Allocating BFD echo program based on soc property and if the device is ARAD+*/ 
  if((programs_usage[unit].bfd_echo) && SOC_IS_ARADPLUS(unit)){
	  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  } 

  if (arad_prog_editor_otmh_keep_pph_port_present) {
      if (!soc_petrab_cfg) { 
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH);
          SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
      }
  }

  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
  SOC_SAND_CHECK_FUNC_RESULT(res, 15, exit);

  /* Allocating 4_LABEL_PUSH program based on soc property*/ 
  if((soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ext_ipv4_mpls_extended_fwd_table_size", 0)) ||
	 (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "ext_ipv6_extended_fwd_table_size", 0))){
	  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }


  /* Allocating UDH header copy program based on system port header type configuration */
  if ((SOC_DPP_CONFIG(unit)->pp.udh_port_exists))
  {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 25, exit);
  }

  if ((!SOC_IS_ARADPLUS(unit) && (SOC_DPP_CONFIG(unit)->pp.next_hop_mac_extension_enable))
      || (SOC_IS_ARADPLUS(unit) && (SOC_IS_NEXT_HOP_MAC_EXT_ARAD_COMPATIBLE(unit))))
    {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);

      if (programs_usage[unit].xgs_pp) {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP);
          SOC_SAND_CHECK_FUNC_RESULT(res, 21, exit);
    }
  }
  
  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER);
  SOC_SAND_CHECK_FUNC_RESULT(res, 35, exit);



  /* vxlan support use program for version under arad+. Arad+ support vcxlan by design. */
  if (SOC_IS_ARAD_B1_AND_BELOW(unit) && programs_usage[unit].vxlan) {
      
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_VXLAN);
      SOC_SAND_CHECK_FUNC_RESULT(res, 45, exit);
  }

  if (programs_usage[unit].rspan) {
      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN);
      SOC_SAND_CHECK_FUNC_RESULT(res, 65, exit);

      if (programs_usage[unit].xgs_pp) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS);
          SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
      }
  }

  if (programs_usage[unit].erspan) {
      if (SOC_IS_ARAD_B1_AND_BELOW(unit)) {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA);
          SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
      }
      else {
          res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ERSPAN);
          SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
      }

      if (programs_usage[unit].xgs_pp) {
          if (SOC_IS_ARAD_B1_AND_BELOW(unit)) {
              res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH);
              SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
          }
          else {
              res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA);
              SOC_SAND_CHECK_FUNC_RESULT(res, 55, exit);
          }
      }
  }


  if (programs_usage[unit].mpls_swap) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_MPLS_SWAP_COUPLING);
      SOC_SAND_CHECK_FUNC_RESULT(res, 75, exit);
  }

  if (programs_usage[unit].xgs_tm) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE);
      SOC_SAND_CHECK_FUNC_RESULT(res, 85, exit);
  }

  if (programs_usage[unit].xgs_pp) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 95, exit);
      
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD);
      SOC_SAND_CHECK_FUNC_RESULT(res, 100, exit);
  }

  if (programs_usage[unit].epon) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG);
      SOC_SAND_CHECK_FUNC_RESULT(res, 105, exit);
  }
  
  if (programs_usage[unit].ipv6_tunnel) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL);
      SOC_SAND_CHECK_FUNC_RESULT(res, 115, exit);
  }

  if (programs_usage[unit].oam_loopback) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit); 
  }

  if (programs_usage[unit].oam_ts_ccm) {
      if (programs_usage[unit].oam_ts_ccm_fhei_2) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM_UP_MEP_TRAP_2_FHEI);
          SOC_SAND_CHECK_FUNC_RESULT(res, 145, exit);
      } else {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM);
          SOC_SAND_CHECK_FUNC_RESULT(res, 145, exit);

      }

      res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP);
      SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);

	  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 145, exit);
	  if (SOC_IS_ARAD_B0_AND_ABOVE(unit)) {
		  /* 1588 stamping not supported in Arad A0.*/
		  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP);
		  SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
	  }

      if (programs_usage[unit].oam_dm_down) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
          if (SOC_IS_ARAD_B0_AND_ABOVE(unit)) {
              /* 1588 stamping not supported in Arad A0.*/
              res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP);
              SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
          }

      } 
      if (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "egress_snooping_advanced", 0)) {
          res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO);
          SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit); 
      }
      
  }

  if (programs_usage[unit].tdm_pmm) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM);
      SOC_SAND_CHECK_FUNC_RESULT(res, 165, exit);
  }

  if (programs_usage[unit].tdm_stamp_cud) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD);
      SOC_SAND_CHECK_FUNC_RESULT(res, 175, exit);
  }
 
  if (programs_usage[unit].tdm) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 185, exit);
  }

  if (programs_usage[unit].stacking) { 
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_STACKING);
      SOC_SAND_CHECK_FUNC_RESULT(res, 205, exit);    
  }

  if (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode == ARAD_MGMT_FTMH_LB_EXT_MODE_FULL_HASH) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC);
      SOC_SAND_CHECK_FUNC_RESULT(res, 205, exit);    
  }

  if (programs_usage[unit].two_hop_scheduling) { 
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING);
      SOC_SAND_CHECK_FUNC_RESULT(res, 215, exit);    
  }

  if (programs_usage[unit].l2_remote_cpu) { 
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU);
      SOC_SAND_CHECK_FUNC_RESULT(res, 225, exit);    
  }

  if (programs_usage[unit].otmh_cud) { 
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD);
      SOC_SAND_CHECK_FUNC_RESULT(res, 235, exit);
  }

  if (programs_usage[unit].size_header) { 
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER);
      SOC_SAND_CHECK_FUNC_RESULT(res, 235, exit);
  }

  if (SOC_IS_ARADPLUS(unit) &&  SOC_IS_ROO_ENABLE(unit) ) { 
	  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 235, exit);
  }



  /* 
   * PTCH for Overlay application. Currently enabled for Trill and MIM.
   * PTCH2 will also be used when needed to direct to routing recycle destination.
   */
  if (programs_usage[unit].trill || (SOC_DPP_CONFIG(unit)->arad->pp_op_mode.mim_enable) || 
      (SOC_DPP_CONFIG(unit)->pp.ipv6_with_rpf_2pass_exists)) { 
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2);
      SOC_SAND_CHECK_FUNC_RESULT(res, 245, exit);
  }

  if (programs_usage[unit].vmac_enable) { 
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM);
      SOC_SAND_CHECK_FUNC_RESULT(res, 255, exit);

      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM);
      SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  }

  if (programs_usage[unit].olp_petra) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT);
      SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  }

  /* NULL program */
  
  #ifdef  ERASE_OR_DONT_BUT_REMOVE_THIS_MACRO
  res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_NULL);
  SOC_SAND_CHECK_FUNC_RESULT(res, 215, exit);
  #endif

  if (soc_property_get(unit, spn_RFC2544_REFLECTOR_MAC_AND_IP_SWAP_PORT, 0)) {
      res = arad_egr_prog_editor_allocate_program(unit,ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH);
      SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  } 
  if (soc_property_get(unit, spn_RFC2544_REFLECTOR_MAC_SWAP_PORT, 0)) {
	  res = arad_egr_prog_editor_allocate_program(unit, ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 265, exit);
  } 


exit:
  SOC_SAND_EXIT_AND_SEND_ERROR( "error in arad_egr_prog_editor_programs_alloc()",0,0);
}


uint32
  arad_egr_prog_editor_unsafe(
    SOC_SAND_IN  int                                 unit
  )
{
    uint32
      res = SOC_SAND_OK;

  SOC_SAND_INIT_ERROR_DEFINITIONS(ARAD_EGR_PROG_EDITOR_UNSAFE);

  SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  10,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, EPNI_LINK_FILTER_ENABLEr, SOC_CORE_ALL, 0, TM_OR_CPU_EEDB_FILTER_ENABLEf,  0x0));

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_unsafe()", 0, 0);
}


/* 
 * arad_egr_prog_editor_cat_nops
 * Concatenates nop instructions to the end of a program with less
 * than the needed instructions.
 * PARAMS:
 *   SOC_SAND_IN int mem        - first instructions table to write to
 *   SOC_SAND_IN int entry      - first entry in instruction table to write to
 *   SOC_SAND_IN int entry_even - even entries for this program
 *   SOC_SAND_IN int entry_odd  - odd entries for this program
 */
uint32
  arad_egr_prog_editor_cat_nops(
    SOC_SAND_IN int unit,
    SOC_SAND_IN int first_mem,
    SOC_SAND_IN int first_entry,
    SOC_SAND_IN int entry_even,
    SOC_SAND_IN int entry_odd
  )
{

    uint32 
        res;
    int
        mem = first_mem,
        entry = first_entry;
    ARAD_PP_EPNI_PRGE_INSTRUCTION_TBL_DATA 
        prge_instruction_tbl_data;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    /* Init NOP command */
    prge_instruction_tbl_data.src_select  = 0;
    prge_instruction_tbl_data.offset_base = 0;
    prge_instruction_tbl_data.offset_src  = 0;
    prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.size_base   = 0;
    prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value    = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action  = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action  = 0;
    prge_instruction_tbl_data.dst_select  = 0;

    while (mem < EPNI_PRGE_INSTRUCTION_0m + ARAD_PP_EG_PROG_NOF_INSTR_MEMS(unit)) {
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data); 
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
    }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_cat_nops()", mem, entry);
}

/* 
 * arad_egr_prog_editor_load_required_lfems
 * Loads the required lfems to the HW according to the shadow lfem maps
 */
uint32
  arad_egr_prog_editor_load_required_lfems(
    SOC_SAND_IN int unit
  )
{
    ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  
        lfem_field_select_map_tbl_data;
    int
        i = 0, 
        j = 0, 
        res = 0;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    for (i = 0; i < ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit); i++) {
        for (j = 0; (j < ARAD_PP_EG_PROG_NOF_FEM(unit)) ; j++ )
        {
            if (lfem_maps_shadow[unit][i][j] < ARAD_EGR_PROG_EDITOR_LFEM_NOF_LFEMS) {
                /* Load LFEM to HW */
                lfem_map_action_to_lfem_field_select_map(lfem_maps_shadow[unit][i][j], &lfem_field_select_map_tbl_data);
                res = arad_epni_lfem_field_select_map_tbl_set_unsafe(unit, i, j, &lfem_field_select_map_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);
            }
            else {
                /* No more allocations in this map */
                break;
            }
        }
    }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_load_required_lfems()", i, j);
}

uint32
  lfem_map_to_uint32(
    SOC_SAND_IN  lfem_map lfem
  )
{
    return ((lfem.val1 << 5) | lfem.val2);
}

void
  lfem_map_arr_to_lfem_field_select_map(
    SOC_SAND_IN  lfem_map lfem_arr[],
    SOC_SAND_OUT  ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  *tbl_data
  )
{
    tbl_data->lfem_field_select_map[0] = lfem_map_to_uint32(lfem_arr[15]) | 
                                         (lfem_map_to_uint32(lfem_arr[14]) << 6) | 
                                         (lfem_map_to_uint32(lfem_arr[13]) << 12) | 
                                         (lfem_map_to_uint32(lfem_arr[12]) << 18) | 
                                         (lfem_map_to_uint32(lfem_arr[11]) << 24) | 
                                         ((lfem_map_to_uint32(lfem_arr[10]) & 0x3) << 30);
    tbl_data->lfem_field_select_map[1] = ((lfem_map_to_uint32(lfem_arr[10]) & 0x3c) >> 2) | 
                                         (lfem_map_to_uint32(lfem_arr[9]) << 4) | 
                                         (lfem_map_to_uint32(lfem_arr[8]) << 10) | 
                                         (lfem_map_to_uint32(lfem_arr[7]) << 16) | 
                                         (lfem_map_to_uint32(lfem_arr[6]) << 22) | 
                                         ((lfem_map_to_uint32(lfem_arr[5]) & 0xf) << 28);
    tbl_data->lfem_field_select_map[2] = ((lfem_map_to_uint32(lfem_arr[5]) & 0x30) >> 4) | 
                                         (lfem_map_to_uint32(lfem_arr[4]) << 2) | 
                                         (lfem_map_to_uint32(lfem_arr[3]) << 8) | 
                                         (lfem_map_to_uint32(lfem_arr[2]) << 14) | 
                                         (lfem_map_to_uint32(lfem_arr[1]) << 20) | 
                                         (lfem_map_to_uint32(lfem_arr[0]) << 26);
}

/* 
 * Returns a 6 bit representation of the action,val pair in an lfem action representation.
 * action (idx_or_val_bit) is a 1 bit description of weather the value is a const or a pointer
 * to a bit in the 32 bit key of the lfem map.
 * the value is 5 bit.
 */
uint32
  lfem_couple_to_uint32(
    SOC_SAND_IN  uint8  value,
    SOC_SAND_IN  uint8  idx_or_val_bit
  )
{
    return ((idx_or_val_bit << 5) | value);
}

/*
 * Transform the action, value (x16) array to a 96 bit table data to load to the HW.
 */
void
  lfem_map_action_to_lfem_field_select_map(
    SOC_SAND_IN  ARAD_EGR_PROG_EDITOR_LFEM lfem_action,
    SOC_SAND_OUT  ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  *tbl_data
  )
{
    uint8* lfem_arr = &lfem_actions[lfem_action][1];
    tbl_data->lfem_field_select_map[0] = lfem_couple_to_uint32(lfem_arr[31], lfem_arr[30]) | 
                                         (lfem_couple_to_uint32(lfem_arr[29], lfem_arr[28]) << 6) | 
                                         (lfem_couple_to_uint32(lfem_arr[27], lfem_arr[26]) << 12) | 
                                         (lfem_couple_to_uint32(lfem_arr[25], lfem_arr[24]) << 18) | 
                                         (lfem_couple_to_uint32(lfem_arr[23], lfem_arr[22]) << 24) | 
                                         ((lfem_couple_to_uint32(lfem_arr[21], lfem_arr[20]) & 0x3) << 30);
    tbl_data->lfem_field_select_map[1] = ((lfem_couple_to_uint32(lfem_arr[21], lfem_arr[20]) & 0x3c) >> 2) | 
                                         (lfem_couple_to_uint32(lfem_arr[19], lfem_arr[18]) << 4) | 
                                         (lfem_couple_to_uint32(lfem_arr[17], lfem_arr[16]) << 10) | 
                                         (lfem_couple_to_uint32(lfem_arr[15], lfem_arr[14]) << 16) | 
                                         (lfem_couple_to_uint32(lfem_arr[13], lfem_arr[12]) << 22) | 
                                         ((lfem_couple_to_uint32(lfem_arr[11], lfem_arr[10]) & 0xf) << 28);
    tbl_data->lfem_field_select_map[2] = ((lfem_couple_to_uint32(lfem_arr[11], lfem_arr[10]) & 0x30) >> 4) | 
                                         (lfem_couple_to_uint32(lfem_arr[9], lfem_arr[8]) << 2) | 
                                         (lfem_couple_to_uint32(lfem_arr[7], lfem_arr[6]) << 8) | 
                                         (lfem_couple_to_uint32(lfem_arr[5], lfem_arr[4]) << 14) | 
                                         (lfem_couple_to_uint32(lfem_arr[3], lfem_arr[2]) << 20) | 
                                         (lfem_couple_to_uint32(lfem_arr[1], lfem_arr[0]) << 26);
}

void 
  header_editing_size_to_reg_val(
    SOC_SAND_IN  soc_reg_above_64_val_t val, 
    SOC_SAND_OUT soc_reg_above_64_val_t dest
  )
{
    SOC_REG_ABOVE_64_CLEAR(dest);

    dest[0] = val[0] | (val[1] << 7) | (val[2] << 14) | (val[3] << 21) | ((val[4] & 0xf) << 28);
    dest[1] = ((val[4] & 0x70) >> 4) | (val[5] << 3) | (val[6] << 10) | (val[7] << 17) | (val[8] << 24) | ((val[9] & 0x1) << 31);
    dest[2] = ((val[9] & 0x7E) >> 1) | (val[10] << 6) | (val[11] << 13) | (val[12] << 20) | ((val[13] & 0x1f) << 27);
    dest[3] = ((val[13] & 0x60) >> 5) | (val[14] << 2) | (val[15] << 9);  
}


/******************************************************************************/
/*                     basic_epni_tm_config */
/******************************************************************************/


uint32 
  arad_egr_prog_editor_basic_epni_tm_config(
    SOC_SAND_IN  int unit
  ) 
{
  int soc_petrab_cfg = 0; /* If this set PRGE will work in soc_petrab mode (Arad otherwise) */
  int tcam_line;
  int program_line;
  int mem;
  int entry,entry_odd, entry_even;
  int tdm_arad_opt, tdm_arad_std;
  ARAD_MGMT_TDM_MODE tdm_mode;
  uint8 is_petrab_in_system;
  int i, j;
  uint32 res;
  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA 
      prge_program_selection_cam_tbl_data;
  ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA 
      prge_program_tbl_data;
  ARAD_PP_EPNI_PRGE_INSTRUCTION_TBL_DATA 
      prge_instruction_tbl_data;
  soc_reg_above_64_val_t 
      header_editing_size, 
      header_editing_size_val;
  int is_1588 ; /* 1 -> 1588, 0 ->ntp*/
  int ftmh_size = 0;
  int reflector_with_ip;
  /* used for vxlan egress program config for version before arad+ */
  uint32 fld_val;
  

  uint32 nof_dynamic_members;

  uint32 user_header_size, user_header_0_size, user_header_1_size;
  uint32 user_header_egress_pmf_offset_0_dummy, user_header_egress_pmf_offset_1_dummy;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);


  res = arad_egr_prog_editor_validate_lfem_action_array(unit);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

  res = arad_pmf_db_fes_user_header_sizes_get(
             unit,
             &user_header_0_size,
             &user_header_1_size,
             &user_header_egress_pmf_offset_0_dummy,
             &user_header_egress_pmf_offset_1_dummy
           );
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

  user_header_size = (user_header_0_size + user_header_1_size) / 8;

  ftmh_size = ARAD_EGR_PROG_EDITOR_FTMH_TOTAL_SIZE ;
   
  if (SOC_IS_ARADPLUS(unit)) {
    if (soc_property_get(unit, spn_SCHEDULER_COMPENSATION_ENABLE, 0)) { 
      /*
       * Normally, user header is not included in the system header size. This way, the 
       * egress editor uses the user header size to know how many bytes to remove after the 
       * system header. 
       * When scheduling compensation feature is enabled, the user header is included in the 
       * system header size. In this case the header size used by the egress editor should be 0 
       * because the user header is removed as a part of the system header and not separately 
       * after the system header as done without scheduling compensation. 
       */
      user_header_size = 0;
    }
  }

  tdm_mode = arad_sw_db_tdm_mode_get(unit);
  is_petrab_in_system = arad_sw_db_is_petrab_in_system_get(unit);

  if (is_petrab_in_system) 
  {
    soc_petrab_cfg = 1;
  }

  tdm_arad_opt = (tdm_mode == ARAD_MGMT_TDM_MODE_TDM_OPT);
  tdm_arad_std = (tdm_mode != ARAD_MGMT_TDM_MODE_TDM_OPT);

  /*  Program selection cam - 24 lines */
  for (i = 5; i<24; i++) /* set all non valid lines to 0 */
  {
        res = arad_pp_epni_prge_program_selection_cam_tbl_get_unsafe(unit, i, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit); 
        prge_program_selection_cam_tbl_data.valid = 0;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, i, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit); 
  }

  /* init the programs info */
  arad_egr_prog_editor_programs_init(soc_petrab_cfg, unit);

  /* fill programs usgae info */
  arad_egr_prog_editor_programs_usage_init(unit);

  /* go over all porgrams that should be used and allocate program number and lfems:
   * if not enough programs or not enough lfems - return err
   */
  res = arad_egr_prog_editor_programs_alloc(soc_petrab_cfg, unit);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit); 

  /* Set value 1 offset in accordance with existing programs*/
  res = arad_egr_prg_editor_set_value_1_offset(unit);
  SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit); 

  /* This register enables LFEM entry 10 usage */
  SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  11,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, EPNI_PMC_PARITY_ENr, SOC_CORE_ALL, 0, PMC_PARITY_ENf,  0));

  tcam_line = -1;

    
  /* Config Program selection 0 : TM packet tm profile high bit 1 -> is remove-system-headers program */
  if(programs_usage[unit].user_header_always_remove) {
     if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER].prog_used != -1) {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
           SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
     	prge_program_selection_cam_tbl_data.fwd_code = PP_FWD_CODE_TM;
     	prge_program_selection_cam_tbl_data.fwd_code_mask = 0;
     	prge_program_selection_cam_tbl_data.prge_tm_profile = 0x8;
     	prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 0x7;
     	prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
     	prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
     	prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
     	prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
     	prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
     	prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
     	prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
     	prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
     	prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
     	prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
     	prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
     	prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
     	prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
     	prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
     	prge_program_selection_cam_tbl_data.valid = 1 ;
     	prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER].prog_used;
     	res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
     	SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
     }
  }

  /* Config Program selection 0 : VMAC_DOWNSTREAM */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM].prog_used != -1) {
    tcam_line++;
    if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
        SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
    }
    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
    prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
    prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
    prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
    prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
    prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
    prge_program_selection_cam_tbl_data.value_1              = ARAD_PRGE_PP_SELECT_VALUE_1_VMAC_DOWN_ADD;
    prge_program_selection_cam_tbl_data.value_1_mask              =0;
    prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
    prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
    prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
    prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
    prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
    prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
    prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
    prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
    prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
    prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
    prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.valid = 1 ;
    prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM].prog_used;
    res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  /* Config Program selection 0 : VMAC_UPSTREAM */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].prog_used != -1) {
    tcam_line++;
    if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
        SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
    }
    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
    prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
    prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ; 
    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
    prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
    prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
    prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
    prge_program_selection_cam_tbl_data.value_1              =ARAD_PRGE_PP_SELECT_VALUE_1_VMAC_UP_ADD;
    prge_program_selection_cam_tbl_data.value_1_mask              =0;
    prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
    prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
    prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
    prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
    prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
    prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
    prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
    prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
    prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
    prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
    prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.valid = 1 ;
    prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].prog_used;
    res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  /* Config Program selection 0 : MIM_PTCH2 */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2].prog_used != -1) {
    tcam_line++;
    if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
        SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
    }
    ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
    prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
    prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
    prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_RCY_OVERLAY;
    prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
    prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
    prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
    prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
    prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
    prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
    prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
    prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
    prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
    prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
    prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
    prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
    prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
    prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
    prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
    prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
    prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
    prge_program_selection_cam_tbl_data.valid = 1 ;
    prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2].prog_used;
    res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }

  /* Config Program selection 0 : MPLS_SWAP */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_MPLS_SWAP_COUPLING].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                 = PP_FWD_CODE_MPLS;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_MPLS_SWAP;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 15; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_MPLS_SWAP_COUPLING].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }
  
  /* Config Program selection 1 : XGS_PE_FROM_FRC_LITE */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FRC_LITE;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 7; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

      /*Program Selection - ERSPAN_XGS_PE_FROM_FTMH */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH].prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) 
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_SNOOP;    
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask       =0xf;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH_ERSPAN;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0 ;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt            = 0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH].prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

      /*Program Selection - ERSPAN_XGS_PE_FROM_FTMH no WA */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA].prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) 
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_SNOOP;    
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask       =0xf;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH; 
       prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0x1 ;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs            =ARAD_PRGE_DATA_ENTRY_LSBS_ERSPAN;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      =0;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt            = 0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA].prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }


    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS].prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) 
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.fwd_code                 = PP_FWD_CODE_SNOOP;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask       =0xf;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH; 
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 0x1 ;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x0;
        prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_RSPAN;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x0;
        prge_program_selection_cam_tbl_data.data_entry_cnt            = 1;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS].prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    /*Program Selection - XGS_MAC_EXT_AND_SPAN */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD].prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) 
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.fwd_code  = PP_FWD_CODE_SNOOP;/* mirror should be the same code as snoop*/
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH_SPAN; /*span+xgs new define in egq_env-def*/
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7 ;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD].prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

    /*Config Program selection 2 : XGS_PE_FROM_FTMH_ARP*/
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP].prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) 
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code_mask = 0 ;
        prge_program_selection_cam_tbl_data.fwd_code = 1 ;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
        prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       =0x01;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.oam_sub_type              =0x0;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask          =0x0;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
        prge_program_selection_cam_tbl_data.eei_valid                 = 0x1;
        prge_program_selection_cam_tbl_data.eei_valid_mask            = 0;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP].prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

  /* Config Program selection 2 : XGS_PE_FROM_FTMH */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x01;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 8; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
  }

  /* Config Program selection 3 : ETH_WITH_LLID_TAG */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);

      if (SOC_IS_ARAD_B1_AND_BELOW(unit)) {
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
          prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
          prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
          prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
          prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
          prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
          prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
          prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
          prge_program_selection_cam_tbl_data.data_entry_lsbs            = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
          prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
          prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
          /* prge_program_selection_cam_tbl_data.program                 = 11; */
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG].prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
      }
      else {
          if(programs_usage[unit].user_header_always_remove) {
              if (tm_profiles[unit][ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG] == -1) {
                  SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG is not allocated. \n\r")));
              }
              prge_program_selection_cam_tbl_data.prge_tm_profile            = tm_profiles[unit][ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG];
          }
          else {
              prge_program_selection_cam_tbl_data.prge_tm_profile            = ARAD_PRGE_TM_SELECT_ETH_WITH_LLID_TAG;
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0;
          prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
          prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x7;
          prge_program_selection_cam_tbl_data.fwd_code                  = 0x0;
          prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
          prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
          prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
          prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
          prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
          prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
          prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
          prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
          prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
          prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
          prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
          prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
          prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
          prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
          /* prge_program_selection_cam_tbl_data.program                 = 11; */
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG].prog_used;
          prge_program_selection_cam_tbl_data.valid                   = 0x1;
      }
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 40, exit); 
  }
  
  /* Config Program selection 4 : IPV6_TUNNEL_PROGRAM */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_IPV6_TUNNEL;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 12; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 70, exit);
  }

  /* Config Program selection 5 : ETH_OAM_LOOPBACK */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_ETH_OAM_LOOPBACK;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0; 
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 14; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }


    	/*Config Program selection 6 :  oam_sub_type == 3*/
    for (is_1588 = 0; is_1588 <= 1; ++is_1588) {
        int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP :
                                              ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP; 
        if (programs[unit][prog_index].prog_used != -1) {
            tcam_line++;
            if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
                SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
            }
            ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
            prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
            prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15;
            prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 15;
            prge_program_selection_cam_tbl_data.system_mc_mask = 1;
            prge_program_selection_cam_tbl_data.pph_type_mask = 3;
            prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
            prge_program_selection_cam_tbl_data.oam_sub_type              = (is_1588 == 1)? 2:3;
            prge_program_selection_cam_tbl_data.oam_sub_type_mask = 0;
            prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
            prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
            prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
            prge_program_selection_cam_tbl_data.valid = 1;
            prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
            prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
            prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
            prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
            prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
            prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
            prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
            prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
            prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
            prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
            prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
            prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
            prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
            prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
            prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
            prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
            prge_program_selection_cam_tbl_data.program                 = programs[unit][prog_index].prog_used;
            res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
        }

    }

	/* Always below the equicalent up programs. (Up packets may incorrectly catch the down program but the other way around is not possible).*/
	for (is_1588 = 0; is_1588 <= 1; ++is_1588) {
		/*Config Program selection 6 : OAM Program according to PP port */
		int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP :
										  ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP;
		if (programs[unit][prog_index].prog_used != -1) {
			tcam_line++;
			if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
				SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
			}
			ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
			prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
			prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15;
			prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0;
			prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1; /* Ignore the First bit. 
                                                                                                                Select only packets destined to the OAMP (PP profile 1) or CPU (PP profile 0)*/
			prge_program_selection_cam_tbl_data.system_mc_mask = 1;
			prge_program_selection_cam_tbl_data.pph_type = 0x2; /* PPH type: oam-TS present*/
			prge_program_selection_cam_tbl_data.pph_type_mask = 0x1; /* PPH type: Look at the OAM-TS bit*/
			prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
			prge_program_selection_cam_tbl_data.oam_sub_type_mask = 7;
			prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
			prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
			prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
			prge_program_selection_cam_tbl_data.valid = 1;
			prge_program_selection_cam_tbl_data.value_1_mask              = ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_MASK;
			prge_program_selection_cam_tbl_data.value_1              = (is_1588) ? ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_1588_DOWN :
																				   ARAD_EGR_PROG_EDITOR_VALUE_1_OAM_TS_NTP_DOWN;
			prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
			prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
			prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
			prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
			prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
            prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
            prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
            prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
            prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
            prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
            prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
            prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
            prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
            prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
            prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
			prge_program_selection_cam_tbl_data.program                 = programs[unit][prog_index].prog_used;
			res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
		}
	}

		/*Config Program selection 6 :  oam_sub_type == 1*/
	if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP].prog_used != -1) 
	{
		tcam_line++;
		if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) 
		{
			SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
		}
		ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
		prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
		prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
		prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 15 ;
		prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
		prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
		prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
		prge_program_selection_cam_tbl_data.oam_sub_type = 1 ;
		prge_program_selection_cam_tbl_data.oam_sub_type_mask = 0 ;
		prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
		prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
		prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
		prge_program_selection_cam_tbl_data.valid = 1 ;
		prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
		prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
		prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
		prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
		prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
		prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
		prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP].prog_used;
		res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
	}
	

  /* Config Program selection 7 : OAM Program oam_sub_type == 4 (CCM) */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x4;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x1; /* loopback packets should also select this program*/
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 13; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 110, exit);
  }

    /*Config Program selection 7 : OAM Program oam_sub_type == 4*/
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM_UP_MEP_TRAP_2_FHEI].prog_used != -1) 
    {
        tcam_line++;
        if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) 
        {
            SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
        }
        ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
        prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask = 15 ;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask  = 7;
        prge_program_selection_cam_tbl_data.ace_variable = 2 ;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 0 ;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM_UP_MEP_TRAP_2_FHEI].prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
    }

	if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO].prog_used != -1) 
	{
		tcam_line++;
		if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) 
		{
			SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
		}
		ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
		
		prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
		prge_program_selection_cam_tbl_data.prge_tm_profile_mask       =0xf;
		prge_program_selection_cam_tbl_data.prge_pp_profile_mask       =0xf;
		prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
		prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
		prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
		prge_program_selection_cam_tbl_data.oam_sub_type              = ARAD_PP_OAM_SUBTYPE_EGRESS_SNOOP;
		prge_program_selection_cam_tbl_data.oam_sub_type_mask          =0x0;
		prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
		prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
		prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
		prge_program_selection_cam_tbl_data.valid = 1 ;
		prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
		prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
		prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
		prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
		prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
		prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
		prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO].prog_used;
		res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
	}


    /* Config Program selection : BFD ECHO */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }

      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           =ARAD_PRGE_PP_SELECT_PP_OAM_PORT; /* ARAD_PRGE_PP_SELECT_PP_COPY_HEADER; */
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1; /*fix 0*/
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
	  prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;     
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);

  }


  /* Config Program selection 9 : epni_prge_config_erspan */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_SNOOP;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_ERSPAN;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x0;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt            = 0x1;
      /* no copy paste error */
      /* coverity[copy_paste_error] */
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x0;
      /* prge_program_selection_cam_tbl_data.program                = 15; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

  /* Config Program selection 10 : epni_prge_config_rspan */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_RSPAN].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile            = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask             = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask              = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask             = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask          = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask             = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask               = 0xff;
      prge_program_selection_cam_tbl_data.first_enc_mask             = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask            = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.fwd_code                   = PP_FWD_CODE_SNOOP;
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_lsbs            = ARAD_PRGE_DATA_ENTRY_LSBS_RSPAN;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_cnt             = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x0;
      /* prge_program_selection_cam_tbl_data.program                 = 12; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_RSPAN].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

  /* Config Program selection 9 : epni_prge_config_erspan */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = PP_FWD_CODE_SNOOP;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER_ERSPAN;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt            = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x3;
      /* prge_program_selection_cam_tbl_data.program                = 15; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }



  /* Config Program selection 11 : epni_prge_config_span */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile            = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER_SPAN;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask             = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask              = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask             = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask          = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask             = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask               = 0xff;
      prge_program_selection_cam_tbl_data.first_enc_mask             = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask            = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.fwd_code                   = PP_FWD_CODE_SNOOP;
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 2; remove system_header (must) */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }

  /* Config Program selection 11 : epni_prge_config_span */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
        prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
        prge_program_selection_cam_tbl_data.prge_tm_profile_mask = 15 ;
        prge_program_selection_cam_tbl_data.prge_pp_profile            = ARAD_PRGE_PP_SELECT_PP_OLP_PORT;
        prge_program_selection_cam_tbl_data.prge_pp_profile_mask       =0x0;
        prge_program_selection_cam_tbl_data.system_mc_mask = 1 ;
        prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
        prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
        prge_program_selection_cam_tbl_data.oam_sub_type_mask          =0x7;
        prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
        prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
        prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
        prge_program_selection_cam_tbl_data.valid = 1 ;
        prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
        prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
        prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
        prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
        prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
        prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT].prog_used;
        res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN].prog_used != -1)  {
	  tcam_line++; 
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
	  /*Config Program selection 9 : DC-Overlays - VxLAN Plus-F5*/
	  prge_program_selection_cam_tbl_data.fwd_code                 = 1; /* UC IPv4*/
	  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
	  prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
	  prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
	  prge_program_selection_cam_tbl_data.system_mc_mask = 1;
	  prge_program_selection_cam_tbl_data.pph_type_mask = 3;
	  prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
	  prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
	  prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
	  prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
	  prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
	  prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_ROO_VXLAN; /* LL-Eth*/
	  prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
	  prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
	  prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
	  prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
	  prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
	  prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN].prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

	  /*Config Program selection 10 : DC-Overlays - VxLAN  Plus-F5*/
	  tcam_line++;
	  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
		  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
	  }
	  prge_program_selection_cam_tbl_data.fwd_code                 = 2; /* MC IPv4*/
	  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
	  prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
	  prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
	  prge_program_selection_cam_tbl_data.system_mc_mask = 1;
	  prge_program_selection_cam_tbl_data.pph_type_mask = 3;
	  prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
	  prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
	  prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
	  prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
	  prge_program_selection_cam_tbl_data.valid = 1;
	  prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
	  prge_program_selection_cam_tbl_data.data_entry_lsbs           = ARAD_PRGE_DATA_ENTRY_LSBS_ROO_VXLAN; /* LL-Eth*/
	  prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x0;
	  prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
	  prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
	  prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
	  prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
	  prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN].prog_used;
	  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);

  }


  /* Config Program selection : VXLAN
     for version under arad+. Arad+ support VxLAN by design. */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VXLAN].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                   = 0x0;
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc                = ARAD_PRGE_EPNI_ETPP_SCND_ENC_TYPE_IP; /* second encapsulation is IPV4 */
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VXLAN].prog_used;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);
  }

  /* Config Program selection 12 : copy etpp new header (default with arp ext) */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_ODD_LFEMS_ERR, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0x0;
      prge_program_selection_cam_tbl_data.fwd_code              = 0x1;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid                 = 0x1;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 4; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }

  /* Config Program selection: copy User Defined Header */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER_WITH_USER_HEADERS;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 4; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 135, exit);
  }  

  for (reflector_with_ip=0 ; reflector_with_ip<=1 ; ++reflector_with_ip) {
	  ARAD_EGR_PROG_EDITOR_PROGRAMS used_program = reflector_with_ip? ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH :
		  ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH;
	  if (programs[unit][used_program].prog_used != -1) {
		  tcam_line++;
		  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
			  SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
		  }
		  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);

		  prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
		  prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles[unit][programs[unit][used_program].tm_profile]; 
		  prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
		  prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
		  prge_program_selection_cam_tbl_data.system_mc_mask = 1;
		  prge_program_selection_cam_tbl_data.pph_type_mask = 3;
		  prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
		  prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
		  prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
		  prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
		  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
		  prge_program_selection_cam_tbl_data.valid = 1;
		  prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
		  prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
		  prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
		  prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
		  prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
		  prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
          prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
          prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
          prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
          prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
		  prge_program_selection_cam_tbl_data.program                 = programs[unit][used_program].prog_used;
		  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
		  SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
	  }
  }


  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
      prge_program_selection_cam_tbl_data.prge_tm_profile = tm_profiles[unit][programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING].tm_profile]; ; /*TmProfile = 10, could be changed */
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask = 1;
      prge_program_selection_cam_tbl_data.pph_type_mask = 3;
      prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
      prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING].prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }
  
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);

      prge_program_selection_cam_tbl_data.fwd_code_mask = 15;
      prge_program_selection_cam_tbl_data.prge_tm_profile = tm_profiles[unit][programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING].tm_profile]; ; /*TmProfile = 10, could be changed */
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask = 1;
      prge_program_selection_cam_tbl_data.pph_type_mask = 3;
      prge_program_selection_cam_tbl_data.fhei_size_mask = 3;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask = 3;
      prge_program_selection_cam_tbl_data.eei_valid_mask = 1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1;
      prge_program_selection_cam_tbl_data.valid = 1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING].prog_used;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
  }

  /* Config Program selection : 4_label_push */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0; 
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 4; */
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
	  /* check whether learn extenssion (eei2) exists*/
	  prge_program_selection_cam_tbl_data.learn_ext_exist = 0x1;
	  prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 0;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }



  /* Config Program selection 12 : copy etpp new header (default) */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask              = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0xf;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_PP_COPY_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
	  prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;     
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 130, exit);
  }  

  /* Config Program selection 13 : OTMH CUD and extensions */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 0x0;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      if(programs_usage[unit].user_header_always_remove) {
          if (tm_profiles[unit][ARAD_PRGE_TM_SELECT_OTMH_WITH_CUD_EXT] == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_OTMH_WITH_CUD_EXT is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles[unit][ARAD_PRGE_TM_SELECT_OTMH_WITH_CUD_EXT];
      }
      else {
          prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_OTMH_WITH_CUD_EXT;
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 1; */
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }

  /* Config Program selection : OTMH BASE and extensions, keep PPH */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 0xe;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      if(programs_usage[unit].user_header_always_remove) {
          if (tm_profiles[unit][ARAD_PRGE_TM_SELECT_OTMH_BASE] == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_OTMH_BASE is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles[unit][ARAD_PRGE_TM_SELECT_OTMH_BASE];
      }
      else {
          prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_OTMH_BASE;
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_OTMH_BASE_KEEP_PPH;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 1; */
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }

 

  /* Config Program selection 13 : OTMH BASE and extensions */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 0xe;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      if(programs_usage[unit].user_header_always_remove) {
          if (tm_profiles[unit][ARAD_PRGE_TM_SELECT_OTMH_BASE] == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_OTMH_BASE is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles[unit][ARAD_PRGE_TM_SELECT_OTMH_BASE];
      }
      else {
          prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_OTMH_BASE;
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_OTMH_BASE;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 1; */
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 140, exit);
  }

  /* Config Program selection 14 : removing system headers */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      if(programs_usage[unit].user_header_always_remove) {
          if (tm_profiles[unit][ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER] == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles[unit][ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER];
      }
      else {
          prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_REMOVE_SYSTEM_HEADER;
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_REMOVE_SYSTEM_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 2; */
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 150, exit);
  }

  /* Config Program selection 15 : TDM FTMH */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                 = 0xe;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      if(programs_usage[unit].user_header_always_remove) {
          if (tm_profiles[unit][ARAD_PRGE_TM_SELECT_REMOVE_TDM_OPT_FTMH] == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_REMOVE_TDM_OPT_FTMH is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles[unit][ARAD_PRGE_TM_SELECT_REMOVE_TDM_OPT_FTMH];
      }
      else {
          prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_REMOVE_TDM_OPT_FTMH;
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_REMOVE_TDM_OPT_FTMH;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask       = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask          = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask       = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      /* prge_program_selection_cam_tbl_data.program                 = 3; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 160, exit);
  }

  /* Config Program selection 16 : TDM PMM */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code                  = 0xe;
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0x0;
      if(programs_usage[unit].user_header_always_remove) {
          if (tm_profiles[unit][ARAD_PRGE_TM_SELECT_TDM_PMM_HEADER] == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_TDM_PMM_HEADER is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles[unit][ARAD_PRGE_TM_SELECT_TDM_PMM_HEADER];
      }
      else {
          prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_TDM_PMM_HEADER;
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_TDM_PMM_HEADER;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      /* prge_program_selection_cam_tbl_data.program                 = 5; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 170, exit);
  }

  /* Config Program selection 18 : TDM_STAMP_CUD */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      if(programs_usage[unit].user_header_always_remove) {
          if (tm_profiles[unit][ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD] == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles[unit][ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD];
      }
      else {
          prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_TDM_STAMP_CUD;
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc                 = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 10; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);
  }

  /* Config Program selection 19 : 2_HOP_SCHEDULING */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      if(programs_usage[unit].user_header_always_remove) {
          if (tm_profiles[unit][ARAD_PRGE_TM_SELECT_PP_RCY_PORT] == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_PP_RCY_PORT is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles[unit][ARAD_PRGE_TM_SELECT_PP_RCY_PORT];
      }
      else {
          prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_PP_RCY_PORT;
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 190, exit);
  }

  /* Config Program selection 20 : STACKING */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      if(programs_usage[unit].user_header_always_remove) {
          if (tm_profiles[unit][ARAD_PRGE_TM_SELECT_STACKING] == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_STACKING is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles[unit][ARAD_PRGE_TM_SELECT_STACKING];
      }
      else {
          prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_STACKING;
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile           = ARAD_PRGE_PP_SELECT_TDM_STAMP_CUD;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.system_mc                 = 0x1;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x0;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask       = 0x3;
      /* prge_program_selection_cam_tbl_data.program                 = 7; */
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 210, exit);
  }

  	/*--------------------------------------------*/
	/* Stacking program with UC selection*/
	if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC].prog_used != -1) 
	{
		tcam_line++;
		if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) 
		{
			SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
		}
		ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
		/*Config Program selection 16 : STACKING*/
		prge_program_selection_cam_tbl_data.fwd_code_mask = 15 ;
		prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_STACKING;
		prge_program_selection_cam_tbl_data.prge_tm_profile_mask       =0x0;
		prge_program_selection_cam_tbl_data.prge_pp_profile           =0x0;
		prge_program_selection_cam_tbl_data.prge_pp_profile_mask       =0x0;
		prge_program_selection_cam_tbl_data.system_mc = 0 ;
		prge_program_selection_cam_tbl_data.system_mc_mask = 0 ;
		prge_program_selection_cam_tbl_data.pph_type_mask = 3 ;
		prge_program_selection_cam_tbl_data.fhei_size_mask = 3 ;
		prge_program_selection_cam_tbl_data.oam_sub_type              =0x0;
		prge_program_selection_cam_tbl_data.oam_sub_type_mask          =0x0;
		prge_program_selection_cam_tbl_data.ace_variable_mask = 3 ;
		prge_program_selection_cam_tbl_data.eei_valid_mask = 1 ;
		prge_program_selection_cam_tbl_data.learn_ext_exist_mask = 1 ;
		prge_program_selection_cam_tbl_data.valid = 1 ;
		prge_program_selection_cam_tbl_data.value_1_mask              =0xff;
		prge_program_selection_cam_tbl_data.data_entry_lsbs_mask       =0x3;
		prge_program_selection_cam_tbl_data.first_enc_mask            =0x1;
		prge_program_selection_cam_tbl_data.second_enc_mask           =0x3;
		prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask =0x1;
		prge_program_selection_cam_tbl_data.data_entry_cnt_mask        =0x3;
        prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
        prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
        prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
        prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
		prge_program_selection_cam_tbl_data.program                 =programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC].prog_used;
		res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 80, exit);
	}


  /* Config Program selection 23 : L2_REMOTE_CPU */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      if(programs_usage[unit].user_header_always_remove) {
          if (tm_profiles[unit][ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU] == -1) {
              SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - program is loaded but tm profile ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU is not allocated. \n\r")));
          }
          prge_program_selection_cam_tbl_data.prge_tm_profile           = tm_profiles[unit][ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU];
      }
      else {
          prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU;
      }
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 210, exit); 
  }
  
  /* Config Program selection 24 : ADD PACKET SIZE HEADER */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER].prog_used != -1) {
      tcam_line++;
      if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
          SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
      }
      ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
      prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
      prge_program_selection_cam_tbl_data.prge_tm_profile           = ARAD_PRGE_TM_SELECT_ADD_PACKET_SIZE_HEADER;
      prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0x0;
	  prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0;
      prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0xf;
      prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
      prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
      prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
      prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
      prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
      prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x7;
      prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
      prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
      prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
      prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
      prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
      prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
      prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
      prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
      prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
      prge_program_selection_cam_tbl_data.program                 = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER].prog_used;
      prge_program_selection_cam_tbl_data.valid                   = 0x1;
      res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit); 
  }

  /* Config Program selection 22 : NULL program */
  tcam_line++;
  if (tcam_line > ARAD_EGR_PROG_EDITOR_PRGE_SELECTION_CAM_MAX_LINE) {
      SOC_SAND_SET_ERROR_CODE(ARAD_EGR_PROG_EDITOR_OUT_OF_SELECTION_CAM_LINES, 13, exit);
  }
  ARAD_PP_EPNI_PRGE_PROGRAM_SELECTION_CAM_TBL_DATA_init(&prge_program_selection_cam_tbl_data);
  prge_program_selection_cam_tbl_data.fwd_code_mask             = 0xf;
  prge_program_selection_cam_tbl_data.prge_tm_profile_mask      = 0xf;
  prge_program_selection_cam_tbl_data.prge_pp_profile           = 0x0;
  prge_program_selection_cam_tbl_data.prge_pp_profile_mask      = 0x0;
  prge_program_selection_cam_tbl_data.system_mc_mask            = 0x1;
  prge_program_selection_cam_tbl_data.pph_type_mask             = 0x3;
  prge_program_selection_cam_tbl_data.value_1_mask              = 0xff;
  prge_program_selection_cam_tbl_data.fhei_size_mask            = 0x3;
  prge_program_selection_cam_tbl_data.eei_valid_mask            = 0x1;
  prge_program_selection_cam_tbl_data.oam_sub_type              = 0x0;
  prge_program_selection_cam_tbl_data.oam_sub_type_mask         = 0x0;
  prge_program_selection_cam_tbl_data.ace_variable_mask         = 0x3;
  prge_program_selection_cam_tbl_data.learn_ext_exist_mask      = 0x1;
  prge_program_selection_cam_tbl_data.data_entry_lsbs_mask      = 0x3;
  prge_program_selection_cam_tbl_data.first_enc_mask            = 0x1;
  prge_program_selection_cam_tbl_data.second_enc_mask           = 0x3;
  prge_program_selection_cam_tbl_data.link_editor_entry_is_ac_mask = 0x1;
  prge_program_selection_cam_tbl_data.data_entry_cnt_mask        = 0x3;
  prge_program_selection_cam_tbl_data.routing_over_overlay = 0x0;
  prge_program_selection_cam_tbl_data.routing_over_overlay_mask = 0x0;
  prge_program_selection_cam_tbl_data.first_out_lif_profile_mask = 0x3f;
  prge_program_selection_cam_tbl_data.second_out_lif_profile_mask = 0x3f;
  prge_program_selection_cam_tbl_data.third_out_lif_profile_mask = 0x3f;
  prge_program_selection_cam_tbl_data.forth_out_lif_profile_mask = 0x3f;
  prge_program_selection_cam_tbl_data.first_out_lif_profile_valid_mask = 0x1;
  prge_program_selection_cam_tbl_data.second_out_lif_profile_valid_mask = 0x1;
  prge_program_selection_cam_tbl_data.third_out_lif_profile_valid_mask = 0x1;
  prge_program_selection_cam_tbl_data.forth_out_lif_profile_valid_mask = 0x1;
  prge_program_selection_cam_tbl_data.valid                   = 0x1;
  prge_program_selection_cam_tbl_data.program                 = 0x0;
  res = arad_pp_epni_prge_program_selection_cam_tbl_set_unsafe(unit, tcam_line, &prge_program_selection_cam_tbl_data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 200, exit);

 



  /*  Program table - 16 lines */

  /*  Program 0 - default program (does nothing) */
  program_line = 0; /* NULL program - aleays exists and always prog=0 */
  sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
  prge_program_tbl_data.program_pointer      = 0;
  COMPILER_64_ZERO(prge_program_tbl_data.program_var);
  prge_program_tbl_data.register_src         = 0;
  prge_program_tbl_data.remove_system_header  = 0;
  prge_program_tbl_data.remove_network_header = 0;
  prge_program_tbl_data.bytes_to_remove       = 0;
  res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, program_line, &prge_program_tbl_data);
  SOC_SAND_CHECK_FUNC_RESULT(res, 210, exit);

  /*  Program 1 - ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM].prog_used != -1) {
    prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM].program_pointer;
    COMPILER_64_ZERO(prge_program_tbl_data.program_var);
    prge_program_tbl_data.register_src         = 1;
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 1;
    prge_program_tbl_data.bytes_to_remove       = 0;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM].prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /*  Program 1 - ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].prog_used != -1) {
    prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].program_pointer;
    COMPILER_64_ZERO(prge_program_tbl_data.program_var);
    prge_program_tbl_data.register_src         = 1;
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 1;
    prge_program_tbl_data.bytes_to_remove       = 0;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /*  Program 1 - tm_profile = 1 (creates OTMH and removes FTMH) */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /*  Program 1 - tm_profile = 1 (creates OTMH and removes FTMH but no PPH) */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH].prog_used != -1) {
      /* Same program pointer as OTMH program */
      programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH].program_pointer = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH].program_pointer;

      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH].program_pointer; 
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 0;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size + ftmh_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_KEEP_PPH].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /*  Program 1 - tm_profile = 1 (creates OTMH and removes FTMH) CUD */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /*  Program 2 - tm_profile = 2 (Remove FTMH) */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = 0;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_SYSTEM_HEADER].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 230, exit);
  }

  /*  Program 3 - tm_profile = 3 (Remove TDM FTMH) */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = 0;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 0;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = (soc_petrab_cfg && tdm_arad_opt) ? 2:4; /* Optimize Petra-B is 2 Bytes */;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REMOVE_TDM_FTMH].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 240, exit);
  }

  /*  Program 4 -Ethernet copy (default) */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

   /*  Program - 4_label_push */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }


  /*  Program - BFD echo */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

   /*  Program - copy User Defined Headers  */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1; /* prepare regs src to generated headers */
      prge_program_tbl_data.remove_system_header  = 1; /* remove the system headers from the packet header */
      prge_program_tbl_data.remove_network_header = 1; /* remove the network headers from the packet header */
      prge_program_tbl_data.bytes_to_remove       = 0; /* The user defined headers in the network header removed as part of network_headers removal */
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 255, exit);
  }

  /*  Program 4 -Ethernet copy (default with arp ext)  */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 250, exit);
  }

  /*  Program 5 - tm_profile = 4 (TDM PMM) */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1; /* Remove FTMH header */
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 260, exit);
  }

  /* Program 7 - tm_profile = 6 (XGS_PE_FROM_FRC_LITE) */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 10 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 280, exit);
  }

  /* Program 8 - tm_profile = 7 (XGS_PE_FROM_FTMH) */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH].program_pointer;
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x010100);
      /*prge_program_tbl_data.program_var          = 0x010100;*/
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
  }

    /*Program 8 - tm_profile = 7 (XGS_PE_FROM_FTMH_ARP)*/
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP].program_pointer;
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x010100);
      /*prge_program_tbl_data.program_var          = 0x010100;*/
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 290, exit);
  }


    for (is_1588=0; is_1588<=1 ; ++is_1588) {
            /*Program 9 -  (OAM_TS_EXT)*/
        int prog_index = (is_1588==1)? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP: 
            ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP;
        if (programs[unit][prog_index].prog_used != -1) 
        {
            sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
            prge_program_tbl_data.program_pointer      = programs[unit][prog_index].program_pointer;
            /*prge_program_tbl_data.program_var          = {0x0,0xe8,0x0,0xe9}; */
            COMPILER_64_SET( prge_program_tbl_data.program_var,0,0xe000e0); 
            prge_program_tbl_data.register_src         = 0;
            prge_program_tbl_data.remove_system_header  = 1;
            prge_program_tbl_data.remove_network_header = 0;
            prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
            res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][prog_index].prog_used, &prge_program_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
        }
    }
    
	/*Program 9 - oam_sub_type = 3 (OAM_TS_EXT)*/
    for (is_1588=0; is_1588<=1 ; ++is_1588) {
        int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP :
                                              ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP; 
        if (programs[unit][prog_index].prog_used != -1) 
        {
            sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
            prge_program_tbl_data.program_pointer      = programs[unit][prog_index].program_pointer;
            /*prge_program_tbl_data.program_var          = {0x0,0xe8,0x0,0xe9}; */
            COMPILER_64_SET( prge_program_tbl_data.program_var,0,0xe000e0); 
            prge_program_tbl_data.register_src         = 0;
            prge_program_tbl_data.remove_system_header  = 1;
            prge_program_tbl_data.remove_network_header = 0;
            prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
            res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][prog_index].prog_used, &prge_program_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
        }
    }
	

/*Program 9 - oam_sub_type = 1 (OAM_TS_EXT)*/
		if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP].prog_used != -1) 
		{
			sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
			prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP].program_pointer;
			/*prge_program_tbl_data.program_var          = {0x0,0xe8,0x0,0x08}; (sic)*/
            COMPILER_64_SET( prge_program_tbl_data.program_var,0,0xe0000c); 
			prge_program_tbl_data.register_src         = 0;
			prge_program_tbl_data.remove_system_header  = 1;
			prge_program_tbl_data.remove_network_header = 0;
			prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
			res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP].prog_used, &prge_program_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
		}
		



  /* Program 10 - TDM_STAMP_CUD */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 0;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       =  tdm_arad_opt ? 4 : (tdm_arad_std  ? 9 : 0);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 310, exit);
  }
  
  /* Program 11 - ETH_WITH_LLID_TAG */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 320, exit);
  }
  
  /* Program 12 - IPV6_TUNNEL_PROGRAM */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL].program_pointer;
      /*prge_program_tbl_data.program_var          = {16'h0, ETH_TYPE_IPV6 (Eth-Type = 0x86dd), 4'h6 (version), 28'h0};*/
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0x86dd, 0x60000000);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 330, exit);
  }

  /* Program 13 - oam_sub_type = 4  */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM].program_pointer;
      /*prge_program_tbl_data.program_var          = {56'h0, 8'he0};*/
      /*prge_program_tbl_data.program_var          = 0xe0;*/
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0xe0);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 340, exit);
  }
  
  /*Program 13 - oam_sub_type = 4*/
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM_UP_MEP_TRAP_2_FHEI].prog_used != -1) 
  {
        sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
        prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM_UP_MEP_TRAP_2_FHEI].program_pointer;
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0xe0);
        prge_program_tbl_data.register_src         = 0;
        prge_program_tbl_data.remove_system_header  = 1;
        prge_program_tbl_data.remove_network_header = 0;
        prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
        res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM_UP_MEP_TRAP_2_FHEI].prog_used, &prge_program_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }


  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO].program_pointer;
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }
        

  /* Program 14 - pp_profile = ETH_OAM_LOOPBACK */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK].program_pointer;
      /*prge_program_tbl_data.program_var          = {56'h0, 8'h2};*/
      /*prge_program_tbl_data.program_var          = 0x2;*/
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x2);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 24;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 350, exit);
  }
  
  /* Program 15 - MPLS_SWAP */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_MPLS_SWAP_COUPLING].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_MPLS_SWAP_COUPLING].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 4;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_MPLS_SWAP_COUPLING].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 360, exit);
  }



  /* Program - STACKING */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0 ;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 390, exit);
  }

  /*Program 7 - STACKING PROGRAM*/
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      =  programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 0;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }


  /* Program - erspan */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN].program_pointer;
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      /* prog var includes version 1, Vlan = 0 */   
      COMPILER_64_SET(prge_program_tbl_data.program_var,0,0x1000);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);
  }


  /* Program - erspan */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA].program_pointer;
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.remove_system_header  = 1;
      /* prog var includes version 1, Vlan = 0 */   
      COMPILER_64_SET(prge_program_tbl_data.program_var,0,0x1000);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);
  }

  /* Program - rspan */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_RSPAN].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_RSPAN].program_pointer;
      prge_program_tbl_data.register_src         = 0;/* TM */
      prge_program_tbl_data.bytes_to_remove       = 12 + user_header_size;
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.remove_system_header  = 1; 
      /* prog var includes version 1, Vlan = 0   
      COMPILER_64_SET(prge_program_tbl_data.program_var,0,0x1000);*/
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_RSPAN].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
  }
  /* Program - VXLAN 
     for version under arad+. Arad+ support VxLAN by design. */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VXLAN].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer       = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VXLAN].program_pointer;
      prge_program_tbl_data.register_src          = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.remove_system_header  = 1; 
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0x55550800, 0x00001100);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VXLAN].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 420, exit);
  }

  /* Program - 2_HOP_SCHEDULING */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer       = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 0;
      prge_program_tbl_data.bytes_to_remove       = 4 + user_header_size; /* Remove second ITMH (The program builds new one) */
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.remove_system_header  = 1; 
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 430, exit);
  }

  /* Program - Remote CPU */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU].program_pointer;
      /*prge_program_tbl_data.program_var          = ARAD_PRGE_DATA_MEMORY_ENTRY_L2_REMOTE_CPU; */ /*0x3c*/
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, ARAD_PRGE_DATA_MEMORY_ENTRY_L2_REMOTE_CPU);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 0;/*Dont remove system header*/
      prge_program_tbl_data.remove_network_header = 0;/*Dont remove network header*/
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;/*Dont remove any number of bytes*/
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU].prog_used, 
                                                     &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 440, exit);
  }

  /* Program ERSPAN_XGS_PE_FROM_FTMH  */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH].prog_used != -1) 
  {
    sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
    prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH].program_pointer;
    COMPILER_64_SET(prge_program_tbl_data.program_var, 0x5550100, 18); /*here - the size of link layer - 14 or 18 and PPD 6LSB*/
    prge_program_tbl_data.register_src         = 1; /*to use the nwk headers, not system*/
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 0;
    prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH].prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /* Program 10 RSPAN_XGS */
  /* Program ERSPAN_XGS_PE_FROM_FTMH no WA */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA].prog_used != -1) 
  {
    sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
    prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA].program_pointer;
    COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x101000); /* first 2LSBytes used in ERSPAN, all 8bytes in ppd */
    prge_program_tbl_data.register_src         = 1; /*to use the nwk headers, not system*/
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 0;
    prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA].prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS].prog_used != -1) 
  {
    sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
    prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS].program_pointer;
    COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x10100);  
    prge_program_tbl_data.register_src         = 0;
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 0;
    prge_program_tbl_data.bytes_to_remove       = 12 + user_header_size;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS].prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  /* Program -  XGS_MAC_EXT_AND_SPAN */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD].prog_used != -1) {
        sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
        prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD].program_pointer;
        COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x10100);
        prge_program_tbl_data.register_src         = 1;
        prge_program_tbl_data.remove_system_header  = 1;
        prge_program_tbl_data.remove_network_header = 0;
        prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
        res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD].prog_used, &prge_program_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 450, exit);
  }

  /* Program 4 -Ethernet copy*/
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2].prog_used != -1) {
    prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2].program_pointer;
    COMPILER_64_ZERO(prge_program_tbl_data.program_var);
    prge_program_tbl_data.register_src         = 1;
    prge_program_tbl_data.remove_system_header  = 1;
    prge_program_tbl_data.remove_network_header = 0;
    prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;
    res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2].prog_used, &prge_program_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }


/*Program 11  */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT].prog_used != -1) 
    {
        sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
        prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT].program_pointer;
        COMPILER_64_ZERO(prge_program_tbl_data.program_var);
        prge_program_tbl_data.register_src         = 0;
        prge_program_tbl_data.remove_system_header  = 1;
        prge_program_tbl_data.remove_network_header = 0;
        prge_program_tbl_data.bytes_to_remove       = 6 ;
        res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT].prog_used, &prge_program_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
    }

	/* Program - Add Packet Size Header */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER].program_pointer;
      COMPILER_64_ZERO(prge_program_tbl_data.program_var);
      prge_program_tbl_data.register_src          = 1; /* PP */
      prge_program_tbl_data.remove_system_header  = 1;/* remove system header */
      prge_program_tbl_data.remove_network_header = 1;/* remove network header - will be compied using default PP program */
      prge_program_tbl_data.bytes_to_remove       = 0 + user_header_size;/*Dont remove any number of bytes*/
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER].prog_used, 
                                                     &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 660, exit);
  }


  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN].prog_used != -1) {
	  sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
	  prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN].program_pointer;
	  prge_program_tbl_data.register_src         = 1;
	  prge_program_tbl_data.remove_system_header  = 1;
	  prge_program_tbl_data.remove_network_header = 1;
	  prge_program_tbl_data.bytes_to_remove       = 0;
	  res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN].prog_used, &prge_program_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }

  for (reflector_with_ip = 0; reflector_with_ip <= 1; ++reflector_with_ip) {
	  ARAD_EGR_PROG_EDITOR_PROGRAMS used_program = reflector_with_ip ? ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH :
																	   ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH;

	  if (programs[unit][used_program].prog_used != -1) {
		  sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
		  prge_program_tbl_data.program_pointer      = programs[unit][used_program].program_pointer;
		  prge_program_tbl_data.register_src         = 1;
		  COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x80);
		  prge_program_tbl_data.remove_system_header  = 1;
		  prge_program_tbl_data.remove_network_header = 1;
		  prge_program_tbl_data.bytes_to_remove       = 14 *reflector_with_ip ; /* 0 for Eth only, 14 for IP+Eth*/
		  res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][used_program].prog_used, &prge_program_tbl_data);
		  SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
	  }
  }
    
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING].program_pointer;
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x8000);
      prge_program_tbl_data.register_src         = 0;
      prge_program_tbl_data.remove_system_header  = 1; /* removing Arad System headers*/
      prge_program_tbl_data.remove_network_header = 0;
      prge_program_tbl_data.bytes_to_remove       = 2; /* strip 2 MSBytes from iNPHeader*/
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }


  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING].prog_used != -1) {
      sal_memset(&prge_program_tbl_data, 0, sizeof(ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA));
      prge_program_tbl_data.program_pointer      = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING].program_pointer;
      COMPILER_64_SET(prge_program_tbl_data.program_var, 0, 0x4000);
      prge_program_tbl_data.register_src         = 1;
      prge_program_tbl_data.remove_system_header  = 1; /* removing Arad System headers*/
      prge_program_tbl_data.remove_network_header = 1;
      prge_program_tbl_data.bytes_to_remove       = 0;
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 220, exit);
  }



  /*  Instruction tables - 12 tables (494 instructions, table 0 - 32 entries, tables 1..11 - 42 entries) */

  /*  Program 0 instructions (entries 0, 1 in each table) */
  SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, EPNI_PRGE_INSTRUCTION_0m, 0, 0, 1) );

  /*  Program 1 instructions (entries 2, 3 in each table) - OTMH */
  mem   = EPNI_PRGE_INSTRUCTION_0m - 1;

  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD].prog_used != -1) {

      /* OTMH program with 24bit CUD extention */
            entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD);
            entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD);
            entry = entry_odd;
            
            /*  Instruction 0 : load rsz=31 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 79;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);
            
            /*  Instruction 1 : extract the outlif value bit[0],r3=1 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_base = 57; /* resolved data outlif */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 1;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 390, exit);
            
            /*  Instruction 2 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);
            
            /*  Instruction 3 : rsz = (fem==r3) ? 25 : rsz */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 76;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R3;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x2;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
            
            /*  Instruction 4 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 5 : copy EEI data to CUD */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_base = 1;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 420, exit);

            /*  Instruction 6 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 430, exit);
            
            /*  Instruction 7 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
          /* Base OTMH */
            /*  Instruction 8 : extract TC from FTMH */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0; /* orig header */
            prge_instruction_tbl_data.offset_base = 5; /* 20 bits - take TC */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 9 : Extract DP, Action Type, MC from FTMH */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0; /* orig header */
            prge_instruction_tbl_data.offset_base = 13; /* 52 bits - take DP, Action Type, MC */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH_CUD, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 10 : r2=fem(tc) */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 11 : r3=fem(dp,action_type,mc) */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  Instruction 12 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select   = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 13 : r1=r2+r3 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0; 
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R3;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
          /* take out-pp-port (destination) */
            /*  Instruction 14 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2; /* resolved data */
            prge_instruction_tbl_data.offset_base = 113; /* 128+324 bits - out-PP-port */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 15 : copy r1 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2; /* resolved data */
            prge_instruction_tbl_data.offset_base = 55; /* 128+556+16+16+16 bits - R1*/
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            /*  For this program set all other instructions to NULL */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
  }
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OTMH].prog_used != -1){ /* basic OTMH */

          /* Arad OTMH */
            mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
          /* Store all addresses and jump to CUD Extension or NOP and prepare next jumps */
            entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_OTMH);
            entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_OTMH);
            entry = entry_odd;            

            /*  Instruction 0 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;  /* resolved data */
            prge_instruction_tbl_data.offset_base = 53; /* 128+20+32+32 bits - port var [9:0] in resolved data */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);
            
            /*  Instruction 1 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;  /* resolved data */
            prge_instruction_tbl_data.offset_base = 50; /* 128+20+32+20 bits - port var [21:12] in resolved data */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 2;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 390, exit);
            
            /*  Instruction 2 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 13;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_EXTRACT_FTMH_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_3,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);
            
            /*  Instruction 3 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 410, exit);
            
            /*  Instruction 4 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x2;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 5 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 420, exit);

          /* CUD Extension with no check for MC/UC traffic */
            /*  Instruction 6 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            entry = 40;
            prge_instruction_tbl_data.src_select  = 2;
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_EES_DATA1;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            }
            else if (programs_usage[unit].two_hop_scheduling) {
                prge_instruction_tbl_data.src_select  = 0;
                prge_instruction_tbl_data.offset_base = 17; /* FTMH Out-LIF */
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            }
            else {
                prge_instruction_tbl_data.offset_base = 57; /* 128+20+32+32+16 bits from resolved data - CUD */
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            }
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 430, exit);
            
            /*  Instruction 7 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            entry = 41;
            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_EES_DATA1-4; /* data action 1 [20:16] */
            }
            else if (programs_usage[unit].two_hop_scheduling) {
                prge_instruction_tbl_data.src_select  = 0;
                prge_instruction_tbl_data.offset_base = 13; /* FTMH Out-LIF */
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            }
            else {
                prge_instruction_tbl_data.offset_base = 55; /* 128+556+16+16+16 bits - R1 */
            }
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            }
            else {
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            }
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 8 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 4;
            entry = 40;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 32;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 9 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 4;
            entry = 41;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* CUD Extension only if MC traffic */
            /*  Instruction 6 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            entry = 32;
            prge_instruction_tbl_data.src_select  = 2;
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_EES_DATA1;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            }
            else {
                prge_instruction_tbl_data.offset_base = 57; /* 128+20+32+32+16 bits from resolved data - CUD */
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            }
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 430, exit);
            
            /*  Instruction 7 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            entry = 33;
            prge_instruction_tbl_data.src_select  = 2;
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_EES_DATA1-4; /* data action 1 [20:16] */
            }
            else {
                prge_instruction_tbl_data.offset_base = 55; /* 128+556+16+16+16 bits - R1 */
            }
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base   = 0x1f; /* -1 */
            if (SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_CUD_EXTENSION_MODE) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_5_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            }
            else {
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            }
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 8 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 4;
            entry = 32;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 32;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 9 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 4;
            entry = 33;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* MC-ID Extension - Not used */
            /*  Instruction 6 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            entry = 38;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 17; /* 68 bits from orig data - MC-ID [15:0] */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 7 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            entry = 39;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 17; /* 68 bits from orig data - MC-ID [18:16] */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_NULL,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_MC_CUD_EXTRACT_MC_CUD,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 8 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 4;
            entry = 38;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 32;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 9 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 4;
            entry = 39;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* NOP */
            /*  Instruction 6 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            entry = entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 7 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 3;
            entry = entry_odd;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 8 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 4;
            entry = entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 32;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 9 : */
            mem   = EPNI_PRGE_INSTRUCTION_0m + 4;
            entry = entry_odd;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* Source Port Extension */
            /*  Instruction 10 : */
            mem = EPNI_PRGE_INSTRUCTION_0m + 5;
            entry = 40;
            prge_instruction_tbl_data.src_select  = 
#ifdef  ERASE_OR_DONT_BUT_REMOVE_THIS_MACRO /* Do not use OTMH in Petra-B mode since ITMH in Petra-B mode is not implemented */
                (soc_petrab_cfg == 1) ? 0 : 
#endif
                2;
            prge_instruction_tbl_data.offset_base = 
#ifdef  ERASE_OR_DONT_BUT_REMOVE_THIS_MACRO /* Do not use OTMH in Petra-B mode since ITMH in Petra-B mode is not implemented */
                (soc_petrab_cfg == 1) ? 8 : 
#endif
                43; /* 128+556 bits - Source Port from resolved */
            prge_instruction_tbl_data.offset_src  = 
#ifdef  ERASE_OR_DONT_BUT_REMOVE_THIS_MACRO /* Do not use OTMH in Petra-B mode since ITMH in Petra-B mode is not implemented */
                (soc_petrab_cfg == 1) ? ARAD_PP_PRGE_ENG_OFFSET_CONST_0 : 
#endif
                ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 2;
            /* Instruction 10/2 = 5%2 = 1 --> odd lfem */
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_13_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_NULL,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 11 : */
            mem = EPNI_PRGE_INSTRUCTION_0m + 5;
            entry = 41;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* NOP */
            /*  Instruction 10 : */
            mem = EPNI_PRGE_INSTRUCTION_0m + 5;
            entry = entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 11 : */
            mem = EPNI_PRGE_INSTRUCTION_0m + 5;
            entry = entry_odd;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* Base OTMH */
            /*  Instruction 12 : */
            mem = EPNI_PRGE_INSTRUCTION_0m + 6;
            entry = entry_even;
            prge_instruction_tbl_data.src_select  = 0;  /* orig header */
            prge_instruction_tbl_data.offset_base = 5;  /* 20 bits - take TC */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_TC,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            }
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 13 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;  /* orig header */
            prge_instruction_tbl_data.offset_base = 13; /* 52 bits - take DP, Action Type, MC */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            if (soc_petrab_cfg == 1) {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP_PB,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OTMH_BASE_EXTRACT_DP,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            }
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 14 :  extract value for sop; r2=fem */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;
            prge_instruction_tbl_data.offset_base = 45;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 15 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 16 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  =  0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 17 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 0;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = 0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R3;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;  /* ADD */
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action  = 0x7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 18 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;  /* resolved data */
            prge_instruction_tbl_data.offset_base = 113; /* 128+324 bits - out-PP-port */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            if ((SOC_DPP_CONFIG(unit)->tm.mc_mode & DPP_MC_EGR_17B_CUDS_127_PORTS_MODE) != 0) {/*use_17b_mcid*/
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            } else {
                res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_NULL,
                        mem, ARAD_EGR_PROG_EDITOR_PROG_OTMH, &(prge_instruction_tbl_data.fem_select));
                SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            }

            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  Instruction 19 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;   /* resolved data */
            prge_instruction_tbl_data.offset_base = 55; /* 128+556+16+16+16 bits - R1 */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base   = 1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            /*  Instruction 20 :add the sop (rsz is holding the size) */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 2;   /* resolved data */
            prge_instruction_tbl_data.offset_base = 3; /* from Program Var takes 1Byte 0x00 */
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /*  For this program set all other instructions to NOP */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
  }

  if (soc_petrab_cfg)
  {
      /*  Program 2 instructions (entries 4, 5 in each table) - TDM PMM Petrab */ 
      if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM].prog_used != -1) {

          mem   = EPNI_PRGE_INSTRUCTION_0m-1;

          entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM);
          entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM);
          entry = entry_odd;

          /* Instruction 0 */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 8;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
          
          /* Instruction 1 */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 13;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_PMM_PB,
                  mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &(prge_instruction_tbl_data.fem_select));
          SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
          
          /* Instruction 2 */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = 0x7;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
          
          /* Instruction 3 */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = 0x7;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
          
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          for (i = mem; i<12+EPNI_PRGE_INSTRUCTION_0m; i++)
          {
            for (j = entry_even; j<=entry_odd; j++)
            {
                if (entry == entry_odd && i == mem)
                {
                    j = entry_odd;
                }
                
                prge_instruction_tbl_data.src_select  = 0;
                prge_instruction_tbl_data.offset_base = 0;
                prge_instruction_tbl_data.offset_src  = 0;
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.size_base   = 0;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select     = 0;
                prge_instruction_tbl_data.op_value    = 0;
                prge_instruction_tbl_data.op_2_field_select     = 0;
                prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                prge_instruction_tbl_data.op_3_field_select     = 0;
                prge_instruction_tbl_data.cmp_action  = 0;
                prge_instruction_tbl_data.dst_select  = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, i, j, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            }
          }
          
          /* Instruction 23 */
          mem   = EPNI_PRGE_INSTRUCTION_0m + 11;
          entry = entry_odd;
          
          prge_instruction_tbl_data.src_select  = 2;
          prge_instruction_tbl_data.offset_base = 59;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 4;
          res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_6_LSBS,
                  mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_PMM, &(prge_instruction_tbl_data.fem_select));
          SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /*  For this program set all other instructions to NULL */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
      }
  }

  /* Define Program instructions for Copy Generated Headers + build new mpls label from the learn extenssion (4_LABEL_PUSH)*/
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH].prog_used != -1) {
	  mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
	  entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH);
	  entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH);
	  entry = entry_odd;

	  /* Instruction 0; SZ = R3 ? R1 (number of bytes to copy from generated header)*/
	     
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;
	  
	  prge_instruction_tbl_data.src_select  = 0;
	  prge_instruction_tbl_data.offset_base = 0;
	  prge_instruction_tbl_data.offset_src  = 0;
	  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base   = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
	  prge_instruction_tbl_data.op_value    = 0;
	  prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action  = 0x7;
	  prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  /* Instruction 1; If R0=R1 (mpls is the fowarding) then SZ=4 */
	     
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;
	  
	  prge_instruction_tbl_data.src_select  = 0;
	  prge_instruction_tbl_data.offset_base = 0;
	  prge_instruction_tbl_data.offset_src  = 0;
	  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base   = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
	  prge_instruction_tbl_data.op_value    = 4;
	  prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
	  prge_instruction_tbl_data.cmp_action  = 0x2;
	  prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_SZ;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  /* Instruction 2; If R0=R1 then R1<-R2 (R1 will point to the end of the BOS label) */
	     
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;
	  
	  prge_instruction_tbl_data.src_select  = 0;
	  prge_instruction_tbl_data.offset_base = 0;
	  prge_instruction_tbl_data.offset_src  = 0;
	  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base   = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
	  prge_instruction_tbl_data.op_value    = 0;
	  prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_REG_R2;
	  prge_instruction_tbl_data.cmp_action  = 0x2;
	  prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  /* Instruction 3; If R0=R1 then R2<-R3 (R2 will point to the start of the BOS label) */
	     
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;
	  
	  prge_instruction_tbl_data.src_select  = 0;
	  prge_instruction_tbl_data.offset_base = 0;
	  prge_instruction_tbl_data.offset_src  = 0;
	  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base   = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
	  prge_instruction_tbl_data.op_value    = 0;
	  prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_REG_R3;
	  prge_instruction_tbl_data.cmp_action  = 0x2;
	  prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  /* copy from generated header, fowarding header + mpls bos label */
	  /* Copy generated header R3 = R3 - 16 */
	  /* instruction 4 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_GENERATED;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3; /* R3 point to the start of the generated headers */
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3; /* ALU Operation - Substract R3 by 16 */
	  prge_instruction_tbl_data.op_value        = 16;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



	  /* Copy generated header SZ = SZ - 16 */
	  /* instruction 5*/
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_GENERATED;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
	  prge_instruction_tbl_data.offset_base     = 0xF0; /* Offset the base by the number of Nibbles (8Bytes = 16Nibbles) */
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
	  prge_instruction_tbl_data.size_base       = 0x18;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ; /* ALU Operation - Substract SZ by 16 */
	  prge_instruction_tbl_data.op_value        = 16;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
	  
	  /* Extract System header Size */
	  /* instruction 6 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_RESOLVED;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
	  prge_instruction_tbl_data.offset_base     = 33; 
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  /* Copy generated header R3 = R3 - 16 */
	  /* instruction 7 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_GENERATED;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3; /* R3 point to the start of the generated headers */
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3; /* ALU Operation - Substract R3 by 16 */
	  prge_instruction_tbl_data.op_value        = 16;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      /* Copy generated header SZ = SZ - 16 & SZ = Network Header Size*/
	  /* instruction 8*/
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_GENERATED;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
	  prge_instruction_tbl_data.offset_base     = 0xF0; /* Offset the base by the number of Nibbles (8Bytes = 16Nibbles) */
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
	  prge_instruction_tbl_data.size_base       = 0x18;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD; 
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


	  /* Build 12 lsb of the new mpls header */
	  /* instruction 9 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_GENERATED;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
	  prge_instruction_tbl_data.offset_base     = 0; 
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
      res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_LSB_MPLS,
              mem, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, &(prge_instruction_tbl_data.fem_select));
      SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  /* NOP */
	  /* instruction 10*/
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = 0;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  /* Extract 4 bit LSB of the label Save Fem in R0*/
	  /* instruction 11 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_ORIGINAL;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
	  prge_instruction_tbl_data.offset_base     = 0; 
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0; 
      res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_MSB_MPLS,
              mem, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, &(prge_instruction_tbl_data.fem_select));
      SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
	  prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


	     /* NOP */
	  /* instruction 12 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = 0;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  /* R0=R0+FEM */
	  /* instruction 13*/
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = 0;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD; 
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  /* NOP - For port Ex. Extract Resolved.Data.tm-port-var*/
	  /* instruction 14 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select  = 2;    
	  prge_instruction_tbl_data.offset_base = 53; /* 128+32+32+20 bits - Resolved Data: tm-port-var */
	  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; /* 0 - offset to tm-port-var */
	  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base   = 0;
      res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
              mem, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, &(prge_instruction_tbl_data.fem_select));
      SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  
	  /* write R0 to header */
	  /* instruction 15 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_RESOLVED;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
	  prge_instruction_tbl_data.offset_base     = 59;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 2;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); 
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


	  /* write to header 16 msb of the mpls label - For port ex. Copy fem to SZ*/
	  /* instruction 16 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_ORIGINAL;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
	  prge_instruction_tbl_data.offset_base     = 0xff; /*0x1F; 0xff*/
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 2;
      res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_ZERO_4_MSB,
              mem, ARAD_EGR_PROG_EDITOR_PROG_4_LABEL_PUSH, &(prge_instruction_tbl_data.fem_select));
      SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
	  prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

	  /* copy from generated header, fowarding header + mpls bos label */
	  for(i=0; i<2; i++)
	  {
		  /* Copy generated header R1 = R1 - 16 */
		  /* instruction #17,#19*/
		  mem   = (entry == entry_odd) ? (mem + 1) : mem;
		  entry = (entry == entry_even) ? entry_odd : entry_even;
		  prge_instruction_tbl_data.src_select  = 1;
		  prge_instruction_tbl_data.offset_base = 0;
		  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R1; /*change to 1*/
		  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		  prge_instruction_tbl_data.size_base   = 0;/* 0; */
		  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
		  prge_instruction_tbl_data.op_value    = 16;
		  prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
		  prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
		  prge_instruction_tbl_data.cmp_action  = 0x7;
		  prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
		  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

		  /* Copy generated header */
		  /* instruction #18,#20 */
		  mem   = (entry == entry_odd) ? (mem + 1) : mem;
		  entry = (entry == entry_even) ? entry_odd : entry_even;

		  prge_instruction_tbl_data.src_select  = 1;
		  prge_instruction_tbl_data.offset_base = 0xF0;
		  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
		  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		  prge_instruction_tbl_data.size_base   = 0x18;
		  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		  prge_instruction_tbl_data.op_1_field_select     = 0;
		  prge_instruction_tbl_data.op_value    = 0;
		  prge_instruction_tbl_data.op_2_field_select     = 0;
		  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
		  prge_instruction_tbl_data.op_3_field_select     = 0;
		  prge_instruction_tbl_data.cmp_action  = 0;
		  prge_instruction_tbl_data.dst_select  = 0;
		  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 
		 
		 
	  }


	  /* instruction #21
	   * Copy Additional 1B based on the ARAD_PP_PRGE_ENG_SIZE_REG_SZ size
	   */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;
	  prge_instruction_tbl_data.src_select  = 2;
	  prge_instruction_tbl_data.offset_src  =  ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
	  prge_instruction_tbl_data.offset_base = 113;/* 128+324 bits - Resolved Data: out-PP-port */
	  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ; /* equal 1 if tm-port-var is equal 1. Calc in inst #21 */
	  prge_instruction_tbl_data.size_base   = 0; 
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*No FEM */;
	  prge_instruction_tbl_data.op_1_field_select     = 0;
	  prge_instruction_tbl_data.op_value    = 0;
	  prge_instruction_tbl_data.op_2_field_select     = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select     = 0;
	  prge_instruction_tbl_data.cmp_action  = 0;  /* Do not Perform ALU */
	  prge_instruction_tbl_data.dst_select  = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /*  For this program set all other instructions to NULL */
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;
      SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

  }

  /* Define Program instructions for bfd echo. if trap code = bcmRxTrapBfdEchoOverIpv4 swap dip and sip and set src.port=0xffff*/
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO].prog_used != -1) {

	  ARAD_SOC_REG_FIELD	strength_fld_fwd;                                                              
      ARAD_SOC_REG_FIELD    strength_fld_snp;
	  ARAD_PP_TRAP_CODE		trap_code = SOC_PPC_TRAP_CODE_BFD_ECHO;
	  ARAD_PP_TRAP_CODE_INTERNAL	internal_trap_code=0;					                                                              
      res = arad_pp_trap_mgmt_trap_code_to_internal(trap_code, &internal_trap_code, &strength_fld_fwd, &strength_fld_snp);  	
	  SOC_SAND_CHECK_FUNC_RESULT(res, 9999, exit); 


	  mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
	  entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO);
	  entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO);
	  entry = entry_odd;

	  /* Instruction 0; Extract FWD_HEADER_OFFSET. sz=640 (jump address)*/
	     
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_ORIGINAL;
	  prge_instruction_tbl_data.offset_base = 4;
	  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
	  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base   = 0;
	  res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_EXTRACT_PPH_OFFSET,
				 mem, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO, &(prge_instruction_tbl_data.fem_select));
      prge_instruction_tbl_data.op_1_field_select = 0;
      prge_instruction_tbl_data.op_value        = 640;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = 0;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 

	  /* Instruction 1; Extract trap code*/

      mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;


	  prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_ORIGINAL;
	  prge_instruction_tbl_data.offset_base = 0;
	  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
	  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base   = 0;
	  res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
              mem, ARAD_EGR_PROG_EDITOR_PROG_BFD_ECHO, &(prge_instruction_tbl_data.fem_select));
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


	  /* instruction 2; R0= FWD_HEADER_OFFSET */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = 0;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      /* Instruction 3; Check if trap code = bcmRxTrapBfdEchoOverIpv4 if not jump*/ 
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;
	  
	  prge_instruction_tbl_data.src_select  = 0;
	  prge_instruction_tbl_data.offset_base = 0;
	  prge_instruction_tbl_data.offset_src  = 0;
	  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base   = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
	  prge_instruction_tbl_data.op_value    = internal_trap_code; 
	  prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
	  prge_instruction_tbl_data.cmp_action  = 0x5; 
	  prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* instruction 4 - R1=0xffff (src port)  */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = 0;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select     = 0;
	  prge_instruction_tbl_data.op_value        = 0xffff;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* instruction 5 - R0= FWD_HEADER_OFFSET + R3  */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = 0;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* NOP */
	  /* instruction 6 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = 0;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      /* instruction 7 - (jump) Copy original header until UDP src port
		R0 = R0 ? 8 (points end of dip)
		*/

	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_ORIGINAL;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 6;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
	  prge_instruction_tbl_data.op_value        = 8;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      /* instruction 8 - Set src port */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_RESOLVED;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
	  prge_instruction_tbl_data.offset_base     = 55;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 2;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      /* instruction 9 - Set Sip. R0=R0-8B (points start of sip)*/

	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_ORIGINAL;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
	  prge_instruction_tbl_data.offset_base     = 0xf8;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 4;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
	  prge_instruction_tbl_data.op_value        = 8;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* instruction 10 - Set Dip */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_ORIGINAL;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 4;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      /* SZ= R0-R3*/
	  /* instruction 11 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = 0;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R3;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* NOP */
	  /* instruction 12 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = 0;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      /* Copy original header R0 = R0 - 16 */
	  /* instruction 13 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_ORIGINAL;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; 
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0; 
	  prge_instruction_tbl_data.op_value        = 16;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



	  /* Copy generated header SZ = SZ - 16 */
	  /* instruction 14*/
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_ORIGINAL;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
	  prge_instruction_tbl_data.offset_base     = 0xF0; 
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
	  prge_instruction_tbl_data.size_base       = 0x18;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ; 
	  prge_instruction_tbl_data.op_value        = 16;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


       /* R1= trap code = 0xe3 */
	  /* instruction 15 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = 0;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0xe3;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      /* Copy original header R0 = R0 - SZ */
	  /* instruction 16 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_ORIGINAL;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; 
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0; 
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



      /* Copy generated header  */
	  /* instruction 17*/
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_ORIGINAL;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
	  prge_instruction_tbl_data.offset_base     = 0xF0; 
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
	  prge_instruction_tbl_data.size_base       = 0x18;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); 
      prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
     
       
	  /* instruction 18 - Set trap code = 0xe3 = R1 R0=R0-1*/
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = ARAD_PP_PRGE_SRC_RESOLVED;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
	  prge_instruction_tbl_data.offset_base     = 55;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 1;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;                                                                            ;
	  prge_instruction_tbl_data.op_value        = 0x1;
	  prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
	  prge_instruction_tbl_data.cmp_action      = 0x7;
	  prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



      /* NOP */
	  /* instruction 19 */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;

	  prge_instruction_tbl_data.src_select      = 0;
	  prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
	  prge_instruction_tbl_data.offset_base     = 0;
	  prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
	  prge_instruction_tbl_data.size_base       = 0;
	  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
	  prge_instruction_tbl_data.op_1_field_select = 0;
	  prge_instruction_tbl_data.op_value        = 0;
	  prge_instruction_tbl_data.op_2_field_select = 0;
	  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
	  prge_instruction_tbl_data.op_3_field_select = 0;
	  prge_instruction_tbl_data.cmp_action      = 0;
	  prge_instruction_tbl_data.dst_select      = 0;
	  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
	  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      /* copy from original header*/
	  for(i=0; i<2; i++)
	  {
		  
		  /* instruction #20,#22,*/
		  mem   = (entry == entry_odd) ? (mem + 1) : mem;
		  entry = (entry == entry_even) ? entry_odd : entry_even;
		  prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_ORIGINAL;
		  prge_instruction_tbl_data.offset_base = 0;
		  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; 
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		  prge_instruction_tbl_data.size_base   = 0;
		  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		  prge_instruction_tbl_data.op_value    = 16;
		  prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
		  prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
		  prge_instruction_tbl_data.cmp_action  = 0x7;
		  prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
		  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

		  /* Copy original header */
		  /* instruction #21,#23, */
		  mem   = (entry == entry_odd) ? (mem + 1) : mem;
		  entry = (entry == entry_even) ? entry_odd : entry_even;

		  prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_ORIGINAL;
		  prge_instruction_tbl_data.offset_base = 0xF0;
		  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
		  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		  prge_instruction_tbl_data.size_base   = 0x18;
		  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		  prge_instruction_tbl_data.op_1_field_select     = 0;
		  prge_instruction_tbl_data.op_value    = 0;
		  prge_instruction_tbl_data.op_2_field_select     = 0;
		  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
		  prge_instruction_tbl_data.op_3_field_select     = 0;
		  prge_instruction_tbl_data.cmp_action  = 0;
		  prge_instruction_tbl_data.dst_select  = 0;
		  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 
		 
		 
	  }


      
	 
	  /*  For this program set all other instructions to NULL */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;
	  SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );


      /* Jump instructions - program reaches here if VID = 0x14 */

	  mem   = EPNI_PRGE_INSTRUCTION_3m - 1;
	  entry_odd = 41;
	  entry_even = 40;
	  entry = entry_odd;

      
      /* copy from original header*/
	  for(i=0; i<7; i++)
	  {
		  
		  /* instruction #20,#22,*/
		  mem   = (entry == entry_odd) ? (mem + 1) : mem;
		  entry = (entry == entry_even) ? entry_odd : entry_even;
		  prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_ORIGINAL;
		  prge_instruction_tbl_data.offset_base = 0;
		  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; 
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		  prge_instruction_tbl_data.size_base   = 0;
		  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		  prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		  prge_instruction_tbl_data.op_value    = 16;
		  prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
		  prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
		  prge_instruction_tbl_data.cmp_action  = 0x7;
		  prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
		  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

		  /* Copy original header */
		  /* instruction #21,#23, */
		  mem   = (entry == entry_odd) ? (mem + 1) : mem;
		  entry = (entry == entry_even) ? entry_odd : entry_even;

		  prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_ORIGINAL;
		  prge_instruction_tbl_data.offset_base = 0xF0;
		  prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
		  prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		  prge_instruction_tbl_data.size_base   = 0x18;
		  prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		  prge_instruction_tbl_data.op_1_field_select     = 0;
		  prge_instruction_tbl_data.op_value    = 0;
		  prge_instruction_tbl_data.op_2_field_select     = 0;
		  prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
		  prge_instruction_tbl_data.op_3_field_select     = 0;
		  prge_instruction_tbl_data.cmp_action  = 0;
		  prge_instruction_tbl_data.dst_select  = 0;
		  res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		  SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 
		 
		 
	  }


      /*  For this program set all other instructions to NULL */
	  mem   = (entry == entry_odd) ? (mem + 1) : mem;
	  entry = (entry == entry_even) ? entry_odd : entry_even;
	  SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );




  }
  /* Define Program instructions for Copy Generated Headers + User Defined Headers*/
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER].prog_used != -1) {

      mem   = EPNI_PRGE_INSTRUCTION_0m-1;
      
      entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER);
      entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER);
      entry = entry_odd;

      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      /* Prepare system headers size into R0 using Resolved fields                        */
      /* Need to reach 161 Nibbles from lsb of Resolved fields                            */
      /*   for that use 64B (=128 Nibbles) + 33                                           */
      /* Copy 0 bytes                                                                     */
      /*   size source 0 from offset + 0 bytes offset                                     */
      /* Use FEM to copy from the 32b (starting System-Headers-Size , EES-Data-1 ...)     */
      /* Need to map from the lsb the first 8 bits as is and the higher 8 maps constant 0 */
      
      /* instruction #0 */
      prge_instruction_tbl_data.src_select  = 2;    
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
      prge_instruction_tbl_data.offset_base = 33;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST; 
      prge_instruction_tbl_data.size_base   = 0; /* size with no offset */
      res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
              mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER_WITH_USER_HEADER, &(prge_instruction_tbl_data.fem_select));
      SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
      prge_instruction_tbl_data.op_1_field_select     = 0;
      prge_instruction_tbl_data.op_value    = 0;
      prge_instruction_tbl_data.op_2_field_select     = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = 0;
      prge_instruction_tbl_data.cmp_action  = 0;  /* Do not Perform ALU */
      prge_instruction_tbl_data.dst_select  = 0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* NOP */
      /* instruction #1 */
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = 0;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = 0;
      prge_instruction_tbl_data.cmp_action      = 0;
      prge_instruction_tbl_data.dst_select      = 0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* instruction #2 Set R0 with the System Header size calculated value from FEM result*/
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select  = 0;    
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
      prge_instruction_tbl_data.offset_base = 0;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST; 
      prge_instruction_tbl_data.size_base   = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /* No FEM */
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD; /* FEM Resuls from 2 instructions before */
      prge_instruction_tbl_data.op_value    = 0;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;  /* Always*/
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0; /* R0 value is the system header size WITHOUT the UDH */
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* NOP */
      /* instruction #3 */
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = 0;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = 0;
      prge_instruction_tbl_data.cmp_action      = 0;
      prge_instruction_tbl_data.dst_select      = 0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* definition of 18 instructions - copy Generated Headesr*/
      for( ++mem ; mem < EPNI_PRGE_INSTRUCTION_0m + 11; mem++)
      {
          /* instructions 4,6,8,10,12,14,16,18,20*/
          entry = (entry == entry_even) ? entry_odd : entry_even;

          prge_instruction_tbl_data.src_select  = 1;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3; /* R3 point to the start of the generated headers */
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST; /* The size to copy */
          prge_instruction_tbl_data.size_base   = 0; /* size with no offset */
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3; /* ALU Operation - Substract R3 by 16 */
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = 0x7;  /* Perform ALU Always */
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          entry = (entry == entry_even) ? entry_odd : entry_even;
          
         /* instructions 5,7,9,11,13,15,17,19,21*/
          prge_instruction_tbl_data.src_select  = 1;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.offset_base = 0xF0; /* Offset the base by the number of Nibbles (8Bytes = 16Nibbles) */
          prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? 0x18 : 0;   
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0; /* No ALU Operation */
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
      }

      /* Copy the user defined from the Packet Header */
      entry = (entry == entry_even) ? entry_odd : entry_even;

      /* Instruction 22*/
      prge_instruction_tbl_data.src_select  = 0;
      /* Use System Headers size set to R0 from Inst #3 */
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; /* R0: All System Headers size. (FTMH + PPH) in Nibble and all possible extensions */
      prge_instruction_tbl_data.offset_base = 0x0 + user_header_size*2 ; /* Add additional 2 Bytes (4 Nibbeles) for User Header*/
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base   = 0 + user_header_size;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = 0; /* No ALU Operation */
      prge_instruction_tbl_data.op_value    = 0;
      prge_instruction_tbl_data.op_2_field_select     = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = 0;
      prge_instruction_tbl_data.cmp_action  = 0;
      prge_instruction_tbl_data.dst_select  = 0;      
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /*  For this program set all other instructions to NULL */
      mem   = (entry == entry_odd) ? (mem + 1) : mem;
      entry = (entry == entry_even) ? entry_odd : entry_even;
      SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

  } /* end of program to copy generated headers + user defined headers */

  if ((SOC_DPP_CONFIG(unit)->pp.mim_vsi_mode) == 0) {
  
      if ((SOC_DPP_CONFIG(unit)->pp.port_extender_map_lc_exists) == 1) {
              /*  Program 3 instructions (entries 6, 7 in each table) - Ethernet Copy */ 
          entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
          entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);

          for(mem = EPNI_PRGE_INSTRUCTION_0m; mem < EPNI_PRGE_INSTRUCTION_0m + 9; mem++)
          {
              entry = entry_even;
              
              prge_instruction_tbl_data.src_select  = 1;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
              prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = 0;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
              prge_instruction_tbl_data.op_value    = 16;
              prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
              prge_instruction_tbl_data.cmp_action  = 0x7;
              prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

              entry = entry_odd;
              
              prge_instruction_tbl_data.src_select  = 1;
              prge_instruction_tbl_data.offset_base = 0xF0;
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
              prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? 0x18 : 0;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = 0;
              prge_instruction_tbl_data.op_value    = 0;
              prge_instruction_tbl_data.op_2_field_select     = 0;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = 0;
              prge_instruction_tbl_data.cmp_action  = 0;
              prge_instruction_tbl_data.dst_select  = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
          }
          /* Instraction #18 NOP */
          entry = (entry == entry_even) ? entry_odd : entry_even;
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

          /* Instraction #19 - Extract Resolved.Data.tm-port-var (1B)*/
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;

          prge_instruction_tbl_data.src_select  = 2;    
          prge_instruction_tbl_data.offset_base = 53; /* 128+32+32+20 bits - Resolved Data: tm-port-var */
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; /* 0 - offset to tm-port-var */
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                  mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &(prge_instruction_tbl_data.fem_select));
          SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
          prge_instruction_tbl_data.op_1_field_select = 0;
          prge_instruction_tbl_data.op_value          = 0;
          prge_instruction_tbl_data.op_2_field_select = 0;
          prge_instruction_tbl_data.alu_action        = 0;
          prge_instruction_tbl_data.op_3_field_select = 0;
          prge_instruction_tbl_data.cmp_action        = 0;
          prge_instruction_tbl_data.dst_select        = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

          /* Instraction #20 - NOP */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 400, exit);

          /* Instraction #21 
           * ALU operation with LFEM op_value added dest to R_Size
           */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value          = 0;
          prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
          prge_instruction_tbl_data.alu_action        = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action        = 0x7; /* always */
          prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_SZ; /* R_Size */
          /* prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_R2; */
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

          /* Instraction #22 - NOP */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select = 0;
          prge_instruction_tbl_data.op_value          = 0;
          prge_instruction_tbl_data.op_2_field_select = 0;
          prge_instruction_tbl_data.alu_action        = 0;
          prge_instruction_tbl_data.op_3_field_select = 0;
          prge_instruction_tbl_data.cmp_action        = 0;
          prge_instruction_tbl_data.dst_select        = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /* instruction #23
           * Copy Additional 1B based on the ARAD_PP_PRGE_ENG_SIZE_REG_SZ size
           */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
          entry = (entry == entry_even) ? entry_odd : entry_even;
          prge_instruction_tbl_data.src_select  = 2;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
          prge_instruction_tbl_data.offset_base = 113; /* 128+324 bits - Resolved Data: out-PP-port */
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ; /* equal 1 if tm-port-var is equal 1. Calc in inst #21 */
          prge_instruction_tbl_data.size_base   = 0; 
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*No FEM */
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;  /* Do not Perform ALU */
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

          /*  For this program set all other instructions to NULL */
          mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

      } /* system is configured with Port extender enhancement
           map_to_port_extender_enabled */
      else {
              /*  Program 3 instructions (entries 6, 7 in each table) - Ethernet Copy */ 
          entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
          entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);

          for(mem = EPNI_PRGE_INSTRUCTION_0m; mem < EPNI_PRGE_INSTRUCTION_0m + 12; mem++)
          {
              entry = entry_even;
              
              prge_instruction_tbl_data.src_select  = 1;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
              prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = 0;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
              prge_instruction_tbl_data.op_value    = 16;
              prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
              prge_instruction_tbl_data.cmp_action  = 0x7;
              prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

              entry = entry_odd;
              
              prge_instruction_tbl_data.src_select  = 1;
              prge_instruction_tbl_data.offset_base = 0xF0;
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
              prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
              prge_instruction_tbl_data.size_base   = (mem < EPNI_PRGE_INSTRUCTION_0m +6) ? 0x18 : 0;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = 0;
              prge_instruction_tbl_data.op_value    = 0;
              prge_instruction_tbl_data.op_2_field_select     = 0;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = 0;
              prge_instruction_tbl_data.cmp_action  = 0;
              prge_instruction_tbl_data.dst_select  = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
          }

            /*  For this program set all other instructions to NOP */
            entry = entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
       }
  }
  else {   /* mim_vsi_mode is enabled */
      /*  Program 3 instructions (entries 6, 7 in each table) - Ethernet Copy with MIM 32K ISID mode enabled*/
      mem = EPNI_PRGE_INSTRUCTION_0m;
      entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
      entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER);
      entry = entry_even;
      
      /* prepare system headers size */
      prge_instruction_tbl_data.src_select  = 2;
      prge_instruction_tbl_data.offset_base = 33;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base   = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
      prge_instruction_tbl_data.op_value = 0;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


      /* prepare PP port PRGE var (is port PBP) */
      entry = entry_odd;
      
      prge_instruction_tbl_data.src_select      = 2;
      prge_instruction_tbl_data.offset_base     = 45;
      prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = 0;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = 0;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = 1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* SZ = system headers size */
      mem = EPNI_PRGE_INSTRUCTION_0m + 1;
      entry = entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      entry = entry_odd;
      /* R1 = PP port PRGE var */
      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      mem = EPNI_PRGE_INSTRUCTION_0m + 2;
      
      /* prepare Vlan-Edit-command from FHEI */
      entry = entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_PP_MIM_32K_IVEC_CMD,
              mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_HEADER, &(prge_instruction_tbl_data.fem_select));
      SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 35;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* NOP */
      entry = entry_odd;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x0;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      mem = EPNI_PRGE_INSTRUCTION_0m + 3;

      /* branch if Vlan-edit-command==63 and out port is PBP */
      entry = entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 544; /* {6'h0, 5'h pointer, 4'h0, 1'h0}; */
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
      prge_instruction_tbl_data.cmp_action      = 0x2;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* R1 = R3 - R2 */
      entry = entry_odd;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* NOP */
      mem = EPNI_PRGE_INSTRUCTION_0m + 4;
      entry = entry_even;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
      prge_instruction_tbl_data.op_value        = 0;
      prge_instruction_tbl_data.op_2_field_select = 0;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* R3 = R3-8 */  
      entry = entry_odd;

      prge_instruction_tbl_data.src_select      = 0;
      prge_instruction_tbl_data.offset_base     = 0;
      prge_instruction_tbl_data.offset_src      = 0;
      prge_instruction_tbl_data.size_base       = 0;
      prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
      prge_instruction_tbl_data.op_value        = 8;
      prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action      = 0x7;
      prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* don't build 802.1ah header: copy generated header */
      for(mem = EPNI_PRGE_INSTRUCTION_0m + 5; mem < EPNI_PRGE_INSTRUCTION_0m + 12; mem++) {
          
          entry = entry_even;

          prge_instruction_tbl_data.src_select  = 1;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m + 11) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = 0x7;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);      

          entry = entry_odd;

          prge_instruction_tbl_data.src_select  = 1;
          prge_instruction_tbl_data.offset_base = (mem != EPNI_PRGE_INSTRUCTION_0m + 5) ? 0xF0 : 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.size_src    = (mem < EPNI_PRGE_INSTRUCTION_0m +11) ? ARAD_PP_PRGE_ENG_SIZE_REG_R3 : ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = (mem != EPNI_PRGE_INSTRUCTION_0m + 5 && mem < EPNI_PRGE_INSTRUCTION_0m +11) ? 0x18 : 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);       
      }

      /*  For this program set all other instructions to NOP */
      entry = entry_even;
      SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

      /* build 802.1ah header */
      /* copy R1 bytes from offset R3 */
      mem = EPNI_PRGE_INSTRUCTION_0m + 4;
      entry = 35;

      for (i=0; i<9; ++i) {
        mem   = (entry == 35) ? (mem + 1) : mem;
        entry = (entry == 34) ? 35 : 34;

        prge_instruction_tbl_data.src_select  = 1;
        prge_instruction_tbl_data.offset_base = i == 0 ? 0 : entry == 35 ? 0 : 0xF0;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
        prge_instruction_tbl_data.size_base   = entry == 35 ? 0x18 : 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = entry == 35 ? ARAD_PP_PRGE_ENG_OP1_REG_R3 : ARAD_PP_PRGE_ENG_OP1_REG_R1;
        prge_instruction_tbl_data.op_value    = 16;
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action  = 0x7;
        prge_instruction_tbl_data.dst_select  = entry == 35 ? ARAD_PP_PRGE_ENG_DST_REG_R3 : ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
      }

      /* take 2 bytes from FHEI.Edit-VID-1 + PCP-1 + DEI-1 */
      mem   = (entry == 35) ? (mem + 1) : mem;
      entry = (entry == 34) ? 35 : 34;

      prge_instruction_tbl_data.src_select  = 0;
      prge_instruction_tbl_data.offset_base = 0;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base   = 2;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
      prge_instruction_tbl_data.op_value    = 16;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* take 1 byte from FHEI.Edit-VID-2 */
      mem   = (entry == 35) ? (mem + 1) : mem;
      entry = (entry == 34) ? 35 : 34;

      prge_instruction_tbl_data.src_select  = 0;
      prge_instruction_tbl_data.offset_base = 0xF9;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
      prge_instruction_tbl_data.size_base   = 1;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
      prge_instruction_tbl_data.op_value    = 16;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /* copy remainder of header */
      mem   = (entry == 35) ? (mem + 1) : mem;
      entry = (entry == 34) ? 35 : 34;

      prge_instruction_tbl_data.src_select  = 1;
      prge_instruction_tbl_data.offset_base = 0xFA;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
      prge_instruction_tbl_data.size_base   = 0x1D;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
      prge_instruction_tbl_data.op_value    = 19;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      mem   = (entry == 35) ? (mem + 1) : mem;
      entry = (entry == 34) ? 35 : 34;

      prge_instruction_tbl_data.src_select  = 1;
      prge_instruction_tbl_data.offset_base = 0xEA;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
      prge_instruction_tbl_data.size_base   = 0x15;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
      prge_instruction_tbl_data.op_value    = 16;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      mem   = (entry == 35) ? (mem + 1) : mem;
      entry = (entry == 34) ? 35 : 34;

      prge_instruction_tbl_data.src_select  = 1;
      prge_instruction_tbl_data.offset_base = 0;
      prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
      prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
      prge_instruction_tbl_data.size_base   = 0;
      prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
      prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
      prge_instruction_tbl_data.op_value    = 16;
      prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
      prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
      prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
      prge_instruction_tbl_data.cmp_action  = 0x7;
      prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
      res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

      /*  For this program set all other instructions to NULL */
      mem   = (entry == 35) ? (mem + 1) : mem;
      entry = (entry == 34) ? 35 : 34;
      SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, 34, 35) );
  }

  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT].prog_used != -1) {
    mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
    entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT);
    entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT);
    entry = entry_odd;
      
            /* Instruction 0 : extract sys header size*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 33;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 1 : extract DA 2LSB*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 12;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                      
            
            /* Instruction 2 : extract DA 2LSB, as [3:0]set to 0x0, r0=fem-5*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 12;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 8;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 3 : -, r2=fem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            /* Instruction 4 : extract eei [19:16], rsz=fem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 2;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 5 : extract eei [23:16], r1=fem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 2;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_PP_COPY_ARP_EXT, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 6 : --, rsz=fem+rsz*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 32;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 10;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 7 : --, r0=fem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 16;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 8 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 9 : Copy generated header, r2 = (r0 > 15) ? rsz : r2*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value        = 0xf0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
            prge_instruction_tbl_data.cmp_action = 4 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 10 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 11 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 12 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 13 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 14 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 15 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 16 : Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 17: Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 18: Copy generated header, ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 19: copy r2 (DA 2 LSbyte), ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 51;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 20: copy DA 4 MSbytes*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 8;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /*  For this program set all other instructions to NOP */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
  }


  /*  Program 4 instructions (entries 8, 9 in each table) - XGS_PE_FROM_FRC_LITE */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE].prog_used != -1) {
  
    mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
    entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE);
    entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE);
    entry = entry_odd;

    /*  Instruction 0 : Store PPD 4 line in r0 without FEM, r2 = 91 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 20;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 91;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 1 : Store PPD 4 line in r1 with FEM, rsz = 93 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 20;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT8_TO_BIT10,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 93;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 2 : Extract PPD type, r0 = line 4 without fem */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 3 : Extract DSP , r1 = line 4 with fem */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 11;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 4 : Extract rep_id , r2 = (ppd != 2) ? rsz : r2 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 12;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 2;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 5 : Extract CUD , r2 = (dsp != 255) ? rsz : r2 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 57;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0x0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 255;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 6 : --- , r0 = rep_id */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 7 : Copy last line of PPD , r1 = CUD */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 1;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 8 : Extract DSP , r2 = 91 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 11;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_DSP,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 91;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 9 : Copy 3 line of PPD, --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 16;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 10 : Store 1 line of PPD without FEM, r2 = (dsp != 255) ? rsz : r2 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 8;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 255;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 11 : Store 1 line of PPD with FEM, r2 = 91 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 8;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_ZERO_BIT0_TO_BIT1,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 91;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 12 : Copy 2 line of PPD, r0 = 1 line no fem */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 1;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 13 : Extract PPD type, r1 = 1 line with fem */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 14 : Extract DSP, --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 11;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_3_LSBS,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 15 : Extract TC, r2 = (ppd != 0) ? rsz : r2 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 5;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 16 : ---, r2 = (dsp != 255) ? rsz : r2 */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 255;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
    prge_instruction_tbl_data.cmp_action      = 0x5;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 17 : Take MC bit, r0 = TC */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 18;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_EXTRACT_MC,
            mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FRC_LITE, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 18 : Copy 1 line of PPD, --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 1;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 19 : Copy 4 line of FRC, r0 = {MC, 1'b0, TC} */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
    prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 20 : Copy 3 line of FRC, --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 43;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 21 : Copy 2 line of FRC, --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 17;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  Instruction 22 : Copy 1 line of FRC, --- */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    
    prge_instruction_tbl_data.src_select      = 2;
    prge_instruction_tbl_data.offset_base     = 59;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /*  For this program set all other instructions to NOP */
    mem   = (entry == entry_odd) ? (mem + 1) : mem;
    entry = (entry == entry_even) ? entry_odd : entry_even;
    SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
  }

  /*  Program 5 instructions (entries 10, 11 in each table) -  2_HOP_SCHEDULING */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING].prog_used != -1) { 

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING);
        entry = entry_odd;

        /*  Instruction 0 : check CUD lsb , R3 = 0*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* resolved data */
        prge_instruction_tbl_data.offset_base     = 57; /* CUD */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; 
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 1 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 2 : Jump if CUD is odd */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 544; /* {6'h0, 5'h pointer, 4'h0, 1'h0}; */
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = 0x4;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 3 : take TC from ITMH to FEM result */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0x4; /* +4 */ /* LSB of the ITMH */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; /* start of ITMH */
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 4 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 5 : r3=TC */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0x0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* instructions if CUD was odd */

        /*  Instruction 6 : take Flow-ID from EEDB to FEM result */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* resolve data */
        prge_instruction_tbl_data.offset_base     = 27; /* EPNI_ETPP_PRGE_RESOLVED_DATA_EES_DATA_1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
        /*  Instruction 7 : r2 = 8'b00001110 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 14;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 8 : r3 = r3 + Flow-ID */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 9 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 10 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 11 : copy r3 (16b) to packet header (ITMH Dest-Ext) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47; /* R3 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 12 : copy r2 (8b) to packet header (ITMH Dest-Ext) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 51; /* R2 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 13 : copy outlif 16 lsb from EEDB result */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 31; /* EPNI_ETPP_PRGE_RESOLVED_DATA_EES_DATA_1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 14 : take outlif msb from EEDB result to FEM*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 27; /* EPNI_ETPP_PRGE_RESOLVED_DATA_EES_DATA_1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 15 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 16 : {12 MSBs of original ITMH, 4'b1010} to FEM, r3=out-lif msb */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0x4; /* +4 */ /* LSB of the ITMH */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; /* start of ITMH */
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0x0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
        /*  Instruction 17 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
               
        /*  Instruction 18 : r3 = r3 + {12 MSBs of original ITMH, 4'b1010} */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 19 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 20 : copy r3 (16b) to packet header (rest of ITMH) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47; /* R3 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 21 : Source system port for PTCH */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2; /* Resolved-Data */
        /* 128-data-mem, 556-resolve-data-width, 0-offset to source-system-port lsb, 64*2 - minus offset source (in bytes) */
        prge_instruction_tbl_data.offset_base     = ((128 + 556 - 0)/4) - 64*2; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 22 : 8'b0 for MSB of the PTCH */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 49; /* R2 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );


        /* Jump instructions - program reaches here if CUD was even */

        mem   = EPNI_PRGE_INSTRUCTION_3m - 1;
        entry_odd = 35;
        entry_even = 34;
        entry = entry_odd;

        /*  Instruction 6 : take Flow-ID from EEDB to FEM result */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* resolve data */
        prge_instruction_tbl_data.offset_base     = 20; /* EPNI_ETPP_PRGE_RESOLVED_DATA_EES_DATA_1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING_EXTRACT_FLOW_ID,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
        /*  Instruction 7 : r2 = 8'b00001110 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 14;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 8 : r3 = r3 + Flow-ID */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 9 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 10 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 11 : copy r3 (16b) to packet header (ITMH Dest-Ext) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47; /* R3 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 12 : copy r2 (8b) to packet header (ITMH Dest-Ext) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 51; /* R2 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 13 : copy outlif 16 lsb from EEDB result */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 24; /* EPNI_ETPP_PRGE_RESOLVED_DATA_EES_DATA_1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 14 : take outlif msb from EEDB result to FEM*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 20; /* EPNI_ETPP_PRGE_RESOLVED_DATA_EES_DATA_1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*  Instruction 15 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 16 : {12 MSBs of original ITMH, 4'b1010} to FEM, r3=out-lif msb */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0x4; /* +4 */ /* LSB of the ITMH */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; /* start of ITMH */
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_2_HOP_SCHEDULING,
                mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0x0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
       
        /*  Instruction 17 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                                      
        /*  Instruction 18 : r3 = r3 + {12 MSBs of original ITMH, 4'b1010} */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 19 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 20 : copy r3 (16b) to packet header (rest of ITMH) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47; /* R3 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 21 : Source system port for PTCH */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2; /* Resolved-Data */
        /* 128-data-mem, 556-resolve-data-width, 0-offset to source-system-port lsb, 64*2 - minus offset source (in bytes) */
        prge_instruction_tbl_data.offset_base     = ((128 + 556 - 0)/4) - 64*2; 
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 22 : 8'b0 for MSB of the PTCH */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 49; /* R2 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill the rest of the instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );


    } 

  /*  Program 5 instructions (entries 10, 11 in each table) - ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH].prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH);
        entry = entry_odd;

        /*  Instruction 0 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 1 : Copy generated header, r0 = 0 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 2 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 3 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 4 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 5 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 6 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 7 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 8 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 9 : Copy generated header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 10 : add PPD */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 11 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 12 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 13 : NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 14 : Copy 4 line of FRC (dp from ftmh) , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 15 : Extract TC, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 16 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 17 : Take MC bit, r1 = TC */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 18 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 19 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 20 : Copy 3 line of FRC, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 21 : Copy 2 line of FRC (Dest System Port), --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 53;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 22 : Copy 1 line of FRC, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  For this program set all other instructions to NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

  /*  Program 5 instructions (entries 10, 11 in each table) - ARAD_PRGE_PP_SELECT_XGS_PE_FROM_FTMH */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP].prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP);
        entry = entry_odd;

        
        /* Instruction 0 : extract sys header size*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 33;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 1 : extract DA 2LSB*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 2 : extract DA 2LSB, as [3:0]set to 0x0, r0=fem-5*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_DA_COPY,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 8;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 3 : extract FTMH.DP, r2=fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 4 : extract eei [19:16], rsz=fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 5 : extract eei [23:16], r1=fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 6 : --, rsz=fem+rsz*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 32;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 10;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 7 : --, r0=fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 16;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        
        /* Instruction 8 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 9 : Copy generated header, r2 = (r0 > 15) ? rsz : r2*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x12;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 0xf0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_SZ;
        prge_instruction_tbl_data.cmp_action = 4 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 10 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 11 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x12;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 12 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 13 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x12;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 14 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 15 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x12;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 16 : Copy generated header, ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 17: copy r2 (DA 2 LSbyte), ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 51;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 18: copy DA 4 MSbytes*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 8;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 19: copy PPD from program var*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 20: copy DP from r1 FRC line 4*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 21: copy src sys port FRC line 3*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 22: copy dest sys port FRC line 2*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 53;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        
        /* Instruction 23: copy TC FRC line 1*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_FROM_FTMH_ARP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  For this program set all other instructions to NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }




    for (is_1588 =0 ; is_1588 <=1 ; ++is_1588  ) {
        int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP :
                                              ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_DOWN_TRAP_NTP; 
        /* Program 6 instructions (entries 12, 13 in each table) - OAM_TOD_STAMP_OAM_TS_EXT - NTP DM Down Rx*/
        if (programs[unit][prog_index].prog_used != -1) {
            mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
            entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(prog_index);
            entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(prog_index);
            entry = entry_odd;

            
            /* Instruction 0 : r0 = r3-r2 -> PPH size*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* (to push ToD) */
            /* Instruction 1 : Copy ToD NTP [63:32] and insert it in the beginning of the header (sic)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; /*resolved data*/
            prge_instruction_tbl_data.offset_base     = (is_1588==1)?   (ARAD_PP_PRGE_TOD_1588 - 8): ARAD_PP_PRGE_TOD_NTP -8;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 2 : Copy PPH eei and learn (if any), */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x19;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            /* Instruction 3 : Copy PPH fwrd_offset+pkt_ctrl , */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 4;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2; /*pph*/
            prge_instruction_tbl_data.size_base       = 0; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            /* Instruction 4 : Copy PPH FHEI (if any) , */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3; /*pph*/
            prge_instruction_tbl_data.size_base     = 0x11;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            /* Instruction 5: Recalculate the pph fwrd offset 0 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value = 8 ;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 6 : Copy PPH base 5 last bytes , nop for pph*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 14;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 5;/*6;*/
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /*here - copy for frwd offset+pkt_ctrl, as fwrd is increased +4*/
            /* Instruction 7 : Copy PPH base fwrd offset + pkt_ctrl*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; /*from resolved*/
            prge_instruction_tbl_data.offset_base     = 47; /*r3*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 1;/**/
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 8 : PPH base first byte*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 2;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 9: Copy  OAM TS */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 12;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 10 : Copy LSB of FTMH , ---*/
            
            
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 11: Copy MSB of FTMH stamp pph_type = 3 , ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 12;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
        }
    }

	/* Program 6 instructions (entries 12, 13 in each table) - OAM_TOD_STAMP_OAM_TS_EXT - NTP - UP_RX*/
    for (is_1588=0 ; is_1588 <=1 ; ++is_1588) {
        int prog_index = (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP :
                                              ARAD_EGR_PROG_EDITOR_PROG_OAM_DM_UP_RX_TRAP_NTP;
        int fem_1_3 =  (is_1588 == 1) ? ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD : ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_NTP;
        if (SOC_IS_ARADPLUS(unit) && (is_1588 == 1)) {
            fem_1_3 = ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_EXTRACT_TOD_APLUS;
        }

        if (programs[unit][prog_index].prog_used != -1) {
            mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
            entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(prog_index);
            entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(prog_index);
            entry = entry_odd;

            /* Instruction 0 : Extract FHEI size (fem output) , r0 = r3-r2 -> PPH size*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0; 
            prge_instruction_tbl_data.offset_base     = 1;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI,
                    mem, prog_index, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 1 :nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0; 
            prge_instruction_tbl_data.offset_base     = 1; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI,
                    mem, prog_index, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 2 : --- , rsz = (fem == 3) ? 3 : rsz*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 3;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 2 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 3 : --- , rsz = (fem == 5) ? 5 : rsz*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 5;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 2 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* (to push ToD) */
            /* Instruction 4 : Copy ToD NTP [63:32] and insert it in the {ning of the header*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; /*resolved data*/
            prge_instruction_tbl_data.offset_base     = (is_1588==1)? ARAD_PP_PRGE_TOD_1588 - 8 : ARAD_PP_PRGE_TOD_NTP - 8;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
			/*4 MSB of TOD between packet and internal headers */
            prge_instruction_tbl_data.size_base       = (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_dm_tod_msb_add_enable", 1))?4:0; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 5 : --- , r0 = r0 - rsz as PPH size holds sizes of base, eei ext, learn ext and fhei ext, removes fhei size*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 6 : ---  nop, to wait for r0 -pph size without fhei ext size*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 7 : Copy PPH eei and learn , r0=0x8902*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x19;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0x8902;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            /* Instruction 8 :  Extract Eth type(first attempt 13-14 byte), set rsz=8+14, shifted with 1 bit left - ;*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 28; /*12bytes(da+sa), 2bytes -eth type (no tag case)*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_dm_tod_msb_add_enable", 1))?
				 0x34 :0x2c ; /*4 MSB of TOD between packet and internal headers */
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 9 :  Extract Eth type(second attempt 17-18 byte); */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 36; /*12bytes(da+sa),4bytes tag,2bytes-eth type (single)*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction  10:  compare rsz = (fem == 0x8902) ? 14 : rsz;*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        =(soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_dm_tod_msb_add_enable", 1))?
				0x24 : 0x1c;  /*4 MSB of TOD between packet and internal headers */
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 2 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction  11: copy fwd offset,pktctrl rsz = (fem == 0x8902)? r3:rsz  */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 4; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "oam_dm_tod_msb_add_enable", 1))?
				0x2c : 0x24 ; /*4 MSB of TOD between packet and internal headers */
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 2 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 12 : Create new FHEI, trap code0xe8 , nop for pph*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 127;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 13 : Create new FHEI - trap qualifier,  recalculate the pph fwrd offset r3=fem+rsz*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 103;/*EPNI_ETPP_PRGE_RESOLVED_DATA_OAM_EXT_ID*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 14 : Copy PPH base 5 last bytes ,*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 14;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 5;/*6;*/
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /*here - copy for frwd offset+pkt_ctrl, as fwrd is increased +14 +num-tag*4*/
            /* Instruction 15 : Copy PPH base fwrd offset =pkt_ctrl*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2; /*from resolved*/
            prge_instruction_tbl_data.offset_base     = 47; /*r3*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 1;/**/
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 16 : PPH base first byte*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 2;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_FHEI,
                    mem, prog_index, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 17 : Set OAM TS offset = 0 ,*/  /*the offset src?!?!*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 1;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 18 : Copy  OAM ToD LSB , */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     =(is_1588==1)? ARAD_PP_PRGE_TOD_1588: ARAD_PP_PRGE_TOD_NTP;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 19 : Extract bits [33:32] of NTP_TOD , change - set the FEM for OAM, UP MEP, DM NTP, */
            /* copy the fem result as OAM last MSbyte*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = (is_1588==1)?ARAD_PP_PRGE_TOD_1588 - 8 : ARAD_PP_PRGE_TOD_NTP-8;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, fem_1_3,
                    mem, prog_index, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 20 : Copy LSB of FTMH , ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base     = 0x1A;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 21 : Copy MSB of FTMH stamp pph_type = 3 , ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 12;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_STAMP_PPH,
                    mem, prog_index, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
        }
    }
    
    /* Program 6 instructions (entries 12, 13 in each table) - OAM_COUNTER_STAMP_OAM_TS_EXT - LM Up Rx*/
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP].prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP);
        entry = entry_odd;


        /* Instruction 0 : Extract FHEI size (fem output) , r0 = r3-r2 -> PPH size*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 1;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* Instruction 1 :nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 1;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 2 : --- , rsz = (fem == 3) ? 3 : rsz*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 3;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 3 : --- , rsz = (fem == 5) ? 5 : rsz*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 5;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* Instruction 4 :nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0; /**/
        prge_instruction_tbl_data.offset_base     = 0; /* */
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 5 : --- , r0 = r0 - rsz as PPH size holds sizes of base, eei ext, learn ext and fhei ext, removes fhei size*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* Instruction 6 : ---  nop, to wait for r0 -pph size without fhei ext size*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* Instruction 7 : Copy PPH eei and learn , r0=0x8902*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base     = 0x19;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0x8902;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);




        /* Instruction 8 :  Extract Eth type(first attempt 13-14 byte), set rsz=8+14, shifted with 1 bit left - ;*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 28; /*12bytes(da+sa), 2bytes -eth type (no tag case)*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0x2c;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* Instruction 9 :  Extract Eth type(second attempt 17-18 byte); */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 36; /*12bytes(da+sa),4bytes tag,2bytes-eth type (single)*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* Instruction  10:  compare rsz = (fem == 0x8902) ? 14 : rsz;*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0x1c;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction  11: copy fwd offset,pktctrl rsz = (fem == 0x8902)? r3:rsz  */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 4;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0x24;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* Instruction 12 : Create new FHEI, trap code0xe8 , nop for pph*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 127;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* Instruction 13 : Create new FHEI - trap qualifier,  recalculate the pph fwrd offset r3=fem+rsz*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 103; /*EPNI_ETPP_PRGE_RESOLVED_DATA_OAM_EXT_ID*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 14 : Copy PPH base 5 last bytes ,*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 14;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 5; /*6;*/
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /*here - copy for frwd offset+pkt_ctrl, as fwrd is increased +14 +num-tag*4*/
        /* Instruction 15 : Copy PPH base fwrd offset =pkt_ctrl*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /*from resolved*/
        prge_instruction_tbl_data.offset_base     = 47; /*r3*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1; /**/
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* Instruction 16 : PPH base first byte*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_FHEI,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 17 : Set OAM TS offset = 0 ,*/  /*the offset src program var*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 1;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 18 : Copy  OAM counter , */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 111; /*EPNI_ETPP_PRGE_RESOLVED_DATA_OAM_COUNTER_VALUE*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 19 :Set bits [33:32] of Data to 0 set OAM, UP MEP, LM - */
        /* take0x08 from program var OAM last MSbyte*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 20 : Copy LSB of FTMH , ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
        prge_instruction_tbl_data.size_base     = 0x1A;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 21 : Copy MSB of FTMH stamp pph_type = 3 , ---*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 6;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_STAMP_PPH,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_LM_UP_TRAP, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
	


  /*  Program 7 instructions (entries 14, 15, 36, 37 in each table) - TDM_STAMP_CUD */
  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD].prog_used != -1) {
    /*if (tdm_petra_std | tdm_petra_opt)*/

    mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
    entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD);
    entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD);
    entry = entry_odd;

    if (soc_petrab_cfg)
    {
        /*  Instruction 0 : Copy CUD, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 57;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 1 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 2 : take FTMH [15:14], r0 = CUD */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = /*tdm_petra_std ? 16 : 4*/4;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        /* Instruction 2/2 = 1%2 = 1 --> odd lfem */
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_EXTRACT_FTMH_PB,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 3 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 4 : ---, r0 = r0 + FEM */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 5 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 6 : Copy new FTMH, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 7 : Copy new FTMH, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = /*tdm_petra_std ? 6 : 0*/0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    if (tdm_arad_opt)
    {
        /*  Instruction 0 : Copy CUD, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 57;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 1 : Copy left FTMH, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 4;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    if (tdm_arad_std)
    {
        /*  Instruction 0 : Extract FTMH [3:0], --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 18;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 1 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 2 : Extract CUD [11:0], r0 = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 57;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 3 : Extract FTMH [31:20], --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 13;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 4 : ---, r0 = r0 + fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 5 : Extract CUD [15:12], r1 = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 54;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        /* Instruction 5/2 = 2%2 = 0 --> even lfem */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TDM_STAMP_CUD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 6 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 7 :---, r1 = r1 + fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 8 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 9 : Copy {r1, r0} */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 10 : Copy left FTMH */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 10;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 5;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
  }

  /*  Program 8 instructions (entries 16, 17 in each table) - ETH_WITH_LLID_TAG */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG].prog_used != -1) {
        mem = EPNI_PRGE_INSTRUCTION_0m -1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG);
        entry = entry_odd;

        /* extract ees_data2 first nibble (PLUS); r3 = r3 - 12 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 0:2);
        prge_instruction_tbl_data.offset_base     = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 0:ARAD_PP_PRGE_EES_DATA2);
        prge_instruction_tbl_data.offset_src      = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 0:ARAD_PP_PRGE_ENG_OFFSET_CONST_64);
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        if (SOC_IS_ARAD_B1_AND_BELOW(unit)) {
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        }
        else {
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ETH_WITH_LLID_TAG, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        }
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 12;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        if (SOC_IS_ARADPLUS(unit)) {
            /* r2 = fem */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }
        
        for(i=0; i<6; i++)
        {
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 24;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 8; /* -16+24; */
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }
        
        /* Copy LLID */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 29:(ARAD_PP_PRGE_EES_DATA2 - 1));
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? ARAD_PP_PRGE_ENG_SIZE_CONST:ARAD_PP_PRGE_ENG_SIZE_REG_R2);
        prge_instruction_tbl_data.size_base       = (SOC_IS_ARAD_B1_AND_BELOW(unit) ? 4:0);
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Copy SA */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 24;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 6;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Copy DA */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 6;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
   }
  
    /* Program instructions (entries 8, 9 in each table) - XGS_MAC_EXT_AND_SPAN */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD].prog_used != -1)
    {  
        mem   = EPNI_PRGE_INSTRUCTION_0m -1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD);
        entry = entry_odd;
        
        /* Instruction 0 : nop*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 1 : extract DA 2LSB*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 2 : nop*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 3 : extract FTMH.DP,*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 4 :nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 5 : --, r1=fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7 ;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        for (i=6; i<19; i++){
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0 ; 
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 0 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 
        }       
        
        /* Instruction 19: copy PPD from program var*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 20: copy DP from r1 FRC line 4*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 21: copy src sys port FRC line 3*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 22: copy dest sys port FRC line 2*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 53;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 23: copy TC FRC line 1*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_XGS_ADD, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit); 

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    /*  Program 9 instructions (entries 18, 19 in each table) - IPV6_TUNNEL_PROGRAM */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL].prog_used != -1)
    {  
        mem   = EPNI_PRGE_INSTRUCTION_0m -1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL);
        entry = entry_odd;
    
        /* Instruction 0 : Extract DIP-PTR, rsz = r3 - r0 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 29;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 1 : Extract SIP-MSB-PTR, r2 = r3 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 27;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R3;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 2 : ---, indirect_addr = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 3 : ---, indirect_addr = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 4 : Copy frwd header, rsz = rsz - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 5 : Copy frwd header, r2 = r2 - 24 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0; /* -16 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 24;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 6 : Copy frwd header, r3 = r3 - 2 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xE0; /* -32*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 2;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 7 : Copy frwd header, ind_addr = r1 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R1;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 8 : Copy frwd header, r3 = r3 - r0 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0; /* -16 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.size_base       = 0x10; /* -16 5b' */
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 9 : Extract system headers size, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 33;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        /* Instruction 9/2 = 4%2 = 0 --> even lfem */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 10 : Copy mem data, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 32;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 11 : Extract FTMH size, r3 = r3 - fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 4;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_IPV6_EXTRACT_FTMH,
                mem, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 12 : Copy mem data, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 16;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 13 : Extract network headers size, r3 = r3 + fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 35;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        /* Instruction 13/2 = 6%2 = 0 --> even lfem */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_7_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_IPV6_TUNNEL, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 14 : Copy SIP-LSB, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 25;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 15 : ---, r3 = r3 - fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 16 : Copy mem data, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 32;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 6;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 17 : Copy mem data, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 20;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 18 : Copy payload length, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 47;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 19 : Copy first 4B, r0 = r0 - 2  */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 2;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 20 : Copy Eth-Type, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 123;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 21 : Copy Ethernet header, r0 = r0 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 22 : Copy Ethernet header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 23 : Copy Ethernet header, --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
  
  /*  Program 10 instructions (entries 20, 21 in each table) - OAM CCM */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM].prog_used != -1)
    {  
        mem   = EPNI_PRGE_INSTRUCTION_0m -1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM);
        entry = entry_odd;

			/* Instruction 0 : Extract FHEI size , r0 = r3-r2 (pph size)*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 1;
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            /* Instruction 0/2 = 0 --> even lfem */
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
			prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
			prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			
			/* Instruction 1 :  Extract FHEI size*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 1;
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_LOOPBACK_EXTRACT_FHEI,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
			prge_instruction_tbl_data.op_1_field_select = 0;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = 0;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = 0;
			prge_instruction_tbl_data.cmp_action      = 0;
			prge_instruction_tbl_data.dst_select      = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			
			/* Instruction 2 : extract PPH.FwdHdrOffset , rsz = (fem == 3) ? 3 : rsz*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 4; 
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
			prge_instruction_tbl_data.op_value        = 3;
			prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
			prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
			prge_instruction_tbl_data.cmp_action = 2 ;
			prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_EXTRACT_PPH_OFFSET,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			/* Instruction 3 : --- , rsz = (fem == 5) ? 5 : rsz*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 0;
			prge_instruction_tbl_data.offset_src      = 0;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
			prge_instruction_tbl_data.op_value        = 5;
			prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
			prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
			prge_instruction_tbl_data.cmp_action = 2 ;
			prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			/* Instruction 4 :  ----; r1 = r3+fem */
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 0;
			prge_instruction_tbl_data.offset_src      = 0;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
			prge_instruction_tbl_data.alu_action      = 1;
			prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
			prge_instruction_tbl_data.cmp_action = 7 ;
			prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			/* Instruction 5 :   r0 = r0 - rsz as PPH size holds sizes of base, eei ext, learn ext and fhei ext, removes fhei size*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 0; /*12th byte*/
			prge_instruction_tbl_data.offset_src      = 0;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
			prge_instruction_tbl_data.cmp_action = 7 ;
			prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			/* Instruction 6 : nop */
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 0;
			prge_instruction_tbl_data.offset_src      = 0;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = 0;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = 0;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = 0;
			prge_instruction_tbl_data.cmp_action      = 0;
			prge_instruction_tbl_data.dst_select      = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			
			/* Instruction  7: Copy PPH eei and learn;  r0= 0x8902*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 0; 
			prge_instruction_tbl_data.offset_src      =ARAD_PP_PRGE_ENG_OFFSET_REG_R3 ;
			prge_instruction_tbl_data.size_base     = 0x19;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = 0;
			prge_instruction_tbl_data.op_value        = 0x8902;
			prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
			prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
			prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			
			/* Instruction 8 :  Extract Eth type(first attempt 12-13 byte), set rsz=8+14, shifted with 1 bit left - 0x2c;*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 28; /*12bytes(da+sa), 2bytes -eth type (no tag case)*/
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value        = 0x2c;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
			prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			
			/* Instruction 9 :  Extract Eth type(second attempt 16-17 byte);*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 36; /*12bytes(da+sa),4bytes tag,2bytes-eth type (single)*/
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = 0;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = 0;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = 0;
			prge_instruction_tbl_data.cmp_action      = 0;
			prge_instruction_tbl_data.dst_select      = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			
			/* Instruction  10:  compare rsz = (fem == 0x8902) ? 0+14 : rsz;*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 0; 
			prge_instruction_tbl_data.offset_src      = 0;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
			prge_instruction_tbl_data.op_value        = 0x1c;
			prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = 0x2;
			prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			/* Instruction  11:  extact pph offset (with pkt_ctrl) ;rsz = (fem == 0x8902) ? 4+14 : rsz;*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 4; 
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
			prge_instruction_tbl_data.op_value        =  0x24;
			prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = 0x2;
			prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			
			/* Instruction 12 : create FHEI trap code;   */
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 2;
			prge_instruction_tbl_data.offset_base     = 3;
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
			prge_instruction_tbl_data.size_base       = 1;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = 0;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = 0;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = 0;
			prge_instruction_tbl_data.cmp_action      = 0;
			prge_instruction_tbl_data.dst_select      = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			
			/* Instruction 13 : Create FHEI trap code qaulifier , r3=fem+rsz*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 2;
			prge_instruction_tbl_data.offset_base     = 103;
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
			prge_instruction_tbl_data.size_base       = 2;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
			prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			
			
			/* Instruction 14 : Copy 5 LSB bytes from PPH , ---*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 14;
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
			prge_instruction_tbl_data.size_base       = 5;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = 0;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = 0;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = 0;
			prge_instruction_tbl_data.cmp_action      = 0;
			prge_instruction_tbl_data.dst_select      = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			/* Instruction 15 : Copy second byte of PPH from R3 , ---*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 2;
			prge_instruction_tbl_data.offset_base     = 47;
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
			prge_instruction_tbl_data.size_base       = 1;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = 0;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = 0;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = 0;
			prge_instruction_tbl_data.cmp_action      = 0;
			prge_instruction_tbl_data.dst_select      = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			/* Instruction 16 : nop*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 0;
			prge_instruction_tbl_data.offset_src      = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = 0;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = 0;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = 0;
			prge_instruction_tbl_data.cmp_action      = 0;
			prge_instruction_tbl_data.dst_select      = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			/* Instruction 17 : nop*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 0;
			prge_instruction_tbl_data.offset_src      = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = 0;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = 0;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = 0;
			prge_instruction_tbl_data.cmp_action      = 0;
			prge_instruction_tbl_data.dst_select      = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			/* Instruction 18 : Copy PPH base first byte , ---*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 2;
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
			prge_instruction_tbl_data.size_base       = 1;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
			prge_instruction_tbl_data.op_1_field_select = 0;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = 0;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = 0;
			prge_instruction_tbl_data.cmp_action      = 0;
			prge_instruction_tbl_data.dst_select      = 0;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_TS_CCM_FHEI,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
        /* Instruction 19 : Copy FTMH , r2 = r2 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			/* Instruction 20 : Copy FTMH , ---*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 0xF0;
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
			prge_instruction_tbl_data.size_base     = 0x18;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = 0;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = 0;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = 0;
			prge_instruction_tbl_data.cmp_action      = 0;
			prge_instruction_tbl_data.dst_select      = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
			/* Instruction 21 : Copy FTMH , ---*/
			mem   = (entry == entry_odd)   ? (mem + 1) : mem;
			entry = (entry == entry_even)  ? entry_odd : entry_even;
			prge_instruction_tbl_data.src_select      = 0;
			prge_instruction_tbl_data.offset_base     = 0;
			prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
			prge_instruction_tbl_data.size_base       = 0;
			prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select = 0;
			prge_instruction_tbl_data.op_value        = 0;
			prge_instruction_tbl_data.op_2_field_select = 0;
			prge_instruction_tbl_data.alu_action      = 0;
			prge_instruction_tbl_data.op_3_field_select = 0;
			prge_instruction_tbl_data.cmp_action      = 0;
			prge_instruction_tbl_data.dst_select      = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
			
			
            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

  /*  Program instructions  OAM CCM with 2 FHEI */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM_UP_MEP_TRAP_2_FHEI].prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m -1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM_UP_MEP_TRAP_2_FHEI);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM_UP_MEP_TRAP_2_FHEI);
        entry = entry_odd;
            
            /* Instruction 0 new FHEI trap code (from program_var); r0 =r3-r2*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);        
            
            /* Instruction 1 new FHEI trap code qualifier (oam id); ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 103; /*RGE_OAM_EXT_ID*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 2 copy PPH.EEI, PPH.Learn if exists; r0 - 16 (change the size)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1E;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            
            /* Instruction 3 copy PPH.FHEI/partly PPH base;*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x16;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 4 copy rest of pph base; r0= 8902*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0xE0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x1E;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0x8902;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 5 extract Ethertype from place of no tag; set rsz = ((8+14+3)<<1)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 28; /* 12 SA+DA, 2 Ethtype in nibbles*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0x32;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 6 extract Ethertype from place of 1 tag ; ---*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 36;/* 12 SA+DA,4 1 tag 2 Ethtype in nibbles*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 7 --; compare rsz = (fem == r0) ? Opvar(0+14+3 shifted by 1) : rsz*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0x22;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 2 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 8 Extract PPH {offset,ctrl}; compare rsz = (fem == r0) ? Opvar(4+14+3 shifted by 1) : rsz*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 4;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0x2a;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 2 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 9 NOP*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 10 ---; r3 = fem+rsz*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 11 NOP*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 12 copy PPH Offset from R3; ----*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 47;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 13 copy PPH FWD code and rest with lfem; ----*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 2;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 1;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_PPH_FWD_CODE,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_CCM_UP_MEP_TRAP_2_FHEI, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 14 copy FTMH; ----*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 15 copy FTMH; ----*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base     = 0x18;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 16 copy FTMH; ----*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

   
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO].prog_used != -1) 		{
        int     mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO);
        entry = entry_odd;

        /*instruction 0-11  Copy the the generated pp headers (from the pipe)*/
        for (i= 0; i < 6; i++) {
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even; 
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even; 
            prge_instruction_tbl_data.src_select        = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src          = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x18;
            prge_instruction_tbl_data.fem_select        = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select   = 0;
            prge_instruction_tbl_data.op_value          = 0;
            prge_instruction_tbl_data.op_2_field_select   = 0;
            prge_instruction_tbl_data.alu_action        = 0;
            prge_instruction_tbl_data.op_3_field_select   = 0;
            prge_instruction_tbl_data.cmp_action        = 0;
            prge_instruction_tbl_data.dst_select        = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        }


        /*Instruction 12  Extract from FTMH 2LSBytes {12'h000,1'b0,FTMH[2:0]}*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 18; /* FTMH 2LSbyte*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_LSBYTES,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instruction 13   Extract DestSysPort for FTMH 3rd LSByte DestSysPort[15:12]  -> {4'h0,[3:0]}, MC bit is set to 0*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     =  ARAD_PP_PRGE_DST_SYSTEM_PORT - 3; /*last nibble of DstSysPort*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instruction 14  extract DestSysPort [11:0] {DestSysPort[11:0],4'h0} ; r2=fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_DST_SYSTEM_PORT;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /*Instruction 15 -------- ; r1=fem*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instruction 16 extract FTMH {FTMH[39],8'h0,FTMH[30:27],2'b00,FTMH[24] } ; r2=fem+r2*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);




        /*Instruction 17 add FTMH.DSP extension; -------*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_OUT_LIF;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instruction 18 extract   ;   {1'b0, out_pp_port[7:0],7'h0 } */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_OUT_PP_PORT;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_2_BYTES_2,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_EGRESS_SNOOP_WITH_OUTLIF_INFO, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /*Instruction 19 copy from r2  2 bytes (FTMH 2LSBytes)*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     =  51; /*r2*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instruction 20 copy from r1   1 (FTMH 3rd LSByte)  ; r0=fem+r0*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instruction 21 NOP  */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instruction 22 copy from r0 (FTMH 4th and 5th LSB)  */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     =  59; /*r2*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instruction 23 copy remaining 4 bytes of FTMH  */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     =  8;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    /*  Program 11 instructions (entries 22, 23 in each table) - OAM Loopback */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK].prog_used != -1)
    {  
        mem   = EPNI_PRGE_INSTRUCTION_0m -1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK);
        entry = entry_odd;
        
        /*  Instruction 0 : Extract FHEI size , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0x8902;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 1 : Extract Eth type(first attempt 13-14 byte), set rsz=8+16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 28; /*12bytes(da+sa), 2bytes -eth type (no tag case) */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 24;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 2 : Extract Eth type(second attempt 17-18 byte) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 36; /*12bytes(da+sa),4bytes tag,2bytes-eth type (single)*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 3 : compare rsz = (fem == 0x8902) ? 16 : rsz; */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 4 : copy fwd offset, rsz = (fem == 0x8902)? (16+4):rsz */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 4;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        /* Instruction 4/2 = 2%2 = 0 --> even lfem */  
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_CCM_EXTRACT_PPH_OFFSET,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 20;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action      = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 5 : extract TC and DP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        /* Instruction 5/2 = 2%2 = 0 --> even lfem */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OAM_LOOPBACK_EXTRACT_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OAM_LOOPBACK, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 6 : recalculate the pph fwrd offset rsz=fem+rsz */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 7 : load r0 with fem -> tc, dp and fwd-dest-info[19:16]=(4'b1100) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /*  Instruction 8 : --- , r1 = 24 - rsz (24-bytes to remove) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 24;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 9 : --- , r2 = 24 + r3 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.op_value        = 24;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 10 : --- , rsz = rsz - 1 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
        prge_instruction_tbl_data.op_value        = 1;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 11 : Copy NWK LSB , r1 = r1 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 12 : Copy NWK LSB , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 13 : Copy NWK LSB , r2 = r3 + rsz */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xE0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 14 : Copy NWK LSB , r1 = rsz - 12 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xD0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
        prge_instruction_tbl_data.op_value        = 12;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 15 : Set 1731.OpCode , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 3;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 16 : Copy NWK MSB , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 17 : Copy NWK MSB , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 18 : Copy DA , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 6;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
         
        
        /*  Instruction 19 : Copy SA , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 24;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 6;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 20 : Copy ITMH LSB , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 43;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 21 : Copy ITMH MSB , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    /* Program 12 instructions (entries 24, 25 in each table) -
       program pointer 12 is used either for MPLS_SWAP or for VXLAN */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_MPLS_SWAP_COUPLING].prog_used != -1) { 

        /* Program 12 instructions (entries 24, 25 in each table) - MPLS_SWAP */
        mem   = EPNI_PRGE_INSTRUCTION_0m -1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_MPLS_SWAP_COUPLING);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_MPLS_SWAP_COUPLING);
        entry = entry_odd;
    
        /* Instruction 0 : Extract BOS and EXP , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 6;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_MPLS_SWAP_COUPLING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
        /* Instruction 1 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
        /* Instruction 2 : Extract MPLS label , r1 = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 30;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
        /* Instruction 3 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 4 : --- , r1 = r1 + fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 5 : Copy outer TTL , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 6 : Copy BOS and EXP and MPLS label , r2 = r3 - r0 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 55;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 7 : Copy MPLS label , r0 = r0 - 2 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 26;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 2;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 8 : Copy generated header , r2 = r2 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 9 : Copy generated header , r3 = r3 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        for (i = 0; i < 4; i++)
        {
            /* Instruction 10, 12, 14, 16 : Copy generated header , r2 = r2 - 16 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xE0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = 0x7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /* Instruction 11, 13, 15, 17 : Copy generated header , r3 = r3 - 16 */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 0x18;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = 0x7;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }
        
        /* Instruction 18 : Copy Ether type , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 24;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 19 : Copy Link Layer , r0 = r0 -16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 20 : Copy Link Layer , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 21 : Copy Link Layer , r0 = r0 -16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 22 : Copy Link Layer , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xF0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 23 : Copy Link Layer , --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    /* vxlan support use program for version under arad+. Arad+ support VxLAN by design. */
    else if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VXLAN].prog_used != -1) { 

        /* IPv4 size with GRE*/
        fld_val = 0x24;
        SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  90,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, EPNI_IPV4_SIZE_WITH_GRE_8_KEYr, SOC_CORE_ALL, 0, IPV4_SIZE_WITH_GRE_8_KEYf,  fld_val)); 
        /* gre next protocol is udp */
        fld_val = 0x11;
        SOC_SAND_SOC_IF_ERROR_RETURN_ERR_VAL(res,  100,  exit, ARAD_REG_ACCESS_ERR,soc_reg_above_64_field32_modify(unit, EPNI_IP_PROTOCOL_GREr, SOC_CORE_ALL, 0, IP_PROTOCOL_GREf,  fld_val)); 

        /* Program 12 instructions (entries 24, 25 in each table) - VXLAN */
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_VXLAN);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_VXLAN);
        entry = entry_odd;

        /* Instruction 0 : Copy FWD Header MSBs 0 (always)
                           CALC Forwarding header size and store in REG-SIZE */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = 0xF0; /* -8*(8/4) = -16 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
        /* Instruction 1 : Copy IPv4.Total-Length */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = (4*8)/4; /* IPv4.Total-Length is 2 Byte offset from start of IPv4 header */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0; /* Start of IPv4 */
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
        /* Instruction 2 : Copy FWD Header MSBs 1
                           Decrement REG-SIZE by 24 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = 0xE0; /* (-8-8) * (8/4) = -32 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
        prge_instruction_tbl_data.op_value        = 24;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
        /* Instruction 3 : Copy FWD Header MSBs 2
                           R1 = IPv4.Total-Length - 20 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = 0xD0; /* (-16-8) * (8/4) = -48 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x10; /* -16 5b' */
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 20;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 4 : Copy FWD Header MSBs 3 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = 0xC0; /* (-24-8) * (8/4) = -64 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /*  Instruction 5 : Copy FWD Header MSBs 4 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = 0xB0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 6 : Generate VxLAN-Header Reserved MSBs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* SrcSelectResolvedData */
        prge_instruction_tbl_data.offset_base     = 3; /* (16+2.5+4+4+2+1+3+8+8+0.5+2.5+4+1+1+8+(-64))*8/4 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 7 : Generate VxLAN-Header VNI */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = 0xEE; /* -9 * (8/4) = -18 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_base       = 3;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 8 : Generate VxLAN-Header.FLAGs,VxLAN-Header.Reserved-LSBs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* SrcSelectResolvedData */
        prge_instruction_tbl_data.offset_base     = 127; /* (16+2.5+4+4+2+1+3+8+8+0.5+2.5+4+1+1+6)*8/4 = (63.5)*8/4 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 9 : Generate UDP CheckSum */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* SrcSelectResolvedData */
        prge_instruction_tbl_data.offset_base     = 128; /* (128+(-64))*8/4 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 10 : genrate UDP Length */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* SrcSelectResolvedData */
        prge_instruction_tbl_data.offset_base     = 55; /* (16+69.5+2+2+2+(-64))*8/4; R1 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 11 : Generate Dest Port */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* SrcSelectResolvedData */
        prge_instruction_tbl_data.offset_base     = 119; /* (16+2.5+4+4+2+1+3+8+8+0.5+2.5+4+1+1+2)*8/4 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 12 : Generate Src Port 1 (LB-Key) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* SrcSelectResolvedData */
        prge_instruction_tbl_data.offset_base     = 128; /* (128+(-64))*8/4 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 13 : Generate Src Port 0 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0; /* SrcSelectHeader */
        prge_instruction_tbl_data.offset_base     = 20; /* (10)*8/4; FTMH-EXT.LB */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /* Instruction 14 : IP19_12 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = 40; /* (20)*8/4 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 15 : IP11_4 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = 24; /* (12)*8/4 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 16 : IP3_0 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = 1; /* (4)*8/4 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 17 : Generate LL-ETH 0 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = 0x12; /* (0)*8/4 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 18 : Generate LL-ETH 1 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = 0x2; /* (-8)*8/4 = -16 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_base       = 0x1; /* -8 5b' */
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 19 : Generate LL-ETH 2 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1; /* SrcSelectGeneratedHeader */
        prge_instruction_tbl_data.offset_base     = 0x0; /* (-16)*8/4 = -32 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_base       = 0x0; /* -16 5b' */
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 20 : */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xf0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_base       = 0x18;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 21 : */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 1;
        prge_instruction_tbl_data.offset_base     = 0xe0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
        prge_instruction_tbl_data.size_base       = 0x10;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 22 : */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

    }

    /* Program 13 instructions (entries 26, 27 in each table) - erspan */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN].prog_used != -1) { 

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_ERSPAN);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_ERSPAN);
        entry = entry_odd;
    
        /* Instruction 0 : Write ERSPAN-Header 6LSBytes {Priority(3),Reserved(1),Direction(1),Truncated(1),SPAN-ID(10)}
              Directly Extracted from EES1[55:8] */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 2;  /* resolved data */
        prge_instruction_tbl_data.offset_base      = 29; /*(78.5+(-64))*8/4;*/
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base        = 6;
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.alu_action       = 0;
        prge_instruction_tbl_data.cmp_action       = 0; /*cmp_actionNever;*/
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 1 : Write ERSPAN-Header 2MSBytes {Version(4) 0x1,VLAN(12) 0x0}
              Directly Extracted from Program-VAR[15:0] */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 2;  /* resolved data */
        prge_instruction_tbl_data.offset_base      = 3; /* (65.5+(-64))*8/4; */
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base        = 2;
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.cmp_action       = 0; /* never */
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 2 and after - Write Generated-Header Without FWD-Header */
        for (mem = EPNI_PRGE_INSTRUCTION_0m + 1; mem < EPNI_PRGE_INSTRUCTION_0m + 9; mem++) {
            /* Instruction 2, 4,.. */
            /*mem   = (entry == entry_odd) ? (mem + 1) : mem;*/
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;/* generated header */
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2; 
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
            prge_instruction_tbl_data.op_value          = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action        = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action        = 7;
            prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_R2;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* Instruction 3, 5,.. */
            /*mem   = (entry == entry_odd) ? (mem + 1) : mem;*/
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;
            prge_instruction_tbl_data.offset_base = 0xf0;/* -16;*/
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2; 
            prge_instruction_tbl_data.size_base   = 0x18;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value          = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action        = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action        = 0;
            prge_instruction_tbl_data.dst_select        = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);
        }

        /* Instraction #18 */
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 1;/* generated header */
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2; 
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value          = 8;                       /* since we do not concatenating in the folowing instraction */
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action        = 7;
        prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instraction #19 - Extract Resolved.Data.tm-port-var (1B)*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select  = 2;    
        prge_instruction_tbl_data.offset_base = 53; /* 128+32+32+20 bits - Resolved Data: tm-port-var */
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; /* 0 - offset to tm-port-var */
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BIT_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action        = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

        /* Instraction #20 - Concatenate generated Headers */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 1;/* generated header */
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2; 
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value          = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action        = 7;
        prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instraction #21 - Concatenate generated Headers and
         * ALU operation with LFEM op_value added dest ti R_Size
         */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 1;
        prge_instruction_tbl_data.offset_base = 0xf0;/* -16;*/
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2; 
        prge_instruction_tbl_data.size_base   = 0x18;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
        prge_instruction_tbl_data.alu_action        = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action        = 0x7; /* always */
        prge_instruction_tbl_data.dst_select        = ARAD_PP_PRGE_ENG_DST_REG_SZ; /* R_Size */
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 380, exit);

        /* Instraction #22 - Concatenate generated Headers */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 1;/* generated header */
        prge_instruction_tbl_data.offset_base = 0;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2; 
        prge_instruction_tbl_data.size_base   = 0;
        prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action        = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* instruction #23
         * Copy Additional 1B based on the ARAD_PP_PRGE_ENG_SIZE_REG_SZ size
         */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 2;
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.offset_base = 113; /* 128+324 bits - Resolved Data: out-PP-port */
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_SZ; /* equal 1 if tm-port-var is equal 1. Calc in inst #21 */
        prge_instruction_tbl_data.size_base   = 0; 
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*No FEM */;
        prge_instruction_tbl_data.op_1_field_select     = 0;
        prge_instruction_tbl_data.op_value    = 0;
        prge_instruction_tbl_data.op_2_field_select     = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = 0;
        prge_instruction_tbl_data.cmp_action  = 0;  /* Do not Perform ALU */
        prge_instruction_tbl_data.dst_select  = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

    }  /* End of ARAD_EGR_PROG_EDITOR_PROG_ERSPAN */

    /* Program 13 instructions (entries 26, 27 in each table) - ERSPAN for B1 and bellow */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA].prog_used != -1) { 

            int mc_support = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "erspan_mc_support", 0) ;
            mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
            entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA);
            entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA);
            entry = entry_odd;
    
           /* get the erspan mirror entries offset in prge memory */
           res = arad_sw_db_eg_encap_prge_tbl_nof_dynamic_entries_get(unit, &nof_dynamic_members);
           SOC_SAND_CHECK_FUNC_RESULT(res, 375, exit);


            /* Instruction 0 : extract vsi variable[3:0]*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = (mc_support)? 2:0;
            prge_instruction_tbl_data.offset_base     = (mc_support)? 65:17; /*VSI VAR or shift 68 bits for FTMH.Outlif*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 1 : extract vsi variable[3:0]*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = (mc_support)? 2:0;
            prge_instruction_tbl_data.offset_base     =  (mc_support)? 65:17; /*VSI VAR or shift 68 bits for FTMH.Outlif*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            /* Instruction 1/2 = 0%2 = 0 --> even lfem */
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_WA, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 2 : data_addr=fem + 0 (first entry)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = nof_dynamic_members; /* first entry offset*/
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 3 : rsz = fem +0x10 (prepare the second entry)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = nof_dynamic_members + 16; /*second entry offset*/
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 4 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 5 : data_addr = rsz (second entry)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 6 : nop*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 7: nop*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 8 : copy erspan from mem, rsz = program var*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 32; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 0 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 9: Extract Eth Hdr size from mem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 16;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            /* Instruction 10 : copy IPv4oGRE from generated header 1/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1 ;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 11 : copy IPv4oGRE from generated header 2/4 - total size 28 = 3*8+4; rsz =fem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            
            /* Instruction 12 : copy IPv4oGRE from generated header 3/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 13 : copy IPv4oGRE from generated header 4/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 14 : copy EtherType from DataMem (first entry -top)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 4; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 15: nop*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 16: copy tag(if exist) from mem eth header, size -> rsz*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 32;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base     = 0x12;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 17: copy from mem eth header SA*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 24;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 6; 
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 18: copy from mem eth header DA, */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 12;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 6; 
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
  
    /* Program 15 instructions (entries 30, 31 in each table) - STACKING_PROGRAM */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING].prog_used != -1) { 

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_STACKING);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_STACKING);
        entry = entry_odd;
        
        /* Instruction 0 : --- , r2 = r3 - r1; */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 1 : --- , rsz = r0 - 9 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value        = 9;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 2 : get PRGE TM var */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2; /* resolved data */
        prge_instruction_tbl_data.offset_base     = 53; /* 128+20+32+32 bits - port var [9:0] in resolved data */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 3 : Copy system header LSB , r2 = r2 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 4 : jump */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 5 : Copy system header LSB , r3 = r3 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xF0; /* -16 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 8;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 6 : Copy system header LSB , r2 = r2 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xE0; /* -32 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R2;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 7 : Copy system header LSB , r3 = r3 - 16 */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0xF0; /* -16 */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 0x18; /* -8 5b' */
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R2;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value        = 16;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
    /* STACKING FEM 2 */

    /* Instruction 8 : jump back */
    mem   = 4 + EPNI_PRGE_INSTRUCTION_0m;
    entry = entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0; 
    prge_instruction_tbl_data.op_value        = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING].program_pointer << 5; /* {6'h0, 5'program_pointer, 4'h0, 1'h0}; */
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = 0x7;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /* Instruction 9 : get stacking ext and perform FEM */
    mem   = 4  + EPNI_PRGE_INSTRUCTION_0m;
    entry = entry_odd;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    /* Instruction 9/2 = 4%2 = 0 --> even lfem */
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8,
            mem, ARAD_EGR_PROG_EDITOR_PROG_2_HOP_SCHEDULING, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
    /* Save stacking lfem data for later use */
    /* { */
        lfem_stacking_8_index[unit] = prge_instruction_tbl_data.fem_select;
        lfem_stacking_8_map[unit] = (mem - EPNI_PRGE_INSTRUCTION_0m) % ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit);
    /* } */
    prge_instruction_tbl_data.op_1_field_select = 0; 
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
    /* Instruction 10 : Copy other extension */
    mem   = 5 + EPNI_PRGE_INSTRUCTION_0m;
    entry = entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
    /* Instruction 11 : nop */
    mem   = 5 + EPNI_PRGE_INSTRUCTION_0m;
    entry = entry_odd;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
    /* STACKING FEM 3 */

    /* Instruction 8 : jump back */
    mem   = 4 + EPNI_PRGE_INSTRUCTION_0m;
    entry = 36;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING].program_pointer << 5; /* {6'h0, 5'program_pointer, 4'h0, 1'h0}; */
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
    prge_instruction_tbl_data.cmp_action      = 0x7;
    prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_INST_ADDR;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
    
    /* Instruction 9 : get stacking ext and perform FEM */
    mem   = 4 + EPNI_PRGE_INSTRUCTION_0m;
    entry = 37;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 4;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
    prge_instruction_tbl_data.size_base       = 2;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    /* Instruction 9/2 = 4%2 = 0 --> even lfem */
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10,
            mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit);
    /* Save stacking lfem data for later use */
    /* { */
        lfem_stacking_10_index[unit] = prge_instruction_tbl_data.fem_select;
        lfem_stacking_10_map[unit] = (mem - EPNI_PRGE_INSTRUCTION_0m) % ARAD_PP_EG_PROG_NOF_LFEM_TABLES(unit);
    /* } */
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /* Instruction 10 : Copy other extension */
    mem   = 5 + EPNI_PRGE_INSTRUCTION_0m;
    entry = 36;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

    /* Instruction 11 : nop */
    mem   = 5 + EPNI_PRGE_INSTRUCTION_0m;
    entry = 37;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 0;
    prge_instruction_tbl_data.offset_src      = 0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
  
    /* Instruction 12 : Extract FTMH [3:0], --- */
    mem   = 6 + EPNI_PRGE_INSTRUCTION_0m;
    entry = entry_even;
    prge_instruction_tbl_data.src_select      = 0;
    prge_instruction_tbl_data.offset_base     = 18;
    prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
    prge_instruction_tbl_data.size_base       = 0;
    prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
    res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
            mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
    SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
    prge_instruction_tbl_data.op_1_field_select = 0;
    prge_instruction_tbl_data.op_value        = 0;
    prge_instruction_tbl_data.op_2_field_select = 0;
    prge_instruction_tbl_data.alu_action      = 0;
    prge_instruction_tbl_data.op_3_field_select = 0;
    prge_instruction_tbl_data.cmp_action      = 0;
    prge_instruction_tbl_data.dst_select      = 0;
    res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
    SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 13 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 14 : Extract CUD [11:0], r0 = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 57;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 15 : Extract FTMH [31:20], --- */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 13;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_TDM_CUD_STACKING_EXTRACT_CUD,
                mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 16 : ---, r0 = r0 + fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 17 : Extract CUD [15:12], r1 = fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 54;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        /* Instruction 17/2 = 8%2 = 0 --> even lfem */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_STACKING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 18 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 19 :---, r1 = r1 + fem */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action      = 0x7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 20 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 21 : Copy {r1, r0} */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 4;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 22 : Copy left FTMH */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 10;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 5;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 23 : if enabled add as MSB 1Byte of user header*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
#ifdef BCM_88660_A0
        if (SOC_IS_ARADPLUS(unit)) {
            prge_instruction_tbl_data.offset_base     = 2;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = (SOC_DPP_CONFIG(unit)->arad->init.fabric.ftmh_lb_ext_mode == ARAD_MGMT_FTMH_LB_EXT_MODE_FULL_HASH) ? 1 : 0;
        } else 
#endif /* BCM_88660_A0 */
        {
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
        }
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
		
    /* Program 15 instructions (entries 30, 31 in each table) - STACKING_PROGRAM*/
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC].prog_used != -1) {
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_STACKING_UC);
        entry = entry_odd;


        /* Instruction 0 : if enabled add as MSB 1Byte of user header*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }
		

    /* Program 14 instructions (entries 28, 29 in each table) - rspan */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_RSPAN].prog_used != -1) { 

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_RSPAN);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_RSPAN);
        entry = entry_odd;
        
        /* Instruction 0 : copy from data entry 32 bits */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 2;  /* resolved data internal fileds */
        prge_instruction_tbl_data.offset_base      = 29; /*(78.5+(-64))*8/4;*/ 
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base        = 4; /* bytes*/ /* 55:24  (32) + lsb (01)*/
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit); /* null*/
        prge_instruction_tbl_data.alu_action       = 0;
        prge_instruction_tbl_data.cmp_action       = 0; /*cmp_actionNever;*/
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value          = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action        = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.dst_select        = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 1 : Copy SA */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 0; /*SrcSelectHeader;*/  /* resolved data internal fileds */
        prge_instruction_tbl_data.offset_base      = 2 * user_header_size + (12)*8/4; /* FTMH-EXT.LB */
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base        = 6;
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit);/* null*/
        prge_instruction_tbl_data.alu_action       = 0;
        prge_instruction_tbl_data.cmp_action       = 0; /*cmp_actionNever;*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 2 : Copy SDA */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 0; /*SrcSelectHeader;*/  /* resolved data internal fileds */
        prge_instruction_tbl_data.offset_base      = 2 * user_header_size + (6)*8/4; /* FTMH-EXT.LB */
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base        = 6;
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit);/* null*/
        prge_instruction_tbl_data.alu_action       = 0;
        prge_instruction_tbl_data.cmp_action       = 0; /*cmp_actionNever;*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        /* Instruction 3 : do nothing */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select       = 0; /*SrcSelectHeader;*/  /* resolved data internal fileds */
        prge_instruction_tbl_data.offset_base      = (6)*8/4; /* FTMH-EXT.LB */
        prge_instruction_tbl_data.offset_src       = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src         = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base        = 0;
        prge_instruction_tbl_data.fem_select       = ARAD_PP_EG_PROG_NOF_FEM(unit);/* null*/
        prge_instruction_tbl_data.alu_action       = 0;
        prge_instruction_tbl_data.cmp_action       = 0; /*cmp_actionNever;*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* Instruction 4 and after - Write Generated-Header Without FWD-Header */
        for(mem = EPNI_PRGE_INSTRUCTION_0m + 2; mem < EPNI_PRGE_INSTRUCTION_0m + 12; mem++)
        {
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;/* generated header */
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST; 
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action  = 0;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST; 
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action  = 0;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }  

        /* For this program, fill other instructions with NOPs */
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }



   /*  Program 4 instructions (entries 8, 9 in each table) - ARAD_PRGE_TM_SELECT_L2_REMOTE_CPU */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU].prog_used != -1)
    {   
        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_L2_REMOTE_CPU);
        entry = entry_odd;

        /*  Instruction 0 : Indirect acceess address = programmable variable (step 1)*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2; /* resolved data */                                       ;
        prge_instruction_tbl_data.offset_base     = 3; /* 223:160 bits - Programm var[63:0] in resolved data */ ;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        /*offset in nibbles = 0+{bitexpansion=0,40} = 40Nibbles = 160Bit is the offset*/
        prge_instruction_tbl_data.size_base       = 0x0;/*0 - no operation on header*/
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;/*no operation on egress*/
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*default FEM - pass as is*/
        prge_instruction_tbl_data.op_1_field_select = 0;/*not in use*/
        prge_instruction_tbl_data.op_value        = 0;/*not in use*/
        prge_instruction_tbl_data.op_2_field_select = 0;/*not in use*/
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;/*not in use*/
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R0;/*not in use*/
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;/*not in use*/
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0; /*not in use*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 1 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 2 : Indirect acceess address = programmable variable (step 2)*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;/*not in use*/
        prge_instruction_tbl_data.offset_base     = 40; /*not in use*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0x0;/*not in use*/
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;/*not in use*/
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*not in use*/
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;/*take from FEM - the address as is*/
        prge_instruction_tbl_data.op_value        = 0;/*not in use*/
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;/*take from ALU result - the address as is*/
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;/*no compare*/
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR; /*Send to data memory*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 3 : copy port prge var to header (2 bytes)*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;

        prge_instruction_tbl_data.src_select      = 2;/*resolved data*/
        prge_instruction_tbl_data.offset_base     = 53; /*prge var in resolved data*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0x2;/*write 2 bytes*/
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;/*not in use*/
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*not in use*/
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 4-7 : nop */
        for (i=4; i<8; i++) {
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;

                prge_instruction_tbl_data.src_select      = 0;
                prge_instruction_tbl_data.offset_base     = 0;
                prge_instruction_tbl_data.offset_src      = 0;
                prge_instruction_tbl_data.size_base       = 0;
                prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
                prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select = 0;
                prge_instruction_tbl_data.op_value        = 0;
                prge_instruction_tbl_data.op_2_field_select = 0;
                prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
                prge_instruction_tbl_data.op_3_field_select = 0;
                prge_instruction_tbl_data.cmp_action      = 0;
                prge_instruction_tbl_data.dst_select      = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        }

        /* Instruction 8: copy 8 LSB of data from data memory to packet header */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;/*resolved data*/
        prge_instruction_tbl_data.offset_base     = 32; /* 8 LSB of data memory */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 8;/*write 8 bytes*/
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;/*write 2 bytes*/
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*not in use*/
        prge_instruction_tbl_data.op_1_field_select = 0;/*not in use*/
        prge_instruction_tbl_data.op_value        = 0;/*not in use*/
        prge_instruction_tbl_data.op_2_field_select = 0;/*not in use*/
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;/*not in use*/
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R0;/*not in use*/
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;/*not in use*/
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0; /*not in use*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*  Instruction 9 : copy 8 MSB of data from data memory to packet header*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        
        prge_instruction_tbl_data.src_select      = 2;/*resolved data*/
        prge_instruction_tbl_data.offset_base     = 16; /* 8 MSB of data memory */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 8;/*write 8 bytes*/
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;/*write 2 bytes*/
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit); /*not in use*/
        prge_instruction_tbl_data.op_1_field_select = 0;/*not in use*/
        prge_instruction_tbl_data.op_value        = 0;/*not in use*/
        prge_instruction_tbl_data.op_2_field_select = 0;/*not in use*/
        prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;/*not in use*/
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R0;/*not in use*/
        prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;/*not in use*/
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0; /*not in use*/
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

        
        /* Program 4 instructions (entries 8, 9 in each table) - ERSPAN Inbound Mirror ERSPAN NO WA + XGS PE from FTMH */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA].prog_used != -1)
    {   
           mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
           entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA);
           entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA);
           entry = entry_odd;
            
            /* Instruction 0 : Write ERSPAN-Header 6LSBytes {Priority(3),Reserved(1),Direction(1),Truncated(1),SPAN-ID(10)} Extracted from EES1[55:8]*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 29; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 1 : Write ERSPAN-Header 2MSBytes {Version(4) 0x1,VLAN(12) 0x0} Extracted from Program-VAR[15:0]*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instructions 2-13 - copy generated without forwarding header (link+1st enc+2nd enc)*/
            for(i = 0; i<6 ; i++)
            {
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select  = 1;
                prge_instruction_tbl_data.offset_base = 0;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2 ;
                prge_instruction_tbl_data.size_base   = 0;
                prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R2;
                prge_instruction_tbl_data.op_value    = 16;
                prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
                prge_instruction_tbl_data.alu_action  = 0;
                prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
                prge_instruction_tbl_data.cmp_action = 7 ;
                prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                
                
                mem   = (entry == entry_odd) ? (mem + 1) : mem;
                entry = (entry == entry_even) ? entry_odd : entry_even;
                prge_instruction_tbl_data.src_select  = 1;
                prge_instruction_tbl_data.offset_base     = 0xF0;
                prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
                prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R2 ;
                prge_instruction_tbl_data.size_base     = 0x18;
                prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
                prge_instruction_tbl_data.op_1_field_select     = 0;
                prge_instruction_tbl_data.op_value    = 0;
                prge_instruction_tbl_data.op_2_field_select     = 0;
                prge_instruction_tbl_data.alu_action  = 0;
                prge_instruction_tbl_data.op_3_field_select     = 0;
                prge_instruction_tbl_data.cmp_action  = 0;
                prge_instruction_tbl_data.dst_select  = 0;
                res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
                SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                
            }
            
            /* Instruction 14: copy PPD from program var*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 15: copy DP  FRC line 4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 11;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 16: copy src sys port FRC line 3*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 43;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 17: copy dest sys port FRC line 2*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 39;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 18: copy FTMH.TC FRC line 1*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 5;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_NO_WA, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }


        /* Program 4 instructions (entries 8, 9 in each table) - ERSPAN Inbound Mirror ERSPAN WA + XGS PE from FTMH */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH].prog_used != -1)
    {
           int mc_support = soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "erspan_mc_support", 0) ;
           mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
           entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH);
           entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH);
           entry = entry_odd;
            
           /* get the erspan mirror entries offset in prge memory */
           res = arad_sw_db_eg_encap_prge_tbl_nof_dynamic_entries_get(unit, &nof_dynamic_members);
           SOC_SAND_CHECK_FUNC_RESULT(res, 376, exit);


            /* Instruction 0 : extract vsi variable[3:0]*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
           prge_instruction_tbl_data.src_select      = (mc_support)? 2: 0;
          prge_instruction_tbl_data.offset_base     = (mc_support)? 65: 17; /*VSI variable*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 1 : extract vsi variable[3:0]*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = (mc_support)? 2 : 0;
            prge_instruction_tbl_data.offset_base     = (mc_support)?65 : 17; /*VSI variable*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 2 : data_addr=fem + 0 (first entry)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = nof_dynamic_members; /* first entry offset*/
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 3 : rsz = fem +0x10 (prepare the second entry)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = nof_dynamic_members + 16; /*second entry offset*/
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 1;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 4 : nop */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 5 : data_addr = rsz (second entry)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 6 : extract program var for Eth header size*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 7: nop*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 8 : copy erspan from mem, rsz = program var*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 32; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 9 : copy IPv4oGRE from generated header 1/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1 ;
            prge_instruction_tbl_data.op_value        = 16;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 10 : copy IPv4oGRE from generated header 2/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 11 : copy IPv4oGRE from generated header 3/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 12 : copy IPv4oGRE from generated header 4/4 - total size 28 = 3*8+4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 13 : copy EtherType from DataMem (first entry -top)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 4; 
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 14: extract DP */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 11;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 15: nop*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 16: copy from mem the eth header, size -> rsz; r1=fem*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 32;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base     = 0x1E;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 17: copy from mem eth header, size -> rsz; r0=0*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 16;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
            prge_instruction_tbl_data.size_base     = 0x16;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
            prge_instruction_tbl_data.cmp_action = 7 ;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 18: copy from program var PPD 6LSB*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 0xFF;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 19: copy from r0 (0) PPD 2LSB*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 59;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 20: copy DP from r1 (FRC line 4)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 55;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 21: copy src sys port ( FRC line 3)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 47;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 22: copy dst sys port ( FRC line 2)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 39;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 23: copy TC ( FRC line 1)*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 5;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_ERSPAN_XGS_PE_FROM_FTMH, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

  /* epni_prge_mim_ptch2 */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2].prog_used != -1)
    {   
           mem   = EPNI_PRGE_INSTRUCTION_0m;
           entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2);
           entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2);
           entry = entry_even;

          /* Instruction 0 build PTCH */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_RESOLVED;
          prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_ACE_VARIABLE;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 2;
          res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_BUILD_PTCH_2B,
                  mem, ARAD_EGR_PROG_EDITOR_PROG_MIM_PTCH2, &(prge_instruction_tbl_data.fem_select));
          SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* For this program, fill other instructions with NOPs */
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

  /* ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM].prog_used != -1)
    {   
           mem   = EPNI_PRGE_INSTRUCTION_0m;
           entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM);
           entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_VMAC_DOWNSTREAM);
           entry = entry_even;

          /* Instruction 0-11 - Ethernet Copy */
          for(i=0; i<6; i++) {
              prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
              prge_instruction_tbl_data.offset_base = 0;
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
              prge_instruction_tbl_data.size_base   = 0x1A/*-6*/;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
              prge_instruction_tbl_data.op_value    = 16;
              prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
              prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
              prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
              prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
              prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

              arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

              prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
              prge_instruction_tbl_data.offset_base = 0xF0/*-16*/;
              prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
              prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
              prge_instruction_tbl_data.size_base   = 0x12/*-14*/;
              prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
              prge_instruction_tbl_data.op_1_field_select     = 0;
              prge_instruction_tbl_data.op_value    = 0;
              prge_instruction_tbl_data.op_2_field_select     = 0;
              prge_instruction_tbl_data.alu_action      = 0;
              prge_instruction_tbl_data.op_3_field_select     = 0;
              prge_instruction_tbl_data.cmp_action  = 0;
              prge_instruction_tbl_data.dst_select  = 0;
              res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
              SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

              arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);
          }

          /* Instruction 12-16 build DA */

          /* Instruction 12 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_RESOLVED;
          prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_SYS_HEADERS_SIZE;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 13 - NOP */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 14 */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value    = 8;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 15 - NOP */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 16 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_ORIGINAL;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 6;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* For this program, fill other instructions with NOPs */
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

  /* ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM].prog_used != -1)
    {   
          mem   = EPNI_PRGE_INSTRUCTION_0m;
          entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM);
          entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_VMAC_UPSTREAM);
          entry = entry_even;


          /* Instruction 0 */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_value    = 12;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 1 - NOP */

          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 2-13 - Ethernet Copy */

          /* Instruction 2 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 3 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.offset_base = 0xF0/*-16*/;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.size_base   = 0x18 /*-8*/;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_value    = 24;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 4 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x10/*-16*/;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 5 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0xF0/*-16*/;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 6 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x18 /*-8*/;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base =0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 7 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0xF0/*-16*/;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 8 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x18 /*-8*/;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base =0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 9 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0xF0;/*-16*/;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 10 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x18 /*-8*/;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base =0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 11 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base = 0xF0/*-16*/;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R1;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R1;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 12 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.size_base   = 0x18 /*-8*/;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
          prge_instruction_tbl_data.offset_base =0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.op_value    = 16;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 13-18 build DA */

          /* Instruction 13 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_RESOLVED;
          prge_instruction_tbl_data.offset_base = ARAD_PP_PRGE_SYS_HEADERS_SIZE;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 14 - NOP */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 15 */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
          prge_instruction_tbl_data.op_value    = 8;
          prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
          prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_ADD;
          prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
          prge_instruction_tbl_data.cmp_action  = ARAD_PP_PRGE_CMP_PASS_ALL;
          prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R2;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 16 - NOP */
          prge_instruction_tbl_data.src_select  = 0;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = 0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 0;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 17 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_ORIGINAL;
          prge_instruction_tbl_data.offset_base = 0;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 6;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* Instruction 18 */
          prge_instruction_tbl_data.src_select  = ARAD_PP_PRGE_SRC_GENERATED;
          prge_instruction_tbl_data.offset_base = 12;
          prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
          prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
          prge_instruction_tbl_data.size_base   = 6;
          prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
          prge_instruction_tbl_data.op_1_field_select     = 0;
          prge_instruction_tbl_data.op_value    = 0;
          prge_instruction_tbl_data.op_2_field_select     = 0;
          prge_instruction_tbl_data.alu_action      = 0;
          prge_instruction_tbl_data.op_3_field_select     = 0;
          prge_instruction_tbl_data.cmp_action  = 0;
          prge_instruction_tbl_data.dst_select  = 0;
          res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
          SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

          arad_egr_prog_editor_next_mem_and_entry_find(&entry, &mem);

          /* For this program, fill other instructions with NOPs */
          SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

        /* Program 10 instructions (entries 28, 29 in each table) - RSPAN  Mirror + XGS */
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS].prog_used != -1)
    {   
           mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
           entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS);
           entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS);
           entry = entry_odd;
            
            
            /* Instruction 0 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 29; /*ees_data1*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 4;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            

            /* Instruction 1 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 24; /*SA*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 2 : */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 12; /* DA*/
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_base       = 6;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0 ;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0 ;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0 ;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 3: copy PPD from program var*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 3;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 8;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                
            
            /* Instruction 4 NOP*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 5 NOP*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
            prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action      = ARAD_PP_EG_PROG_NO_COMPARE;
            prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 6: copy DP  FRC line 4*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 11;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_FROM_FTMH_EXTRACT_DP,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 7: copy src sys port FRC line 3*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 47;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            
            /* Instruction 8: copy dest sys port FRC line 2*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 2;
            prge_instruction_tbl_data.offset_base     = 53;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 9 NOP*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 0;
            prge_instruction_tbl_data.offset_src      = 0;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            prge_instruction_tbl_data.size_base       = 0;
            prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* Instruction 10: copy FTMH.TC FRC line 1*/
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select      = 0;
            prge_instruction_tbl_data.offset_base     = 5;
            prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
            prge_instruction_tbl_data.size_base       = 2;
            prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
            res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_XGS_FRC_LITE_FRC_FROM_FTMH_EXTRACT_TC,
                    mem, ARAD_EGR_PROG_EDITOR_PROG_RSPAN_XGS, &(prge_instruction_tbl_data.fem_select));
            SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
            prge_instruction_tbl_data.op_1_field_select = 0;
            prge_instruction_tbl_data.op_value        = 0;
            prge_instruction_tbl_data.op_2_field_select = 0;
            prge_instruction_tbl_data.alu_action      = 0;
            prge_instruction_tbl_data.op_3_field_select = 0;
            prge_instruction_tbl_data.cmp_action      = 0;
            prge_instruction_tbl_data.dst_select      = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
            
            
            /* For this program, fill other instructions with NOPs */
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT].prog_used != -1)     
    {

        mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT);
        entry = entry_odd;

        /* Instruction 0 : copy first 2 bytes setting 1 bit to 0*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 12;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 2 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OLP_PETRA_A,
                mem, ARAD_EGR_PROG_EDITOR_PROG_OLP_PETRA_A_RESET_IS_KEY_BIT, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
        
        /* Instruction 1 : copy next 6 bytes with no change */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 8;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
        prge_instruction_tbl_data.size_base       = 4 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
        
         /* Instruction 2 : Add to junk bytes */
         mem   = (entry == entry_odd) ? (mem + 1) : mem;
         entry = (entry == entry_even) ? entry_odd : entry_even;
         prge_instruction_tbl_data.src_select      = 0;
         prge_instruction_tbl_data.offset_base     = 0;
         prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
         prge_instruction_tbl_data.size_base       = 2 ; 
         prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
         prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
         prge_instruction_tbl_data.op_1_field_select = 0;
         prge_instruction_tbl_data.op_value        = 0;
         prge_instruction_tbl_data.op_2_field_select = 0;
         prge_instruction_tbl_data.alu_action      = 0;
         prge_instruction_tbl_data.op_3_field_select = 0;
         prge_instruction_tbl_data.cmp_action = 0 ;
         prge_instruction_tbl_data.dst_select      = 0;
         res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
         SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
                    
         /* For this program, fill other instructions with NOPs */
         mem   = (entry == entry_odd) ? (mem + 1) : mem;
         entry = (entry == entry_even) ? entry_odd : entry_even;
         SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
    }

	if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER].prog_used != -1) {
		mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER);
        entry = entry_odd;

		/* 0: Get FTMH.Packet_Size */
		/*	  Set R0 = R3 + adjust */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0; /* original packet */
        prge_instruction_tbl_data.offset_base = 4; /* Need to move 2B */
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0; /* FTMH Header */
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_SIZE,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
        prge_instruction_tbl_data.op_value				= (soc_property_suffix_num_get(unit, -1, spn_CUSTOM_FEATURE, "add_size_header_adjust", 0)); 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_ADD; 
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		/* 1: Get Network Header Size */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 2; /* Registers */
		prge_instruction_tbl_data.offset_base = 35; /* Network Header Size */
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select     = 0;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = 0;
        prge_instruction_tbl_data.alu_action			= 0; 
        prge_instruction_tbl_data.op_3_field_select     = 0;
        prge_instruction_tbl_data.cmp_action			= 0;
        prge_instruction_tbl_data.dst_select			= 0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		/* 2: Get System Header Size	*/
		/*	  Set R0 = R0 + FTMH.Packet_Size */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 2; /* Registers */
		prge_instruction_tbl_data.offset_base = 33; /* System Header Size */
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0; 
		/* 2/2 = 1 % 2 = 1 -> odd */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_ADD;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		/* 3: Set R1 = Network Header Size - 2 (the size of the private header is not included) */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0; 
		prge_instruction_tbl_data.offset_base = 0; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0; 
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value				= 2; 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R1; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		/* 4: Set R0 = R0 - System Header Size (FEM) */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0; 
		prge_instruction_tbl_data.offset_base = 0; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0; 
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_FEM_FIELD;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_SUB;  
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

		/* 5: NOP */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0 ; 
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action = 0 ;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

		/* 6: Set R0 = R0 - R1 (Network Header Size) */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select  = 0; 
		prge_instruction_tbl_data.offset_base = 0; 
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 0; 
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R0;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_REG_R1;
        prge_instruction_tbl_data.alu_action			= ARAD_PP_EG_PROG_ALU_SUB;
        prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action			= ARAD_PP_EG_PROG_NO_COMPARE;
        prge_instruction_tbl_data.dst_select			= ARAD_PP_PRGE_ENG_DST_REG_R0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);
		        
		/* 7-18: Copy Generated Header */
		for(i = 0; i < 6; i++)
		{
			mem   = (entry == entry_odd) ? (mem + 1) : mem;
			entry = (entry == entry_even) ? entry_odd : entry_even;
          
			prge_instruction_tbl_data.src_select  = 1;
			prge_instruction_tbl_data.offset_base = 0;
			prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
			prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
			prge_instruction_tbl_data.size_base   = 0;
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
			prge_instruction_tbl_data.op_value    = 16;
			prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
			prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
			prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
			prge_instruction_tbl_data.cmp_action  = 0x7;
			prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

			mem   = (entry == entry_odd) ? (mem + 1) : mem;
			entry = (entry == entry_even) ? entry_odd : entry_even;
          
			prge_instruction_tbl_data.src_select  = 1;
			prge_instruction_tbl_data.offset_base = 0xF0; /*-16 */
			prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
			prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
			prge_instruction_tbl_data.size_base   = 0x18; /* -8 */
			prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
			prge_instruction_tbl_data.op_1_field_select     = 0;
			prge_instruction_tbl_data.op_value    = 0;
			prge_instruction_tbl_data.op_2_field_select     = 0;
			prge_instruction_tbl_data.alu_action      = ARAD_PP_EG_PROG_ALU_SUB;
			prge_instruction_tbl_data.op_3_field_select     = 0;
			prge_instruction_tbl_data.cmp_action  = 0;
			prge_instruction_tbl_data.dst_select  = 0;
			res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
			SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
		}
		
		/* 19: Append the Packet Size (R0) */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select  = 2;	/* Resolved */
        prge_instruction_tbl_data.offset_base = 59; /* R0 */
        prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.size_base   = 2; /* the size field is 2B */
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_14_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_ADD_PACKET_SIZE_HEADER, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select     = 0;
        prge_instruction_tbl_data.op_value				= 0; 
        prge_instruction_tbl_data.op_2_field_select     = 0;
        prge_instruction_tbl_data.alu_action			= 0; 
        prge_instruction_tbl_data.op_3_field_select     = 0;
        prge_instruction_tbl_data.cmp_action			= 0;
        prge_instruction_tbl_data.dst_select			= 0; 
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 680, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
	}


	if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN].prog_used != -1) {

/* Program 6 instructions (entries 12, 13 in each table) -*/
		mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
		entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN);
		entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN);
		entry = entry_odd;

/* Instruction 0 : Rsz = R3-R2 (calc native IP length)*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 1 : R1 = R2-R0 (calc Overlay length)*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R2;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 2 : R3 = R3-16 (calc next size), Copy 8B from offset R3*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; /* generated header*/
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 3 : Copy 8B from offset R3-16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; /* generated header*/
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 4 : Copy Remainder from offset R3 (updated in instr2)*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; /* generated header*/
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x10;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 5 : Copy 8B from Native Eth @ offset R0, Calc next size R0=R0-16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; /* generated header*/
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 6 : Copy 8B from Native Eth @ offset R0-16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; /* generated header*/
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 7 : Copy Remainder bytes from Native Eth @ offset R0*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1; /* generated header*/
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 8 : Take 4 index bits from resolved data*/
/* offset = (128+556-48-4)/4 = 158 nibbles --> const_96 + 62*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2; /* resolved data*/
		prge_instruction_tbl_data.offset_base     = 30;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 9 : nop*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 10 : Set indirect address = FEM result*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
        res = arad_sw_db_eg_encap_prge_tbl_overlay_arp_entries_base_index_get(unit, &prge_instruction_tbl_data.op_value);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
/*  	prge_instruction_tbl_data.op_value        = 0;   */
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 1;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU; 
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_DATA_ADDR;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 11 : Copy 8B from offset R2 (Overlay), Calc R1=R1-16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



/* Instruction 12 : Copy 8B from offset R2-16 (Overlay), Calc R2=R2-16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 13 : Copy 8B from offset R2-32 (Overlay), Calc R1=R1-16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xE0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R1;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 14 : Copy 8B from offset R2 (Overlay)*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xD0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 15 : Copy 8B from offset R2 (Overlay)*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xC0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R1;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 16 : Take 4 size bits from mem data*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 32; /* size is stored in [3:0]*/
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_4_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_DC_OVERLAY_VXLAN, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0; 
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0; /* minus*/
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 17 : Copy first 8 Bytes of Data-Memory {SA,VLAN,EthType}*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 31;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base       = 8;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 18 : Save FEM result in Rsz*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 19 : NOP*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


/* Instruction 20 : Copy remaining bytes of LL-Eth from DATA-Memory (if any)*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 15;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_SZ;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



/* Instruction 21 : Copy 6 Bytes from resolved-data, offset=128+256-48-8/4=157 nibbles (LL-Eth {DA})*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = 29;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
		prge_instruction_tbl_data.size_base       = 6; /* 6 bytes == 48 bits DA MAC*/
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

	}

	if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH].prog_used != -1) {
		mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
		entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH);
		entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_ETH);
		entry = entry_odd;

		/* Instruction 0 : r0 = r3-r2 */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 1 : nop */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		/* Instruction 2 : copy fwd hdr up to Eth SA, r0 = r0-28 */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x14;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		prge_instruction_tbl_data.op_value        = 12 + 8;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 3 :  r3 = r3 -16*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 4 : copy fwd hdr up to Eth SA ; */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 5 : copy fwd hdr up to Eth SA */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        =  16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 6 : copy fwd hdr up to Eth SA ; */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 7 : copy fwd hdr up to Eth SA */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        =  16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 8 : copy fwd hdr up to Eth SA ; */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0xF0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		prge_instruction_tbl_data.op_value        = 16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 9 : copy fwd hdr up to Eth SA */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
		prge_instruction_tbl_data.size_base     = 0x18;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R0;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R3;
		prge_instruction_tbl_data.op_value        =  16;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 10 :   copy DA 6bytes; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 12;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 6;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 11 :   copy SIP 6bytes ; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 24;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 6;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 12 :   copy out_pp_port(PTCH) 2byte; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_OUT_PP_PORT;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base       = 1;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 13 :   copy program var 0x80 (PTCH) 1byte; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     =  ARAD_PP_PRGE_PROGRAM_VAR;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
		prge_instruction_tbl_data.size_base       = 1;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );
	}
		
			
	if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH].prog_used != -1) {
		mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
		entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH);
		entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_REFLECTOR_IP_AND_ETH);
		entry = entry_odd;




		/* Instruction 0 : extrac sys hdr size; r3 = 18 */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_SYS_HEADERS_SIZE;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 18;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		/* Instruction 1 : extract from forwarding ethertype for 1 tag; rsz = 14*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = (12 + 2 + 4) * 2;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 14;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		/* Instruction 2 : ---- ; r0 =fem+18 */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
		prge_instruction_tbl_data.op_value        = 18;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 1;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		/* Instruction 3 :   --- ; rsz = (fem ==0x800) ? r3: rsz*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
		prge_instruction_tbl_data.op_value        = 0x0800;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R3;
		prge_instruction_tbl_data.cmp_action = 2;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 4 :   extract orig hdr eth type 1tag; r1 = r0-4*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_R0;
		prge_instruction_tbl_data.op_value        = 4;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 5 :  --; r3 =18-r0*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
		prge_instruction_tbl_data.op_value        = 18;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_SZ;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		/* Instruction 6 :   --- ; r1 = (fem ==0x800) ?  R0 :r1*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
		prge_instruction_tbl_data.op_value        = 0x0800;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_REG_R0;
		prge_instruction_tbl_data.cmp_action = 2;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		/* Instruction 7 :  nop*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = 0;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		/* Instruction 8 :   copy Data if tags 0/1 ;-------------*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = (20 + 4) * 2;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 9 :   copy IPv4 sip; */
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = (20 - 4) * 2;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
		prge_instruction_tbl_data.size_base       = 4;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 10 :   copy IPv4 dip; rzsz = r2+rsz*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = 20 * 2;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
		prge_instruction_tbl_data.size_base       = 4;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_REG_SZ;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R2;
		prge_instruction_tbl_data.alu_action      = 1;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 11 :   copy IPv4 rest 8 bytes; r3=r3+2*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = (20 - 8) * 2;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
		prge_instruction_tbl_data.size_base       = 8;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_OP_VALUE;
		prge_instruction_tbl_data.op_value        = 6;
		prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R3;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
		prge_instruction_tbl_data.cmp_action = 7;
		prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R3;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		/* Instruction 12 :   copy IPv4 rest 4bytes; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 0;
		prge_instruction_tbl_data.offset_base     = (20 - 16) * 2;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
		prge_instruction_tbl_data.size_base       = 4;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		/* Instruction 13 :  copy  ethertype 2Bytes +tag if exists; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 0;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
		prge_instruction_tbl_data.size_base       = 0;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



		/* Instruction 14 :   copy DA 6bytes; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 12;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 6;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 15 :   copy SIP 6bytes ; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 1;
		prge_instruction_tbl_data.offset_base     = 24;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R2;
		prge_instruction_tbl_data.size_base       = 6;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 16 :   copy out_pp_port(PTCH) 2byte; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_OUT_PP_PORT;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
		prge_instruction_tbl_data.size_base       = 1;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


		/* Instruction 17 :   copy program var 0x80 (PTCH) 1byte; ---*/
		mem   = (entry == entry_odd) ? (mem + 1) : mem;
		entry = (entry == entry_even) ? entry_odd : entry_even;
		prge_instruction_tbl_data.src_select      = 2;
		prge_instruction_tbl_data.offset_base     =  ARAD_PP_PRGE_PROGRAM_VAR;
		prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
		prge_instruction_tbl_data.size_base       = 1;
		prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
		prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
		prge_instruction_tbl_data.op_1_field_select = 0;
		prge_instruction_tbl_data.op_value        = 0;
		prge_instruction_tbl_data.op_2_field_select = 0;
		prge_instruction_tbl_data.alu_action      = 0;
		prge_instruction_tbl_data.op_3_field_select = 0;
		prge_instruction_tbl_data.cmp_action      = 0;
		prge_instruction_tbl_data.dst_select      = 0;
		res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
		SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

	}
		
    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING].prog_used != -1) {
        int    mem   = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING);
        entry = entry_odd;

        /* Instruction 0 : r0 = 1  */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 1;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 1 : extract  iNP[79]; rsz = 65  */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R3; 
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_EXTRACT_FTMH_TM_ACTION_IS_MC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_TM_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 65;
        prge_instruction_tbl_data.op_2_field_select = 0; 
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 2 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 3 : ------; rsz = (r0 == fem) ? op_value : rsz ( compare mc bit with r0, which is 1, if equal - UC, else MC, rsz holds offset in bytes)*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 63;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_OP_VALUE;
        prge_instruction_tbl_data.cmp_action = 2;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_SZ;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 4 : nop */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 0;
        prge_instruction_tbl_data.offset_src      = 0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /* Instruction 5 : copy 2 bytes from PrgeVar (program), based on rsz offset */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 1;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_SZ;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

    }

    if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING].prog_used != -1) {
        mem = EPNI_PRGE_INSTRUCTION_0m - 1;
        entry_odd = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_ODD(ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING);
        entry_even = _ARAD_EGR_PROG_EDITOR_PROG_ENTRY_EVEN(ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING);
        entry = entry_odd;

        /*Instruction 0-11 copy generated from Pipe Nwk Hdr*/
        for (i = 0; i < 6; i++) {
            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;
            prge_instruction_tbl_data.offset_base = 0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base   = 0;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = ARAD_PP_PRGE_ENG_OP1_REG_R3;
            prge_instruction_tbl_data.op_value    = 16;
            prge_instruction_tbl_data.op_2_field_select     = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
            prge_instruction_tbl_data.alu_action  = 0;
            prge_instruction_tbl_data.op_3_field_select     = ARAD_PP_PRGE_ENG_OP3_ALU;
            prge_instruction_tbl_data.cmp_action = 7;
            prge_instruction_tbl_data.dst_select  = ARAD_PP_PRGE_ENG_DST_REG_R3;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


            mem   = (entry == entry_odd) ? (mem + 1) : mem;
            entry = (entry == entry_even) ? entry_odd : entry_even;
            prge_instruction_tbl_data.src_select  = 1;
            prge_instruction_tbl_data.offset_base     = 0xF0;
            prge_instruction_tbl_data.offset_src  = ARAD_PP_PRGE_ENG_OFFSET_REG_R3;
            prge_instruction_tbl_data.size_src    = ARAD_PP_PRGE_ENG_SIZE_REG_R3;
            prge_instruction_tbl_data.size_base     = 0x18;
            prge_instruction_tbl_data.fem_select  = ARAD_PP_EG_PROG_NOF_FEM(unit);
            prge_instruction_tbl_data.op_1_field_select     = 0;
            prge_instruction_tbl_data.op_value    = 0;
            prge_instruction_tbl_data.op_2_field_select     = 0;
            prge_instruction_tbl_data.alu_action  = 0;
            prge_instruction_tbl_data.op_3_field_select     = 0;
            prge_instruction_tbl_data.cmp_action  = 0;
            prge_instruction_tbl_data.dst_select  = 0;
            res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
            SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        }

        /*Instr 12 extract sys hdrs size; -----*/
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_SYS_HEADERS_SIZE;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_8_LSBS,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /*Instr 13 extract with lfem { Rsvd2[0],3'b000,PrgePpPortVar[5:0],Rsvd3[15:10] }; --------- */
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_PP_PORT_VARIABLE;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_OUT_PP_PORT,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /*Instr 14 Copy OutLif as AID[15:0]; r1 = fem*/
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_OUT_LIF;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R1;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instr 15 Exctract with lfem 0 FTMH.TC[2:0],0x000} ; r0 = fem (store the extracted OutPpPort) */
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 5;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 0;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_TC,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_OP_VALUE;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);



        /*Instr 16 Copy {Rsvd4,AID[19:16]} - all 0 from PrgeVar[32:16]; r0 = fem*/
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 127;
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*Instr 17 Copy from UsrHdr LSByte (SB) with offset r1(sys hdr size); r0 = fem +r1 (combine the extraction for Tc and PpPort)*/
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 4; /* UsrHdr is with size of 2bytes*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = ARAD_PP_PRGE_ENG_OP1_FEM_FIELD;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = ARAD_PP_PRGE_ENG_OP2_REG_R0;
        prge_instruction_tbl_data.alu_action      = 1;
        prge_instruction_tbl_data.op_3_field_select = ARAD_PP_PRGE_ENG_OP3_ALU;
        prge_instruction_tbl_data.cmp_action = 7;
        prge_instruction_tbl_data.dst_select      = ARAD_PP_PRGE_ENG_DST_REG_R0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*Instr 18 Copy from UsrHdr MSByte {Rsvd3[9:0],SP[5:0]} with offset r1(sys hdr size) and LFEM; */
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 2; /* UsrHdr is with size of 2bytes*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_REG_R1;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_SP_5_0,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*Instr 19 Copy from R0 2 bytes ; */
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = 59; /* r0*/
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /*Instr 20 Copy FTMH.DP (lfem) {UC(1) , Rsvd1(2) , FTMH.Dp , FHL(1), Rsvd2[2:1]} ; */
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 0;
        prge_instruction_tbl_data.offset_base     = 11; /* */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_0;
        prge_instruction_tbl_data.size_base       = 1;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        res = arad_egr_prog_editor_supply_lfem_idx(unit, ARAD_EGR_PROG_EDITOR_LFEM_FTMH_DP,
                mem, ARAD_EGR_PROG_EDITOR_PROG_PP_MODE_HW_PROCESSING, &(prge_instruction_tbl_data.fem_select));
        SOC_SAND_CHECK_FUNC_RESULT(res,370, exit); 
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);


        /*Instr 21 Copy the 2 MSBytes {MC(1) , Mode(1) , Rsvd8[13:0]}; */
        mem   = (entry == entry_odd)?(mem + 1): mem;
        entry = (entry == entry_even)? entry_odd : entry_even;
        prge_instruction_tbl_data.src_select      = 2;
        prge_instruction_tbl_data.offset_base     = ARAD_PP_PRGE_PROGRAM_VAR; /* */
        prge_instruction_tbl_data.offset_src      = ARAD_PP_PRGE_ENG_OFFSET_CONST_64;
        prge_instruction_tbl_data.size_base       = 2;
        prge_instruction_tbl_data.size_src        = ARAD_PP_PRGE_ENG_SIZE_CONST;
        prge_instruction_tbl_data.fem_select      = ARAD_PP_EG_PROG_NOF_FEM(unit);
        prge_instruction_tbl_data.op_1_field_select = 0;
        prge_instruction_tbl_data.op_value        = 0;
        prge_instruction_tbl_data.op_2_field_select = 0;
        prge_instruction_tbl_data.alu_action      = 0;
        prge_instruction_tbl_data.op_3_field_select = 0;
        prge_instruction_tbl_data.cmp_action      = 0;
        prge_instruction_tbl_data.dst_select      = 0;
        res = arad_pp_epni_prge_instruction_tbl_set_unsafe(unit, mem, entry, &prge_instruction_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

        /* For this program, fill other instructions with NOPs */
        mem   = (entry == entry_odd) ? (mem + 1) : mem;
        entry = (entry == entry_even) ? entry_odd : entry_even;
        SOC_SAND_IF_ERR_EXIT( arad_egr_prog_editor_cat_nops(unit, mem, entry, entry_even, entry_odd) );

    }

    /* Load the necessary lfems */
    arad_egr_prog_editor_load_required_lfems(unit);

    SOC_REG_ABOVE_64_CLEAR(header_editing_size); 

    /* 0-6, 7-13, ... */
    header_editing_size[PP_FWD_CODE_ETHERNET] = 24;
    header_editing_size[PP_FWD_CODE_IPV4_UC] = 20;
    header_editing_size[PP_FWD_CODE_IPV4_MC] = 20;
    header_editing_size[PP_FWD_CODE_IPV6_UC] = 16;
    header_editing_size[PP_FWD_CODE_IPV6_MC] = 16;
    header_editing_size[PP_FWD_CODE_MPLS] = 4;
    header_editing_size[PP_FWD_CODE_TRILL] = 6;
    header_editing_size[PP_FWD_CODE_ETHERNET_AFTER_TERMINATION] = 20;

    /* turn seperate 7b'numbers to a single 112b' number */
    header_editing_size_to_reg_val(header_editing_size, header_editing_size_val);

    SOC_SAND_SOC_IF_ERROR_RETURN(res, 1000, exit, WRITE_EPNI_HEADER_EDITING_SIZEr(unit, REG_PORT_ANY, header_editing_size_val));

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_basic_epni_tm_config()",0,0);
}


uint32
  arad_egr_prog_editor_config_dut_by_queue_database(
    SOC_SAND_IN int unit
  ) 
{
  uint32    res;
  
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  /* Configure the DUT */

  /* PRGE */

      res = arad_egr_prog_editor_basic_epni_tm_config(unit);
      SOC_SAND_CHECK_FUNC_RESULT(res, 370, exit);

/* END Configure the DUT */

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in config_dut_by_queue_database()", 0, 0);
}

uint32 
  arad_egr_prog_editor_stacking_lfems_set(
    SOC_SAND_IN int unit,
    SOC_SAND_IN SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK tm_port_profile_stack,
    SOC_SAND_IN uint32 bitmap) 
{
    uint32
        res, 
        my_tm_domain, 
        local_bitmap = 0x0;
    ARAD_EPNI_LFEM_FIELD_SELECT_MAP_TBL_DATA  
        lfem_field_select_map_tbl_data;
    lfem_map 
        lfem_arr_0[16];
    int 
        i;
    uint64
        reg_val64;
  
    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    /* FEM-0-8 : STACKING user defined no. 1, stamp my domain */
    if (((tm_port_profile_stack == SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK1) || (tm_port_profile_stack == SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK_ALL)) && 
        (lfem_stacking_8_index[unit] != -1)) {

        /* Get my doamin and stamp the Bitmap */
        SOC_SAND_SOC_IF_ERROR_RETURN(res, 10, exit, READ_IHB_LBP_GENERAL_CONFIG_0r(unit, REG_PORT_ANY, &reg_val64));
        my_tm_domain = soc_reg64_field32_get(unit, IHB_LBP_GENERAL_CONFIG_0r, reg_val64, TM_DOMAINf);
        if (my_tm_domain < 16) {
            local_bitmap = bitmap | (1 << my_tm_domain);
        } else {
            SOC_SAND_CHECK_FUNC_RESULT(SOC_SAND_GEN_ERR, 20, exit);
        }

        /* Load original lfem */
        for (i = 0 ; i < 16 ; i++) {
            /* lfem_actions[...][0] is the enumeration so start with lfem_actions[...][2*i+1 (== 1)] */
            lfem_arr_0[i].val1 = lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8][2*i+1]; 
            lfem_arr_0[i].val2 = lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_STACKING_8][2*i+2]; 
        }

        /* Configure the lfem according to the bitmap */
        for (i = 0 ; i < 16 ; i++) {
            if ((1 << i) & local_bitmap) {
                lfem_arr_0[15 - i].val1 = 1;
                lfem_arr_0[15 - i].val2 = 1;
            }
        }
        
        lfem_map_arr_to_lfem_field_select_map(lfem_arr_0, &lfem_field_select_map_tbl_data);
        res = arad_epni_lfem_field_select_map_tbl_set_unsafe(unit, lfem_stacking_8_map[unit], lfem_stacking_8_index[unit], 
                                                             &lfem_field_select_map_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 30, exit);
    }

    /* FEM-0-10 : STACKING user defined no. 2, stamp next domain */
    if (((tm_port_profile_stack == SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK2) || (tm_port_profile_stack == SOC_TMC_STACK_EGR_PROG_TM_PORT_PROFILE_STACK_ALL)) && 
        (lfem_stacking_10_index[unit] != -1)) {

        /* Get my doamin and stamp the Bitmap */
        SOC_SAND_SOC_IF_ERROR_RETURN(res, 40, exit, READ_IHB_LBP_GENERAL_CONFIG_0r(unit, REG_PORT_ANY, &reg_val64));
        my_tm_domain = soc_reg64_field32_get(unit, IHB_LBP_GENERAL_CONFIG_0r, reg_val64, TM_DOMAINf);
        if (my_tm_domain < 16) {
            local_bitmap = bitmap | (1 << my_tm_domain);
        } else {
            SOC_SAND_CHECK_FUNC_RESULT(SOC_SAND_GEN_ERR, 50, exit);
        }   

        /* Load original lfem */
        for (i = 0 ; i < 16 ; i++) {
            /* lfem_actions[...][0] is the enumeration so start with lfem_actions[...][2*i+1 (== 1)] */
            lfem_arr_0[i].val1 = lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10][2*i+1]; 
            lfem_arr_0[i].val2 = lfem_actions[ARAD_EGR_PROG_EDITOR_LFEM_STACKING_10][2*i+2]; 
        }

        /* Configure the lfem according to the bitmap */
        for (i = 0 ; i < 16 ; i++) {
            if ((1 << i) & local_bitmap) {
                lfem_arr_0[15 - i].val1 = 1;
                lfem_arr_0[15 - i].val2 = 1;
            }
        }

        lfem_map_arr_to_lfem_field_select_map(lfem_arr_0, &lfem_field_select_map_tbl_data);
        res = arad_epni_lfem_field_select_map_tbl_set_unsafe(unit, lfem_stacking_10_map[unit], lfem_stacking_10_index[unit], 
                                                             &lfem_field_select_map_tbl_data);
        SOC_SAND_CHECK_FUNC_RESULT(res, 60, exit);
    }

exit:
  SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_stacking_lfems_set()", bitmap, local_bitmap);
}

uint32
arad_egr_prog_vxlan_program_info_set(
   SOC_SAND_IN int unit,
   SOC_SAND_IN uint16 udp_dest_port
 )
{
  ARAD_PP_EPNI_PRGE_PROGRAM_TBL_DATA 
      prge_program_tbl_data;
  uint32 res = SOC_SAND_OK;
  uint32 entry_u32[2];

  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  if (programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VXLAN].prog_used != -1) {
      res = arad_pp_epni_prge_program_tbl_get_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VXLAN].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 10, exit);

      entry_u32[0] = COMPILER_64_LO(prge_program_tbl_data.program_var);
      entry_u32[1] = COMPILER_64_HI(prge_program_tbl_data.program_var);

      /* update high msb */
      entry_u32[1] &= 0x0000FFFF;
      entry_u32[1] |= udp_dest_port << 16;

      COMPILER_64_SET(prge_program_tbl_data.program_var, entry_u32[1], entry_u32[0]);
      res = arad_pp_epni_prge_program_tbl_set_unsafe(unit, programs[unit][ARAD_EGR_PROG_EDITOR_PROG_VXLAN].prog_used, &prge_program_tbl_data);
      SOC_SAND_CHECK_FUNC_RESULT(res, 20, exit);
  }
exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_vxlan_program_info_set()", udp_dest_port, 0);
}

int
  arad_egr_prog_editor_program_pointer_get(
    SOC_SAND_IN   int                                 unit,
    SOC_SAND_IN   ARAD_EGR_PROG_EDITOR_PROGRAMS       program_id,
    SOC_SAND_OUT  uint32                              *program_pointer
  )
{   
    SOCDNX_INIT_FUNC_DEFS;

    if (programs[unit][program_id].prog_used != -1) {
        *program_pointer = programs[unit][program_id].program_pointer;
    }
    else {
        SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG("ARAD_EGR_PROG_EDITOR_PROGRAM_NOT_USED_ERR")));
    }

exit:
    SOCDNX_FUNC_RETURN;
}

int
  arad_egr_prog_editor_profile_get(
    SOC_SAND_IN  int                        unit,
    SOC_SAND_IN  uint32                     eg_tm_profile,
    SOC_SAND_OUT uint32                     *internal_profile
  )
{   
    SOCDNX_INIT_FUNC_DEFS;

    if (tm_profiles[unit][eg_tm_profile] != -1) {
        *internal_profile = tm_profiles[unit][eg_tm_profile];
    }
    else {
        SOCDNX_EXIT_WITH_ERR(SOC_E_INTERNAL, (_BSL_SOCDNX_MSG("PRGE internal error - tm profile not allocated")));
    }

exit:
    SOCDNX_FUNC_RETURN;
}

uint32
  arad_egr_prog_editor_tm_profile_enum_get(
    SOC_SAND_IN  int                        unit,
    SOC_SAND_IN  uint32                        internal_profile,
    SOC_SAND_OUT uint32                         *eg_tm_profile
  )
{   
  uint32 tm_profile;
  SOC_SAND_INIT_ERROR_DEFINITIONS(0);

  *eg_tm_profile = -1;
  for (tm_profile = 0; tm_profile<ARAD_PRGE_TM_SELECT_NOF_PROFILES ; tm_profile++) {
      if (tm_profiles[unit][tm_profile] == internal_profile) {
          *eg_tm_profile = tm_profile;
          break;
      }
  }
  if (*eg_tm_profile == -1) {
      SOC_SAND_SET_ERROR_MSG((_BSL_SOCDNX_SAND_MSG("  PRGE internal error - tm profile not exist. \n\r")));
  }

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in arad_egr_prog_editor_tm_profile_enum_get()", internal_profile, 0);
}

uint32
  arad_egr_prog_editor_pp_pct_var_set(
    SOC_SAND_IN uint32 unit,
    SOC_SAND_IN uint32 port,
    SOC_SAND_IN uint32 value
  ) {
    ARAD_PP_EPNI_PP_PCT_TBL_DATA
      tbl_data;
    uint32
      res = SOC_SAND_OK;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    SOC_SAND_CHECK_DRIVER_AND_DEVICE;

    res = arad_pp_epni_pp_pct_tbl_get_unsafe(unit, port, 0, &tbl_data);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

    tbl_data.prge_var = value;

    res = arad_pp_epni_pp_pct_tbl_set_unsafe(unit, port, 0, &tbl_data);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 20, exit);

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in soc_ppd_eg_epni_pp_pct_prge_var_set()", port, value);
}

uint32
  arad_egr_prog_editor_pp_pct_var_get(
    SOC_SAND_IN uint32 unit,
    SOC_SAND_IN uint32 port,
    SOC_SAND_OUT uint32 *value
  ) {
    uint32
      res = SOC_SAND_OK;
    ARAD_PP_EPNI_PP_PCT_TBL_DATA
      tbl_data;

    SOC_SAND_INIT_ERROR_DEFINITIONS(0);

    res = arad_pp_epni_pp_pct_tbl_get_unsafe(unit, port, 0, &tbl_data);
    SOC_SAND_SOC_CHECK_FUNC_RESULT(res, 10, exit);

    *value = tbl_data.prge_var;

exit:
    SOC_SAND_EXIT_AND_SEND_ERROR("error in soc_ppd_eg_epni_pp_pct_prge_var_get()", unit, port);
}

int
  arad_egr_prog_editor_profile_set(
    SOC_SAND_IN  int                        unit,
    SOC_SAND_IN  uint32                     q_pair,
    SOC_SAND_IN  int                        core,
    SOC_SAND_IN  uint32                     prog_editor_profile
  )
{   
    ARAD_EGQ_PCT_TBL_DATA        pct_tbl_data;

    SOCDNX_INIT_FUNC_DEFS;

    SOCDNX_IF_ERR_EXIT(arad_egq_pct_tbl_get_unsafe(unit, q_pair, core, &pct_tbl_data));

    pct_tbl_data.prog_editor_profile  = prog_editor_profile; 

    SOCDNX_IF_ERR_EXIT(arad_egq_pct_tbl_set_unsafe(unit, q_pair, core, &pct_tbl_data));

exit:
    SOCDNX_FUNC_RETURN;
}

#if ARAD_DEBUG_IS_LVL1

#endif /* ARAD_DEBUG_IS_LVL1 */

/* } */
#include <soc/dpp/SAND/Utils/sand_footer.h>


#endif /* of #if defined(BCM_88650_A0) */

#undef _ERR_MSG_MODULE_NAME
